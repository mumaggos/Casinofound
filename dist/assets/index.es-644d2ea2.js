import{_ as Yw}from"./web3-936f3753.js";import{e as zt,$ as fu}from"./events-45801481.js";import{av as as,aw as X,ax as oi,ay as Zw,az as Xw,aA as V,aB as e0,aC as Qc,aD as t0,aE as r0,aF as i0,aG as Rl,aH as n0,aI as s0,aJ as o0,aK as Cl,aL as a0,aM as c0,aN as u0,aO as h0,aP as ns,aQ as $l,aR as l0,aS as f0,aT as sp,aU as ur,aV as p0,aW as Tl,aX as pn,aY as Ke,aZ as ct,a_ as si,a$ as xt,b0 as d0,b1 as dn,b2 as op,b3 as g0,b4 as y0,b5 as v0,b6 as ap,b7 as m0,b8 as cp,b9 as up,ba as yn,bb as Yc,bc as To,bd as vn,be as w0,bf as No,bg as b0,bh as _0,bi as E0,bj as I0,bk as Io,bl as P0,bm as x0,bn as Sc,bo as Nl,bp as S0,bq as A0,br as F0,bs as Dl,bt as O0,bu as R0,bv as C0,bw as $0,bx as T0,by as N0,bz as D0,bA as es,bB as hp,bC as Ac,bD as B0,bE as q0}from"./index-21c6ac15.js";import{d as lp,g as Uo,e as St}from"./vendor-48cd178f.js";import"./ui-9609bd02.js";import"./router-eeeca5a6.js";const j0=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,z0=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,L0=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function U0(n,t){if(n==="__proto__"||n==="constructor"&&t&&typeof t=="object"&&"prototype"in t){M0(n);return}return t}function M0(n){console.warn(`[destr] Dropping "${n}" key to prevent prototype pollution.`)}function Po(n,t={}){if(typeof n!="string")return n;if(n[0]==='"'&&n[n.length-1]==='"'&&n.indexOf("\\")===-1)return n.slice(1,-1);const r=n.trim();if(r.length<=9)switch(r.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!L0.test(n)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return n}try{if(j0.test(n)||z0.test(n)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(n,U0)}return JSON.parse(n)}catch(s){if(t.strict)throw s;return n}}function H0(n){return!n||typeof n.then!="function"?Promise.resolve(n):n}function Ze(n,...t){try{return H0(n(...t))}catch(r){return Promise.reject(r)}}function k0(n){const t=typeof n;return n===null||t!=="object"&&t!=="function"}function V0(n){const t=Object.getPrototypeOf(n);return!t||t.isPrototypeOf(Object)}function Do(n){if(k0(n))return String(n);if(V0(n)||Array.isArray(n))return JSON.stringify(n);if(typeof n.toJSON=="function")return Do(n.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const Zc="base64:";function K0(n){return typeof n=="string"?n:Zc+J0(n)}function G0(n){return typeof n!="string"||!n.startsWith(Zc)?n:W0(n.slice(Zc.length))}function W0(n){return globalThis.Buffer?Buffer.from(n,"base64"):Uint8Array.from(globalThis.atob(n),t=>t.codePointAt(0))}function J0(n){return globalThis.Buffer?Buffer.from(n).toString("base64"):globalThis.btoa(String.fromCodePoint(...n))}function Pt(n){var t;return n&&((t=n.split("?")[0])==null?void 0:t.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""))||""}function Q0(...n){return Pt(n.join(":"))}function xo(n){return n=Pt(n),n?n+":":""}function Y0(n,t){if(t===void 0)return!0;let r=0,s=n.indexOf(":");for(;s>-1;)r++,s=n.indexOf(":",s+1);return r<=t}function Z0(n,t){return t?n.startsWith(t)&&n[n.length-1]!=="$":n[n.length-1]!=="$"}const X0="memory",eb=()=>{const n=new Map;return{name:X0,getInstance:()=>n,hasItem(t){return n.has(t)},getItem(t){return n.get(t)??null},getItemRaw(t){return n.get(t)??null},setItem(t,r){n.set(t,r)},setItemRaw(t,r){n.set(t,r)},removeItem(t){n.delete(t)},getKeys(){return[...n.keys()]},clear(){n.clear()},dispose(){n.clear()}}};function tb(n={}){const t={mounts:{"":n.driver||eb()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=y=>{for(const v of t.mountpoints)if(y.startsWith(v))return{base:v,relativeKey:y.slice(v.length),driver:t.mounts[v]};return{base:"",relativeKey:y,driver:t.mounts[""]}},s=(y,v)=>t.mountpoints.filter(b=>b.startsWith(y)||v&&y.startsWith(b)).map(b=>({relativeBase:y.length>b.length?y.slice(b.length):void 0,mountpoint:b,driver:t.mounts[b]})),o=(y,v)=>{if(t.watching){v=Pt(v);for(const b of t.watchListeners)b(y,v)}},c=async()=>{if(!t.watching){t.watching=!0;for(const y in t.mounts)t.unwatch[y]=await Bl(t.mounts[y],o,y)}},h=async()=>{if(t.watching){for(const y in t.unwatch)await t.unwatch[y]();t.unwatch={},t.watching=!1}},p=(y,v,b)=>{const S=new Map,O=F=>{let N=S.get(F.base);return N||(N={driver:F.driver,base:F.base,items:[]},S.set(F.base,N)),N};for(const F of y){const N=typeof F=="string",G=Pt(N?F:F.key),H=N?void 0:F.value,Z=N||!F.options?v:{...v,...F.options},B=r(G);O(B).items.push({key:G,value:H,relativeKey:B.relativeKey,options:Z})}return Promise.all([...S.values()].map(F=>b(F))).then(F=>F.flat())},f={hasItem(y,v={}){y=Pt(y);const{relativeKey:b,driver:S}=r(y);return Ze(S.hasItem,b,v)},getItem(y,v={}){y=Pt(y);const{relativeKey:b,driver:S}=r(y);return Ze(S.getItem,b,v).then(O=>Po(O))},getItems(y,v={}){return p(y,v,b=>b.driver.getItems?Ze(b.driver.getItems,b.items.map(S=>({key:S.relativeKey,options:S.options})),v).then(S=>S.map(O=>({key:Q0(b.base,O.key),value:Po(O.value)}))):Promise.all(b.items.map(S=>Ze(b.driver.getItem,S.relativeKey,S.options).then(O=>({key:S.key,value:Po(O)})))))},getItemRaw(y,v={}){y=Pt(y);const{relativeKey:b,driver:S}=r(y);return S.getItemRaw?Ze(S.getItemRaw,b,v):Ze(S.getItem,b,v).then(O=>G0(O))},async setItem(y,v,b={}){if(v===void 0)return f.removeItem(y);y=Pt(y);const{relativeKey:S,driver:O}=r(y);O.setItem&&(await Ze(O.setItem,S,Do(v),b),O.watch||o("update",y))},async setItems(y,v){await p(y,v,async b=>{if(b.driver.setItems)return Ze(b.driver.setItems,b.items.map(S=>({key:S.relativeKey,value:Do(S.value),options:S.options})),v);b.driver.setItem&&await Promise.all(b.items.map(S=>Ze(b.driver.setItem,S.relativeKey,Do(S.value),S.options)))})},async setItemRaw(y,v,b={}){if(v===void 0)return f.removeItem(y,b);y=Pt(y);const{relativeKey:S,driver:O}=r(y);if(O.setItemRaw)await Ze(O.setItemRaw,S,v,b);else if(O.setItem)await Ze(O.setItem,S,K0(v),b);else return;O.watch||o("update",y)},async removeItem(y,v={}){typeof v=="boolean"&&(v={removeMeta:v}),y=Pt(y);const{relativeKey:b,driver:S}=r(y);S.removeItem&&(await Ze(S.removeItem,b,v),(v.removeMeta||v.removeMata)&&await Ze(S.removeItem,b+"$",v),S.watch||o("remove",y))},async getMeta(y,v={}){typeof v=="boolean"&&(v={nativeOnly:v}),y=Pt(y);const{relativeKey:b,driver:S}=r(y),O=Object.create(null);if(S.getMeta&&Object.assign(O,await Ze(S.getMeta,b,v)),!v.nativeOnly){const F=await Ze(S.getItem,b+"$",v).then(N=>Po(N));F&&typeof F=="object"&&(typeof F.atime=="string"&&(F.atime=new Date(F.atime)),typeof F.mtime=="string"&&(F.mtime=new Date(F.mtime)),Object.assign(O,F))}return O},setMeta(y,v,b={}){return this.setItem(y+"$",v,b)},removeMeta(y,v={}){return this.removeItem(y+"$",v)},async getKeys(y,v={}){var G;y=xo(y);const b=s(y,!0);let S=[];const O=[];let F=!0;for(const H of b){(G=H.driver.flags)!=null&&G.maxDepth||(F=!1);const Z=await Ze(H.driver.getKeys,H.relativeBase,v);for(const B of Z){const U=H.mountpoint+Pt(B);S.some(Y=>U.startsWith(Y))||O.push(U)}S=[H.mountpoint,...S.filter(B=>!B.startsWith(H.mountpoint))]}const N=v.maxDepth!==void 0&&!F;return O.filter(H=>(!N||Y0(H,v.maxDepth))&&Z0(H,y))},async clear(y,v={}){y=xo(y),await Promise.all(s(y,!1).map(async b=>{if(b.driver.clear)return Ze(b.driver.clear,b.relativeBase,v);if(b.driver.removeItem){const S=await b.driver.getKeys(b.relativeBase||"",v);return Promise.all(S.map(O=>b.driver.removeItem(O,v)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(y=>ql(y)))},async watch(y){return await c(),t.watchListeners.push(y),async()=>{t.watchListeners=t.watchListeners.filter(v=>v!==y),t.watchListeners.length===0&&await h()}},async unwatch(){t.watchListeners=[],await h()},mount(y,v){if(y=xo(y),y&&t.mounts[y])throw new Error(`already mounted at ${y}`);return y&&(t.mountpoints.push(y),t.mountpoints.sort((b,S)=>S.length-b.length)),t.mounts[y]=v,t.watching&&Promise.resolve(Bl(v,o,y)).then(b=>{t.unwatch[y]=b}).catch(console.error),f},async unmount(y,v=!0){var b,S;y=xo(y),!(!y||!t.mounts[y])&&(t.watching&&y in t.unwatch&&((S=(b=t.unwatch)[y])==null||S.call(b),delete t.unwatch[y]),v&&await ql(t.mounts[y]),t.mountpoints=t.mountpoints.filter(O=>O!==y),delete t.mounts[y])},getMount(y=""){y=Pt(y)+":";const v=r(y);return{driver:v.driver,base:v.base}},getMounts(y="",v={}){return y=Pt(y),s(y,v.parents).map(S=>({driver:S.driver,base:S.mountpoint}))},keys:(y,v={})=>f.getKeys(y,v),get:(y,v={})=>f.getItem(y,v),set:(y,v,b={})=>f.setItem(y,v,b),has:(y,v={})=>f.hasItem(y,v),del:(y,v={})=>f.removeItem(y,v),remove:(y,v={})=>f.removeItem(y,v)};return f}function Bl(n,t,r){return n.watch?n.watch((s,o)=>t(s,r+o)):()=>{}}async function ql(n){typeof n.dispose=="function"&&await Ze(n.dispose)}function Ri(n){return new Promise((t,r)=>{n.oncomplete=n.onsuccess=()=>t(n.result),n.onabort=n.onerror=()=>r(n.error)})}function fp(n,t){let r;const s=()=>{if(r)return r;const o=indexedDB.open(n);return o.onupgradeneeded=()=>o.result.createObjectStore(t),r=Ri(o),r.then(c=>{c.onclose=()=>r=void 0},()=>{}),r};return(o,c)=>s().then(h=>c(h.transaction(t,o).objectStore(t)))}let Fc;function cs(){return Fc||(Fc=fp("keyval-store","keyval")),Fc}function jl(n,t=cs()){return t("readonly",r=>Ri(r.get(n)))}function rb(n,t,r=cs()){return r("readwrite",s=>(s.put(t,n),Ri(s.transaction)))}function ib(n,t=cs()){return t("readwrite",r=>(r.delete(n),Ri(r.transaction)))}function nb(n=cs()){return n("readwrite",t=>(t.clear(),Ri(t.transaction)))}function sb(n,t){return n.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Ri(n.transaction)}function ob(n=cs()){return n("readonly",t=>{if(t.getAllKeys)return Ri(t.getAllKeys());const r=[];return sb(t,s=>r.push(s.key)).then(()=>r)})}const ab=n=>JSON.stringify(n,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),cb=n=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=n.replace(t,'$1"$2n"$3');return JSON.parse(r,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function us(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return cb(n)}catch{return n}}function Oi(n){return typeof n=="string"?n:ab(n)||""}const ub="idb-keyval";var hb=(n={})=>{const t=n.base&&n.base.length>0?`${n.base}:`:"",r=o=>t+o;let s;return n.dbName&&n.storeName&&(s=fp(n.dbName,n.storeName)),{name:ub,options:n,async hasItem(o){return!(typeof await jl(r(o),s)>"u")},async getItem(o){return await jl(r(o),s)??null},setItem(o,c){return rb(r(o),c,s)},removeItem(o){return ib(r(o),s)},getKeys(){return ob(s)},clear(){return nb(s)}}};const lb="WALLET_CONNECT_V2_INDEXED_DB",fb="keyvaluestorage";let pb=class{constructor(){this.indexedDb=tb({driver:hb({dbName:lb,storeName:fb})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const r=await this.indexedDb.getItem(t);if(r!==null)return r}async setItem(t,r){await this.indexedDb.setItem(t,Oi(r))}async removeItem(t){await this.indexedDb.removeItem(t)}};var Oc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Bo={exports:{}};(function(){let n;function t(){}n=t,n.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},n.prototype.setItem=function(r,s){this[r]=String(s)},n.prototype.removeItem=function(r){delete this[r]},n.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},n.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Oc<"u"&&Oc.localStorage?Bo.exports=Oc.localStorage:typeof window<"u"&&window.localStorage?Bo.exports=window.localStorage:Bo.exports=new t})();function db(n){var t;return[n[0],us((t=n[1])!=null?t:"")]}let gb=class{constructor(){this.localStorage=Bo.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(db)}async getItem(t){const r=this.localStorage.getItem(t);if(r!==null)return us(r)}async setItem(t,r){this.localStorage.setItem(t,Oi(r))}async removeItem(t){this.localStorage.removeItem(t)}};const yb="wc_storage_version",zl=1,vb=async(n,t,r)=>{const s=yb,o=await t.getItem(s);if(o&&o>=zl){r(t);return}const c=await n.getKeys();if(!c.length){r(t);return}const h=[];for(;c.length;){const p=c.shift();if(!p)continue;const f=p.toLowerCase();if(f.includes("wc@")||f.includes("walletconnect")||f.includes("wc_")||f.includes("wallet_connect")){const y=await n.getItem(p);await t.setItem(p,y),h.push(p)}}await t.setItem(s,zl),r(t),mb(n,h)},mb=async(n,t)=>{t.length&&t.forEach(async r=>{await n.removeItem(r)})};let wb=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const t=new gb;this.storage=t;try{const r=new pb;vb(t,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,r){return await this.initialize(),this.storage.setItem(t,r)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),t())},20)})}};var mn={},Kn={},Rc={},Gn={};class Ci{}const bb=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Ci},Symbol.toStringTag,{value:"Module"})),_b=lp(bb);var Ll;function Eb(){if(Ll)return Gn;Ll=1,Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.IHeartBeat=void 0;const n=_b;class t extends n.IEvents{constructor(s){super()}}return Gn.IHeartBeat=t,Gn}var Ul;function pp(){return Ul||(Ul=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),as.__exportStar(Eb(),n)}(Rc)),Rc}var Cc={},Si={},Ml;function Ib(){if(Ml)return Si;Ml=1,Object.defineProperty(Si,"__esModule",{value:!0}),Si.HEARTBEAT_EVENTS=Si.HEARTBEAT_INTERVAL=void 0;const n=X;return Si.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,Si.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Si}var Hl;function dp(){return Hl||(Hl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),as.__exportStar(Ib(),n)}(Cc)),Cc}var kl;function Pb(){if(kl)return Kn;kl=1,Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.HeartBeat=void 0;const n=as,t=zt,r=X,s=pp(),o=dp();class c extends s.IHeartBeat{constructor(p){super(p),this.events=new t.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(p==null?void 0:p.interval)||o.HEARTBEAT_INTERVAL}static init(p){return n.__awaiter(this,void 0,void 0,function*(){const f=new c(p);return yield f.init(),f})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(p,f){this.events.on(p,f)}once(p,f){this.events.once(p,f)}off(p,f){this.events.off(p,f)}removeListener(p,f){this.events.removeListener(p,f)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return Kn.HeartBeat=c,Kn}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=as;t.__exportStar(Pb(),n),t.__exportStar(pp(),n),t.__exportStar(dp(),n)})(mn);function xb(n){try{return JSON.stringify(n)}catch{return'"[Circular]"'}}var Sb=Ab;function Ab(n,t,r){var s=r&&r.stringify||xb,o=1;if(typeof n=="object"&&n!==null){var c=t.length+o;if(c===1)return n;var h=new Array(c);h[0]=s(n);for(var p=1;p<c;p++)h[p]=s(t[p]);return h.join(" ")}if(typeof n!="string")return n;var f=t.length;if(f===0)return n;for(var y="",v=1-o,b=-1,S=n&&n.length||0,O=0;O<S;){if(n.charCodeAt(O)===37&&O+1<S){switch(b=b>-1?b:0,n.charCodeAt(O+1)){case 100:case 102:if(v>=f||t[v]==null)break;b<O&&(y+=n.slice(b,O)),y+=Number(t[v]),b=O+2,O++;break;case 105:if(v>=f||t[v]==null)break;b<O&&(y+=n.slice(b,O)),y+=Math.floor(Number(t[v])),b=O+2,O++;break;case 79:case 111:case 106:if(v>=f||t[v]===void 0)break;b<O&&(y+=n.slice(b,O));var F=typeof t[v];if(F==="string"){y+="'"+t[v]+"'",b=O+2,O++;break}if(F==="function"){y+=t[v].name||"<anonymous>",b=O+2,O++;break}y+=s(t[v]),b=O+2,O++;break;case 115:if(v>=f)break;b<O&&(y+=n.slice(b,O)),y+=String(t[v]),b=O+2,O++;break;case 37:b<O&&(y+=n.slice(b,O)),y+="%",b=O+2,O++,v--;break}++v}++O}return b===-1?n:(b<S&&(y+=n.slice(b)),y)}const Vl=Sb;var Fb=br;const ss=jb().console||{},Ob={mapHttpRequest:So,mapHttpResponse:So,wrapRequestSerializer:$c,wrapResponseSerializer:$c,wrapErrorSerializer:$c,req:So,res:So,err:Nb};function Rb(n,t){return Array.isArray(n)?n.filter(function(s){return s!=="!stdSerializers.err"}):n===!0?Object.keys(t):!1}function br(n){n=n||{},n.browser=n.browser||{};const t=n.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");const r=n.browser.write||ss;n.browser.write&&(n.browser.asObject=!0);const s=n.serializers||{},o=Rb(n.browser.serialize,s);let c=n.browser.serialize;Array.isArray(n.browser.serialize)&&n.browser.serialize.indexOf("!stdSerializers.err")>-1&&(c=!1);const h=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),n.enabled===!1&&(n.level="silent");const p=n.level||"info",f=Object.create(r);f.log||(f.log=os),Object.defineProperty(f,"levelVal",{get:v}),Object.defineProperty(f,"level",{get:b,set:S});const y={transmit:t,serialize:o,asObject:n.browser.asObject,levels:h,timestamp:Db(n)};f.levels=br.levels,f.level=p,f.setMaxListeners=f.getMaxListeners=f.emit=f.addListener=f.on=f.prependListener=f.once=f.prependOnceListener=f.removeListener=f.removeAllListeners=f.listeners=f.listenerCount=f.eventNames=f.write=f.flush=os,f.serializers=s,f._serialize=o,f._stdErrSerialize=c,f.child=O,t&&(f._logEvent=Xc());function v(){return this.level==="silent"?1/0:this.levels.values[this.level]}function b(){return this._level}function S(F){if(F!=="silent"&&!this.levels.values[F])throw Error("unknown level "+F);this._level=F,hn(y,f,"error","log"),hn(y,f,"fatal","error"),hn(y,f,"warn","error"),hn(y,f,"info","log"),hn(y,f,"debug","log"),hn(y,f,"trace","log")}function O(F,N){if(!F)throw new Error("missing bindings for child Pino");N=N||{},o&&F.serializers&&(N.serializers=F.serializers);const G=N.serializers;if(o&&G){var H=Object.assign({},s,G),Z=n.browser.serialize===!0?Object.keys(H):o;delete F.serializers,Mo([F],Z,H,this._stdErrSerialize)}function B(U){this._childLevel=(U._childLevel|0)+1,this.error=ln(U,F,"error"),this.fatal=ln(U,F,"fatal"),this.warn=ln(U,F,"warn"),this.info=ln(U,F,"info"),this.debug=ln(U,F,"debug"),this.trace=ln(U,F,"trace"),H&&(this.serializers=H,this._serialize=Z),t&&(this._logEvent=Xc([].concat(U._logEvent.bindings,F)))}return B.prototype=this,new B(this)}return f}br.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};br.stdSerializers=Ob;br.stdTimeFunctions=Object.assign({},{nullTime:gp,epochTime:yp,unixTime:Bb,isoTime:qb});function hn(n,t,r,s){const o=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?os:o[r]?o[r]:ss[r]||ss[s]||os,Cb(n,t,r)}function Cb(n,t,r){!n.transmit&&t[r]===os||(t[r]=function(s){return function(){const c=n.timestamp(),h=new Array(arguments.length),p=Object.getPrototypeOf&&Object.getPrototypeOf(this)===ss?ss:this;for(var f=0;f<h.length;f++)h[f]=arguments[f];if(n.serialize&&!n.asObject&&Mo(h,this._serialize,this.serializers,this._stdErrSerialize),n.asObject?s.call(p,$b(this,r,h,c)):s.apply(p,h),n.transmit){const y=n.transmit.level||t.level,v=br.levels.values[y],b=br.levels.values[r];if(b<v)return;Tb(this,{ts:c,methodLevel:r,methodValue:b,transmitLevel:y,transmitValue:br.levels.values[n.transmit.level||t.level],send:n.transmit.send,val:t.levelVal},h)}}}(t[r]))}function $b(n,t,r,s){n._serialize&&Mo(r,n._serialize,n.serializers,n._stdErrSerialize);const o=r.slice();let c=o[0];const h={};s&&(h.time=s),h.level=br.levels.values[t];let p=(n._childLevel|0)+1;if(p<1&&(p=1),c!==null&&typeof c=="object"){for(;p--&&typeof o[0]=="object";)Object.assign(h,o.shift());c=o.length?Vl(o.shift(),o):void 0}else typeof c=="string"&&(c=Vl(o.shift(),o));return c!==void 0&&(h.msg=c),h}function Mo(n,t,r,s){for(const o in n)if(s&&n[o]instanceof Error)n[o]=br.stdSerializers.err(n[o]);else if(typeof n[o]=="object"&&!Array.isArray(n[o]))for(const c in n[o])t&&t.indexOf(c)>-1&&c in r&&(n[o][c]=r[c](n[o][c]))}function ln(n,t,r){return function(){const s=new Array(1+arguments.length);s[0]=t;for(var o=1;o<s.length;o++)s[o]=arguments[o-1];return n[r].apply(this,s)}}function Tb(n,t,r){const s=t.send,o=t.ts,c=t.methodLevel,h=t.methodValue,p=t.val,f=n._logEvent.bindings;Mo(r,n._serialize||Object.keys(n.serializers),n.serializers,n._stdErrSerialize===void 0?!0:n._stdErrSerialize),n._logEvent.ts=o,n._logEvent.messages=r.filter(function(y){return f.indexOf(y)===-1}),n._logEvent.level.label=c,n._logEvent.level.value=h,s(c,n._logEvent,p),n._logEvent=Xc(f)}function Xc(n){return{ts:0,messages:[],bindings:n||[],level:{label:"",value:0}}}function Nb(n){const t={type:n.constructor.name,msg:n.message,stack:n.stack};for(const r in n)t[r]===void 0&&(t[r]=n[r]);return t}function Db(n){return typeof n.timestamp=="function"?n.timestamp:n.timestamp===!1?gp:yp}function So(){return{}}function $c(n){return n}function os(){}function gp(){return!1}function yp(){return Date.now()}function Bb(){return Math.round(Date.now()/1e3)}function qb(){return new Date(Date.now()).toISOString()}function jb(){function n(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return n(self)||n(window)||n(this)||{}}}const Ho=Uo(Fb),zb={level:"info"},hs="custom_context";var Lb=Object.defineProperty,Ub=Object.defineProperties,Mb=Object.getOwnPropertyDescriptors,Kl=Object.getOwnPropertySymbols,Hb=Object.prototype.hasOwnProperty,kb=Object.prototype.propertyIsEnumerable,Gl=(n,t,r)=>t in n?Lb(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Vb=(n,t)=>{for(var r in t||(t={}))Hb.call(t,r)&&Gl(n,r,t[r]);if(Kl)for(var r of Kl(t))kb.call(t,r)&&Gl(n,r,t[r]);return n},Kb=(n,t)=>Ub(n,Mb(t));function ko(n){return Kb(Vb({},n),{level:(n==null?void 0:n.level)||zb.level})}function Gb(n,t=hs){return n[t]||""}function Wb(n,t,r=hs){return n[r]=t,n}function At(n,t=hs){let r="";return typeof n.bindings>"u"?r=Gb(n,t):r=n.bindings().context||"",r}function Jb(n,t,r=hs){const s=At(n,r);return s.trim()?`${s}/${t}`:t}function Ft(n,t,r=hs){const s=Jb(n,t,r),o=n.child({context:s});return Wb(o,s,r)}let Qb=class extends Ci{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}},Yb=class extends Ci{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}},Zb=class{constructor(t,r){this.logger=t,this.core=r}},Xb=class extends Ci{constructor(t,r){super(),this.relayer=t,this.logger=r}},e_=class extends Ci{constructor(t){super()}},t_=class{constructor(t,r,s,o){this.core=t,this.logger=r,this.name=s}},r_=class extends Ci{constructor(t,r){super(),this.relayer=t,this.logger=r}},i_=class extends Ci{constructor(t,r){super(),this.core=t,this.logger=r}},n_=class{constructor(t,r){this.projectId=t,this.logger=r}},s_=class{constructor(t,r){this.projectId=t,this.logger=r}},o_=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},a_=class{constructor(t){this.client=t}};function c_(n){return n instanceof Uint8Array||ArrayBuffer.isView(n)&&n.constructor.name==="Uint8Array"}function vp(n,...t){if(!c_(n))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(n.length))throw new Error("Uint8Array expected of length "+t+", got length="+n.length)}function Wl(n,t=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(t&&n.finished)throw new Error("Hash#digest() has already been called")}function u_(n,t){vp(n);const r=t.outputLen;if(n.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const fn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Tc=n=>new DataView(n.buffer,n.byteOffset,n.byteLength);function h_(n){if(typeof n!="string")throw new Error("utf8ToBytes expected string, got "+typeof n);return new Uint8Array(new TextEncoder().encode(n))}function mp(n){return typeof n=="string"&&(n=h_(n)),vp(n),n}class l_{clone(){return this._cloneInto()}}function f_(n){const t=s=>n().update(mp(s)).digest(),r=n();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>n(),t}function wp(n=32){if(fn&&typeof fn.getRandomValues=="function")return fn.getRandomValues(new Uint8Array(n));if(fn&&typeof fn.randomBytes=="function")return fn.randomBytes(n);throw new Error("crypto.getRandomValues must be defined")}function p_(n,t,r,s){if(typeof n.setBigUint64=="function")return n.setBigUint64(t,r,s);const o=BigInt(32),c=BigInt(4294967295),h=Number(r>>o&c),p=Number(r&c),f=s?4:0,y=s?0:4;n.setUint32(t+f,h,s),n.setUint32(t+y,p,s)}class d_ extends l_{constructor(t,r,s,o){super(),this.blockLen=t,this.outputLen=r,this.padOffset=s,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Tc(this.buffer)}update(t){Wl(this);const{view:r,buffer:s,blockLen:o}=this;t=mp(t);const c=t.length;for(let h=0;h<c;){const p=Math.min(o-this.pos,c-h);if(p===o){const f=Tc(t);for(;o<=c-h;h+=o)this.process(f,h);continue}s.set(t.subarray(h,h+p),this.pos),this.pos+=p,h+=p,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Wl(this),u_(t,this),this.finished=!0;const{buffer:r,view:s,blockLen:o,isLE:c}=this;let{pos:h}=this;r[h++]=128,this.buffer.subarray(h).fill(0),this.padOffset>o-h&&(this.process(s,0),h=0);for(let b=h;b<o;b++)r[b]=0;p_(s,o-8,BigInt(this.length*8),c),this.process(s,0);const p=Tc(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const y=f/4,v=this.get();if(y>v.length)throw new Error("_sha2: outputLen bigger than state");for(let b=0;b<y;b++)p.setUint32(4*b,v[b],c)}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const s=t.slice(0,r);return this.destroy(),s}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:r,buffer:s,length:o,finished:c,destroyed:h,pos:p}=this;return t.length=o,t.pos=p,t.finished=c,t.destroyed=h,o%r&&t.buffer.set(s),t}}const Ao=BigInt(2**32-1),eu=BigInt(32);function bp(n,t=!1){return t?{h:Number(n&Ao),l:Number(n>>eu&Ao)}:{h:Number(n>>eu&Ao)|0,l:Number(n&Ao)|0}}function g_(n,t=!1){let r=new Uint32Array(n.length),s=new Uint32Array(n.length);for(let o=0;o<n.length;o++){const{h:c,l:h}=bp(n[o],t);[r[o],s[o]]=[c,h]}return[r,s]}const y_=(n,t)=>BigInt(n>>>0)<<eu|BigInt(t>>>0),v_=(n,t,r)=>n>>>r,m_=(n,t,r)=>n<<32-r|t>>>r,w_=(n,t,r)=>n>>>r|t<<32-r,b_=(n,t,r)=>n<<32-r|t>>>r,__=(n,t,r)=>n<<64-r|t>>>r-32,E_=(n,t,r)=>n>>>r-32|t<<64-r,I_=(n,t)=>t,P_=(n,t)=>n,x_=(n,t,r)=>n<<r|t>>>32-r,S_=(n,t,r)=>t<<r|n>>>32-r,A_=(n,t,r)=>t<<r-32|n>>>64-r,F_=(n,t,r)=>n<<r-32|t>>>64-r;function O_(n,t,r,s){const o=(t>>>0)+(s>>>0);return{h:n+r+(o/2**32|0)|0,l:o|0}}const R_=(n,t,r)=>(n>>>0)+(t>>>0)+(r>>>0),C_=(n,t,r,s)=>t+r+s+(n/2**32|0)|0,$_=(n,t,r,s)=>(n>>>0)+(t>>>0)+(r>>>0)+(s>>>0),T_=(n,t,r,s,o)=>t+r+s+o+(n/2**32|0)|0,N_=(n,t,r,s,o)=>(n>>>0)+(t>>>0)+(r>>>0)+(s>>>0)+(o>>>0),D_=(n,t,r,s,o,c)=>t+r+s+o+c+(n/2**32|0)|0,pe={fromBig:bp,split:g_,toBig:y_,shrSH:v_,shrSL:m_,rotrSH:w_,rotrSL:b_,rotrBH:__,rotrBL:E_,rotr32H:I_,rotr32L:P_,rotlSH:x_,rotlSL:S_,rotlBH:A_,rotlBL:F_,add:O_,add3L:R_,add3H:C_,add4L:$_,add4H:T_,add5H:D_,add5L:N_},[B_,q_]=(()=>pe.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(n=>BigInt(n))))(),ii=new Uint32Array(80),ni=new Uint32Array(80);class j_ extends d_{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:r,Bh:s,Bl:o,Ch:c,Cl:h,Dh:p,Dl:f,Eh:y,El:v,Fh:b,Fl:S,Gh:O,Gl:F,Hh:N,Hl:G}=this;return[t,r,s,o,c,h,p,f,y,v,b,S,O,F,N,G]}set(t,r,s,o,c,h,p,f,y,v,b,S,O,F,N,G){this.Ah=t|0,this.Al=r|0,this.Bh=s|0,this.Bl=o|0,this.Ch=c|0,this.Cl=h|0,this.Dh=p|0,this.Dl=f|0,this.Eh=y|0,this.El=v|0,this.Fh=b|0,this.Fl=S|0,this.Gh=O|0,this.Gl=F|0,this.Hh=N|0,this.Hl=G|0}process(t,r){for(let B=0;B<16;B++,r+=4)ii[B]=t.getUint32(r),ni[B]=t.getUint32(r+=4);for(let B=16;B<80;B++){const U=ii[B-15]|0,Y=ni[B-15]|0,he=pe.rotrSH(U,Y,1)^pe.rotrSH(U,Y,8)^pe.shrSH(U,Y,7),ie=pe.rotrSL(U,Y,1)^pe.rotrSL(U,Y,8)^pe.shrSL(U,Y,7),ue=ii[B-2]|0,de=ni[B-2]|0,gt=pe.rotrSH(ue,de,19)^pe.rotrBH(ue,de,61)^pe.shrSH(ue,de,6),yt=pe.rotrSL(ue,de,19)^pe.rotrBL(ue,de,61)^pe.shrSL(ue,de,6),Re=pe.add4L(ie,yt,ni[B-7],ni[B-16]),er=pe.add4H(Re,he,gt,ii[B-7],ii[B-16]);ii[B]=er|0,ni[B]=Re|0}let{Ah:s,Al:o,Bh:c,Bl:h,Ch:p,Cl:f,Dh:y,Dl:v,Eh:b,El:S,Fh:O,Fl:F,Gh:N,Gl:G,Hh:H,Hl:Z}=this;for(let B=0;B<80;B++){const U=pe.rotrSH(b,S,14)^pe.rotrSH(b,S,18)^pe.rotrBH(b,S,41),Y=pe.rotrSL(b,S,14)^pe.rotrSL(b,S,18)^pe.rotrBL(b,S,41),he=b&O^~b&N,ie=S&F^~S&G,ue=pe.add5L(Z,Y,ie,q_[B],ni[B]),de=pe.add5H(ue,H,U,he,B_[B],ii[B]),gt=ue|0,yt=pe.rotrSH(s,o,28)^pe.rotrBH(s,o,34)^pe.rotrBH(s,o,39),Re=pe.rotrSL(s,o,28)^pe.rotrBL(s,o,34)^pe.rotrBL(s,o,39),er=s&c^s&p^c&p,Lt=o&h^o&f^h&f;H=N|0,Z=G|0,N=O|0,G=F|0,O=b|0,F=S|0,{h:b,l:S}=pe.add(y|0,v|0,de|0,gt|0),y=p|0,v=f|0,p=c|0,f=h|0,c=s|0,h=o|0;const E=pe.add3L(gt,Re,Lt);s=pe.add3H(E,de,yt,er),o=E|0}({h:s,l:o}=pe.add(this.Ah|0,this.Al|0,s|0,o|0)),{h:c,l:h}=pe.add(this.Bh|0,this.Bl|0,c|0,h|0),{h:p,l:f}=pe.add(this.Ch|0,this.Cl|0,p|0,f|0),{h:y,l:v}=pe.add(this.Dh|0,this.Dl|0,y|0,v|0),{h:b,l:S}=pe.add(this.Eh|0,this.El|0,b|0,S|0),{h:O,l:F}=pe.add(this.Fh|0,this.Fl|0,O|0,F|0),{h:N,l:G}=pe.add(this.Gh|0,this.Gl|0,N|0,G|0),{h:H,l:Z}=pe.add(this.Hh|0,this.Hl|0,H|0,Z|0),this.set(s,o,c,h,p,f,y,v,b,S,O,F,N,G,H,Z)}roundClean(){ii.fill(0),ni.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const z_=f_(()=>new j_);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const pu=BigInt(0),_p=BigInt(1),L_=BigInt(2);function du(n){return n instanceof Uint8Array||ArrayBuffer.isView(n)&&n.constructor.name==="Uint8Array"}function gu(n){if(!du(n))throw new Error("Uint8Array expected")}function Nc(n,t){if(typeof t!="boolean")throw new Error(n+" boolean expected, got "+t)}const U_=Array.from({length:256},(n,t)=>t.toString(16).padStart(2,"0"));function yu(n){gu(n);let t="";for(let r=0;r<n.length;r++)t+=U_[n[r]];return t}function Ep(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);return n===""?pu:BigInt("0x"+n)}const Br={_0:48,_9:57,A:65,F:70,a:97,f:102};function Jl(n){if(n>=Br._0&&n<=Br._9)return n-Br._0;if(n>=Br.A&&n<=Br.F)return n-(Br.A-10);if(n>=Br.a&&n<=Br.f)return n-(Br.a-10)}function Ip(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);const t=n.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const s=new Uint8Array(r);for(let o=0,c=0;o<r;o++,c+=2){const h=Jl(n.charCodeAt(c)),p=Jl(n.charCodeAt(c+1));if(h===void 0||p===void 0){const f=n[c]+n[c+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+c)}s[o]=h*16+p}return s}function M_(n){return Ep(yu(n))}function qo(n){return gu(n),Ep(yu(Uint8Array.from(n).reverse()))}function Pp(n,t){return Ip(n.toString(16).padStart(t*2,"0"))}function tu(n,t){return Pp(n,t).reverse()}function qr(n,t,r){let s;if(typeof t=="string")try{s=Ip(t)}catch(c){throw new Error(n+" must be hex string or Uint8Array, cause: "+c)}else if(du(t))s=Uint8Array.from(t);else throw new Error(n+" must be hex string or Uint8Array");const o=s.length;if(typeof r=="number"&&o!==r)throw new Error(n+" of length "+r+" expected, got "+o);return s}function Ql(...n){let t=0;for(let s=0;s<n.length;s++){const o=n[s];gu(o),t+=o.length}const r=new Uint8Array(t);for(let s=0,o=0;s<n.length;s++){const c=n[s];r.set(c,o),o+=c.length}return r}const Dc=n=>typeof n=="bigint"&&pu<=n;function H_(n,t,r){return Dc(n)&&Dc(t)&&Dc(r)&&t<=n&&n<r}function Wn(n,t,r,s){if(!H_(t,r,s))throw new Error("expected valid "+n+": "+r+" <= n < "+s+", got "+t)}function k_(n){let t;for(t=0;n>pu;n>>=_p,t+=1);return t}const V_=n=>(L_<<BigInt(n-1))-_p,K_={bigint:n=>typeof n=="bigint",function:n=>typeof n=="function",boolean:n=>typeof n=="boolean",string:n=>typeof n=="string",stringOrUint8Array:n=>typeof n=="string"||du(n),isSafeInteger:n=>Number.isSafeInteger(n),array:n=>Array.isArray(n),field:(n,t)=>t.Fp.isValid(n),hash:n=>typeof n=="function"&&Number.isSafeInteger(n.outputLen)};function vu(n,t,r={}){const s=(o,c,h)=>{const p=K_[c];if(typeof p!="function")throw new Error("invalid validator function");const f=n[o];if(!(h&&f===void 0)&&!p(f,n))throw new Error("param "+String(o)+" is invalid. Expected "+c+", got "+f)};for(const[o,c]of Object.entries(t))s(o,c,!1);for(const[o,c]of Object.entries(r))s(o,c,!0);return n}function Yl(n){const t=new WeakMap;return(r,...s)=>{const o=t.get(r);if(o!==void 0)return o;const c=n(r,...s);return t.set(r,c),c}}const Xe=BigInt(0),He=BigInt(1),Ai=BigInt(2),G_=BigInt(3),ru=BigInt(4),Zl=BigInt(5),Xl=BigInt(8);function Je(n,t){const r=n%t;return r>=Xe?r:t+r}function W_(n,t,r){if(t<Xe)throw new Error("invalid exponent, negatives unsupported");if(r<=Xe)throw new Error("invalid modulus");if(r===He)return Xe;let s=He;for(;t>Xe;)t&He&&(s=s*n%r),n=n*n%r,t>>=He;return s}function mr(n,t,r){let s=n;for(;t-- >Xe;)s*=s,s%=r;return s}function ef(n,t){if(n===Xe)throw new Error("invert: expected non-zero number");if(t<=Xe)throw new Error("invert: expected positive modulus, got "+t);let r=Je(n,t),s=t,o=Xe,c=He;for(;r!==Xe;){const h=s/r,p=s%r,f=o-c*h;s=r,r=p,o=c,c=f}if(s!==He)throw new Error("invert: does not exist");return Je(o,t)}function J_(n){const t=(n-He)/Ai;let r,s,o;for(r=n-He,s=0;r%Ai===Xe;r/=Ai,s++);for(o=Ai;o<n&&W_(o,t,n)!==n-He;o++)if(o>1e3)throw new Error("Cannot find square root: likely non-prime P");if(s===1){const h=(n+He)/ru;return function(p,f){const y=p.pow(f,h);if(!p.eql(p.sqr(y),f))throw new Error("Cannot find square root");return y}}const c=(r+He)/Ai;return function(h,p){if(h.pow(p,t)===h.neg(h.ONE))throw new Error("Cannot find square root");let f=s,y=h.pow(h.mul(h.ONE,o),r),v=h.pow(p,c),b=h.pow(p,r);for(;!h.eql(b,h.ONE);){if(h.eql(b,h.ZERO))return h.ZERO;let S=1;for(let F=h.sqr(b);S<f&&!h.eql(F,h.ONE);S++)F=h.sqr(F);const O=h.pow(y,He<<BigInt(f-S-1));y=h.sqr(O),v=h.mul(v,O),b=h.mul(b,y),f=S}return v}}function Q_(n){if(n%ru===G_){const t=(n+He)/ru;return function(r,s){const o=r.pow(s,t);if(!r.eql(r.sqr(o),s))throw new Error("Cannot find square root");return o}}if(n%Xl===Zl){const t=(n-Zl)/Xl;return function(r,s){const o=r.mul(s,Ai),c=r.pow(o,t),h=r.mul(s,c),p=r.mul(r.mul(h,Ai),c),f=r.mul(h,r.sub(p,r.ONE));if(!r.eql(r.sqr(f),s))throw new Error("Cannot find square root");return f}}return J_(n)}const Y_=(n,t)=>(Je(n,t)&He)===He,Z_=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function X_(n){const t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=Z_.reduce((s,o)=>(s[o]="function",s),t);return vu(n,r)}function eE(n,t,r){if(r<Xe)throw new Error("invalid exponent, negatives unsupported");if(r===Xe)return n.ONE;if(r===He)return t;let s=n.ONE,o=t;for(;r>Xe;)r&He&&(s=n.mul(s,o)),o=n.sqr(o),r>>=He;return s}function tE(n,t){const r=new Array(t.length),s=t.reduce((c,h,p)=>n.is0(h)?c:(r[p]=c,n.mul(c,h)),n.ONE),o=n.inv(s);return t.reduceRight((c,h,p)=>n.is0(h)?c:(r[p]=n.mul(c,r[p]),n.mul(c,h)),o),r}function xp(n,t){const r=t!==void 0?t:n.toString(2).length,s=Math.ceil(r/8);return{nBitLength:r,nByteLength:s}}function Sp(n,t,r=!1,s={}){if(n<=Xe)throw new Error("invalid field: expected ORDER > 0, got "+n);const{nBitLength:o,nByteLength:c}=xp(n,t);if(c>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let h;const p=Object.freeze({ORDER:n,isLE:r,BITS:o,BYTES:c,MASK:V_(o),ZERO:Xe,ONE:He,create:f=>Je(f,n),isValid:f=>{if(typeof f!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof f);return Xe<=f&&f<n},is0:f=>f===Xe,isOdd:f=>(f&He)===He,neg:f=>Je(-f,n),eql:(f,y)=>f===y,sqr:f=>Je(f*f,n),add:(f,y)=>Je(f+y,n),sub:(f,y)=>Je(f-y,n),mul:(f,y)=>Je(f*y,n),pow:(f,y)=>eE(p,f,y),div:(f,y)=>Je(f*ef(y,n),n),sqrN:f=>f*f,addN:(f,y)=>f+y,subN:(f,y)=>f-y,mulN:(f,y)=>f*y,inv:f=>ef(f,n),sqrt:s.sqrt||(f=>(h||(h=Q_(n)),h(p,f))),invertBatch:f=>tE(p,f),cmov:(f,y,v)=>v?y:f,toBytes:f=>r?tu(f,c):Pp(f,c),fromBytes:f=>{if(f.length!==c)throw new Error("Field.fromBytes: expected "+c+" bytes, got "+f.length);return r?qo(f):M_(f)}});return Object.freeze(p)}const tf=BigInt(0),Fo=BigInt(1);function Bc(n,t){const r=t.negate();return n?r:t}function Ap(n,t){if(!Number.isSafeInteger(n)||n<=0||n>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+n)}function qc(n,t){Ap(n,t);const r=Math.ceil(t/n)+1,s=2**(n-1);return{windows:r,windowSize:s}}function rE(n,t){if(!Array.isArray(n))throw new Error("array expected");n.forEach((r,s)=>{if(!(r instanceof t))throw new Error("invalid point at index "+s)})}function iE(n,t){if(!Array.isArray(n))throw new Error("array of scalars expected");n.forEach((r,s)=>{if(!t.isValid(r))throw new Error("invalid scalar at index "+s)})}const jc=new WeakMap,Fp=new WeakMap;function zc(n){return Fp.get(n)||1}function nE(n,t){return{constTimeNegate:Bc,hasPrecomputes(r){return zc(r)!==1},unsafeLadder(r,s,o=n.ZERO){let c=r;for(;s>tf;)s&Fo&&(o=o.add(c)),c=c.double(),s>>=Fo;return o},precomputeWindow(r,s){const{windows:o,windowSize:c}=qc(s,t),h=[];let p=r,f=p;for(let y=0;y<o;y++){f=p,h.push(f);for(let v=1;v<c;v++)f=f.add(p),h.push(f);p=f.double()}return h},wNAF(r,s,o){const{windows:c,windowSize:h}=qc(r,t);let p=n.ZERO,f=n.BASE;const y=BigInt(2**r-1),v=2**r,b=BigInt(r);for(let S=0;S<c;S++){const O=S*h;let F=Number(o&y);o>>=b,F>h&&(F-=v,o+=Fo);const N=O,G=O+Math.abs(F)-1,H=S%2!==0,Z=F<0;F===0?f=f.add(Bc(H,s[N])):p=p.add(Bc(Z,s[G]))}return{p,f}},wNAFUnsafe(r,s,o,c=n.ZERO){const{windows:h,windowSize:p}=qc(r,t),f=BigInt(2**r-1),y=2**r,v=BigInt(r);for(let b=0;b<h;b++){const S=b*p;if(o===tf)break;let O=Number(o&f);if(o>>=v,O>p&&(O-=y,o+=Fo),O===0)continue;let F=s[S+Math.abs(O)-1];O<0&&(F=F.negate()),c=c.add(F)}return c},getPrecomputes(r,s,o){let c=jc.get(s);return c||(c=this.precomputeWindow(s,r),r!==1&&jc.set(s,o(c))),c},wNAFCached(r,s,o){const c=zc(r);return this.wNAF(c,this.getPrecomputes(c,r,o),s)},wNAFCachedUnsafe(r,s,o,c){const h=zc(r);return h===1?this.unsafeLadder(r,s,c):this.wNAFUnsafe(h,this.getPrecomputes(h,r,o),s,c)},setWindowSize(r,s){Ap(s,t),Fp.set(r,s),jc.delete(r)}}}function sE(n,t,r,s){if(rE(r,n),iE(s,t),r.length!==s.length)throw new Error("arrays of points and scalars must have equal length");const o=n.ZERO,c=k_(BigInt(r.length)),h=c>12?c-3:c>4?c-2:c?2:1,p=(1<<h)-1,f=new Array(p+1).fill(o),y=Math.floor((t.BITS-1)/h)*h;let v=o;for(let b=y;b>=0;b-=h){f.fill(o);for(let O=0;O<s.length;O++){const F=s[O],N=Number(F>>BigInt(b)&BigInt(p));f[N]=f[N].add(r[O])}let S=o;for(let O=f.length-1,F=o;O>0;O--)F=F.add(f[O]),S=S.add(F);if(v=v.add(S),b!==0)for(let O=0;O<h;O++)v=v.double()}return v}function oE(n){return X_(n.Fp),vu(n,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...xp(n.n,n.nBitLength),...n,p:n.Fp.ORDER})}const ar=BigInt(0),Et=BigInt(1),Oo=BigInt(2),aE=BigInt(8),cE={zip215:!0};function uE(n){const t=oE(n);return vu(n,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function hE(n){const t=uE(n),{Fp:r,n:s,prehash:o,hash:c,randomBytes:h,nByteLength:p,h:f}=t,y=Oo<<BigInt(p*8)-Et,v=r.create,b=Sp(t.n,t.nBitLength),S=t.uvRatio||((E,A)=>{try{return{isValid:!0,value:r.sqrt(E*r.inv(A))}}catch{return{isValid:!1,value:ar}}}),O=t.adjustScalarBytes||(E=>E),F=t.domain||((E,A,j)=>{if(Nc("phflag",j),A.length||j)throw new Error("Contexts/pre-hash are not supported");return E});function N(E,A){Wn("coordinate "+E,A,ar,y)}function G(E){if(!(E instanceof B))throw new Error("ExtendedPoint expected")}const H=Yl((E,A)=>{const{ex:j,ey:z,ez:W}=E,M=E.is0();A==null&&(A=M?aE:r.inv(W));const ne=v(j*A),Ee=v(z*A),be=v(W*A);if(M)return{x:ar,y:Et};if(be!==Et)throw new Error("invZ was invalid");return{x:ne,y:Ee}}),Z=Yl(E=>{const{a:A,d:j}=t;if(E.is0())throw new Error("bad point: ZERO");const{ex:z,ey:W,ez:M,et:ne}=E,Ee=v(z*z),be=v(W*W),se=v(M*M),Q=v(se*se),qe=v(Ee*A),Ot=v(se*v(qe+be)),Ce=v(Q+v(j*v(Ee*be)));if(Ot!==Ce)throw new Error("bad point: equation left != right (1)");const ze=v(z*W),Rt=v(M*ne);if(ze!==Rt)throw new Error("bad point: equation left != right (2)");return!0});class B{constructor(A,j,z,W){this.ex=A,this.ey=j,this.ez=z,this.et=W,N("x",A),N("y",j),N("z",z),N("t",W),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(A){if(A instanceof B)throw new Error("extended point not allowed");const{x:j,y:z}=A||{};return N("x",j),N("y",z),new B(j,z,Et,v(j*z))}static normalizeZ(A){const j=r.invertBatch(A.map(z=>z.ez));return A.map((z,W)=>z.toAffine(j[W])).map(B.fromAffine)}static msm(A,j){return sE(B,b,A,j)}_setWindowSize(A){he.setWindowSize(this,A)}assertValidity(){Z(this)}equals(A){G(A);const{ex:j,ey:z,ez:W}=this,{ex:M,ey:ne,ez:Ee}=A,be=v(j*Ee),se=v(M*W),Q=v(z*Ee),qe=v(ne*W);return be===se&&Q===qe}is0(){return this.equals(B.ZERO)}negate(){return new B(v(-this.ex),this.ey,this.ez,v(-this.et))}double(){const{a:A}=t,{ex:j,ey:z,ez:W}=this,M=v(j*j),ne=v(z*z),Ee=v(Oo*v(W*W)),be=v(A*M),se=j+z,Q=v(v(se*se)-M-ne),qe=be+ne,Ot=qe-Ee,Ce=be-ne,ze=v(Q*Ot),Rt=v(qe*Ce),ht=v(Q*Ce),Ct=v(Ot*qe);return new B(ze,Rt,Ct,ht)}add(A){G(A);const{a:j,d:z}=t,{ex:W,ey:M,ez:ne,et:Ee}=this,{ex:be,ey:se,ez:Q,et:qe}=A;if(j===BigInt(-1)){const Ni=v((M-W)*(se+be)),hr=v((M+W)*(se-be)),tt=v(hr-Ni);if(tt===ar)return this.double();const lr=v(ne*Oo*qe),Er=v(Ee*Oo*Q),Di=Er+lr,fr=hr+Ni,Bi=Er-lr,Ut=v(Di*tt),Mt=v(fr*Bi),Vr=v(Di*Bi),st=v(tt*fr);return new B(Ut,Mt,st,Vr)}const Ot=v(W*be),Ce=v(M*se),ze=v(Ee*z*qe),Rt=v(ne*Q),ht=v((W+M)*(be+se)-Ot-Ce),Ct=Rt-ze,kr=Rt+ze,et=v(Ce-j*Ot),_r=v(ht*Ct),wn=v(kr*et),$t=v(ht*et),Ti=v(Ct*kr);return new B(_r,wn,Ti,$t)}subtract(A){return this.add(A.negate())}wNAF(A){return he.wNAFCached(this,A,B.normalizeZ)}multiply(A){const j=A;Wn("scalar",j,Et,s);const{p:z,f:W}=this.wNAF(j);return B.normalizeZ([z,W])[0]}multiplyUnsafe(A,j=B.ZERO){const z=A;return Wn("scalar",z,ar,s),z===ar?Y:this.is0()||z===Et?this:he.wNAFCachedUnsafe(this,z,B.normalizeZ,j)}isSmallOrder(){return this.multiplyUnsafe(f).is0()}isTorsionFree(){return he.unsafeLadder(this,s).is0()}toAffine(A){return H(this,A)}clearCofactor(){const{h:A}=t;return A===Et?this:this.multiplyUnsafe(A)}static fromHex(A,j=!1){const{d:z,a:W}=t,M=r.BYTES;A=qr("pointHex",A,M),Nc("zip215",j);const ne=A.slice(),Ee=A[M-1];ne[M-1]=Ee&-129;const be=qo(ne),se=j?y:r.ORDER;Wn("pointHex.y",be,ar,se);const Q=v(be*be),qe=v(Q-Et),Ot=v(z*Q-W);let{isValid:Ce,value:ze}=S(qe,Ot);if(!Ce)throw new Error("Point.fromHex: invalid y coordinate");const Rt=(ze&Et)===Et,ht=(Ee&128)!==0;if(!j&&ze===ar&&ht)throw new Error("Point.fromHex: x=0 and x_0=1");return ht!==Rt&&(ze=v(-ze)),B.fromAffine({x:ze,y:be})}static fromPrivateKey(A){return de(A).point}toRawBytes(){const{x:A,y:j}=this.toAffine(),z=tu(j,r.BYTES);return z[z.length-1]|=A&Et?128:0,z}toHex(){return yu(this.toRawBytes())}}B.BASE=new B(t.Gx,t.Gy,Et,v(t.Gx*t.Gy)),B.ZERO=new B(ar,Et,Et,ar);const{BASE:U,ZERO:Y}=B,he=nE(B,p*8);function ie(E){return Je(E,s)}function ue(E){return ie(qo(E))}function de(E){const A=r.BYTES;E=qr("private key",E,A);const j=qr("hashed private key",c(E),2*A),z=O(j.slice(0,A)),W=j.slice(A,2*A),M=ue(z),ne=U.multiply(M),Ee=ne.toRawBytes();return{head:z,prefix:W,scalar:M,point:ne,pointBytes:Ee}}function gt(E){return de(E).pointBytes}function yt(E=new Uint8Array,...A){const j=Ql(...A);return ue(c(F(j,qr("context",E),!!o)))}function Re(E,A,j={}){E=qr("message",E),o&&(E=o(E));const{prefix:z,scalar:W,pointBytes:M}=de(A),ne=yt(j.context,z,E),Ee=U.multiply(ne).toRawBytes(),be=yt(j.context,Ee,M,E),se=ie(ne+be*W);Wn("signature.s",se,ar,s);const Q=Ql(Ee,tu(se,r.BYTES));return qr("result",Q,r.BYTES*2)}const er=cE;function Lt(E,A,j,z=er){const{context:W,zip215:M}=z,ne=r.BYTES;E=qr("signature",E,2*ne),A=qr("message",A),j=qr("publicKey",j,ne),M!==void 0&&Nc("zip215",M),o&&(A=o(A));const Ee=qo(E.slice(ne,2*ne));let be,se,Q;try{be=B.fromHex(j,M),se=B.fromHex(E.slice(0,ne),M),Q=U.multiplyUnsafe(Ee)}catch{return!1}if(!M&&be.isSmallOrder())return!1;const qe=yt(W,se.toRawBytes(),be.toRawBytes(),A);return se.add(be.multiplyUnsafe(qe)).subtract(Q).clearCofactor().equals(B.ZERO)}return U._setWindowSize(8),{CURVE:t,getPublicKey:gt,sign:Re,verify:Lt,ExtendedPoint:B,utils:{getExtendedPublicKey:de,randomPrivateKey:()=>h(r.BYTES),precompute(E=8,A=B.BASE){return A._setWindowSize(E),A.multiply(BigInt(3)),A}}}}BigInt(0),BigInt(1);const mu=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),rf=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const lE=BigInt(1),nf=BigInt(2);BigInt(3);const fE=BigInt(5),pE=BigInt(8);function dE(n){const t=BigInt(10),r=BigInt(20),s=BigInt(40),o=BigInt(80),c=mu,h=n*n%c*n%c,p=mr(h,nf,c)*h%c,f=mr(p,lE,c)*n%c,y=mr(f,fE,c)*f%c,v=mr(y,t,c)*y%c,b=mr(v,r,c)*v%c,S=mr(b,s,c)*b%c,O=mr(S,o,c)*S%c,F=mr(O,o,c)*S%c,N=mr(F,t,c)*y%c;return{pow_p_5_8:mr(N,nf,c)*n%c,b2:h}}function gE(n){return n[0]&=248,n[31]&=127,n[31]|=64,n}function yE(n,t){const r=mu,s=Je(t*t*t,r),o=Je(s*s*t,r),c=dE(n*o).pow_p_5_8;let h=Je(n*s*c,r);const p=Je(t*h*h,r),f=h,y=Je(h*rf,r),v=p===n,b=p===Je(-n,r),S=p===Je(-n*rf,r);return v&&(h=f),(b||S)&&(h=y),Y_(h,r)&&(h=Je(-h,r)),{isValid:v||b,value:h}}const vE=(()=>Sp(mu,void 0,!0))(),mE=(()=>({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:vE,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:pE,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:z_,randomBytes:wp,adjustScalarBytes:gE,uvRatio:yE}))(),Op=(()=>hE(mE))(),wE="EdDSA",bE="JWT",Rp=".",Cp="base64url",_E="utf8",EE="utf8",IE=":",PE="did",xE="key",sf="base58btc",SE="z",AE="K36",FE=32;function wu(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function $p(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?wu(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Tp(n,t){t||(t=n.reduce((o,c)=>o+c.length,0));const r=$p(t);let s=0;for(const o of n)r.set(o,s),s+=o.length;return wu(r)}function OE(n,t){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var o=0;o<n.length;o++){var c=n.charAt(o),h=c.charCodeAt(0);if(r[h]!==255)throw new TypeError(c+" is ambiguous");r[h]=o}var p=n.length,f=n.charAt(0),y=Math.log(p)/Math.log(256),v=Math.log(256)/Math.log(p);function b(F){if(F instanceof Uint8Array||(ArrayBuffer.isView(F)?F=new Uint8Array(F.buffer,F.byteOffset,F.byteLength):Array.isArray(F)&&(F=Uint8Array.from(F))),!(F instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(F.length===0)return"";for(var N=0,G=0,H=0,Z=F.length;H!==Z&&F[H]===0;)H++,N++;for(var B=(Z-H)*v+1>>>0,U=new Uint8Array(B);H!==Z;){for(var Y=F[H],he=0,ie=B-1;(Y!==0||he<G)&&ie!==-1;ie--,he++)Y+=256*U[ie]>>>0,U[ie]=Y%p>>>0,Y=Y/p>>>0;if(Y!==0)throw new Error("Non-zero carry");G=he,H++}for(var ue=B-G;ue!==B&&U[ue]===0;)ue++;for(var de=f.repeat(N);ue<B;++ue)de+=n.charAt(U[ue]);return de}function S(F){if(typeof F!="string")throw new TypeError("Expected String");if(F.length===0)return new Uint8Array;var N=0;if(F[N]!==" "){for(var G=0,H=0;F[N]===f;)G++,N++;for(var Z=(F.length-N)*y+1>>>0,B=new Uint8Array(Z);F[N];){var U=r[F.charCodeAt(N)];if(U===255)return;for(var Y=0,he=Z-1;(U!==0||Y<H)&&he!==-1;he--,Y++)U+=p*B[he]>>>0,B[he]=U%256>>>0,U=U/256>>>0;if(U!==0)throw new Error("Non-zero carry");H=Y,N++}if(F[N]!==" "){for(var ie=Z-H;ie!==Z&&B[ie]===0;)ie++;for(var ue=new Uint8Array(G+(Z-ie)),de=G;ie!==Z;)ue[de++]=B[ie++];return ue}}}function O(F){var N=S(F);if(N)return N;throw new Error(`Non-${t} character`)}return{encode:b,decodeUnsafe:S,decode:O}}var RE=OE,CE=RE;const Np=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},$E=n=>new TextEncoder().encode(n),TE=n=>new TextDecoder().decode(n);let NE=class{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},DE=class{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Dp(this,t)}};class BE{constructor(t){this.decoders=t}or(t){return Dp(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Dp=(n,t)=>new BE({...n.decoders||{[n.prefix]:n},...t.decoders||{[t.prefix]:t}});let qE=class{constructor(t,r,s,o){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=o,this.encoder=new NE(t,r,s),this.decoder=new DE(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}};const Vo=({name:n,prefix:t,encode:r,decode:s})=>new qE(n,t,r,s),ls=({prefix:n,name:t,alphabet:r})=>{const{encode:s,decode:o}=CE(r,t);return Vo({prefix:n,name:t,encode:s,decode:c=>Np(o(c))})},jE=(n,t,r,s)=>{const o={};for(let v=0;v<t.length;++v)o[t[v]]=v;let c=n.length;for(;n[c-1]==="=";)--c;const h=new Uint8Array(c*r/8|0);let p=0,f=0,y=0;for(let v=0;v<c;++v){const b=o[n[v]];if(b===void 0)throw new SyntaxError(`Non-${s} character`);f=f<<r|b,p+=r,p>=8&&(p-=8,h[y++]=255&f>>p)}if(p>=r||255&f<<8-p)throw new SyntaxError("Unexpected end of data");return h},zE=(n,t,r)=>{const s=t[t.length-1]==="=",o=(1<<r)-1;let c="",h=0,p=0;for(let f=0;f<n.length;++f)for(p=p<<8|n[f],h+=8;h>r;)h-=r,c+=t[o&p>>h];if(h&&(c+=t[o&p<<r-h]),s)for(;c.length*r&7;)c+="=";return c},it=({name:n,prefix:t,bitsPerChar:r,alphabet:s})=>Vo({prefix:t,name:n,encode(o){return zE(o,s,r)},decode(o){return jE(o,s,r,n)}}),LE=Vo({prefix:"\0",name:"identity",encode:n=>TE(n),decode:n=>$E(n)});var UE=Object.freeze({__proto__:null,identity:LE});const ME=it({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var HE=Object.freeze({__proto__:null,base2:ME});const kE=it({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var VE=Object.freeze({__proto__:null,base8:kE});const KE=ls({prefix:"9",name:"base10",alphabet:"0123456789"});var GE=Object.freeze({__proto__:null,base10:KE});const WE=it({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),JE=it({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var QE=Object.freeze({__proto__:null,base16:WE,base16upper:JE});const YE=it({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ZE=it({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),XE=it({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),eI=it({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),tI=it({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),rI=it({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),iI=it({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),nI=it({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),sI=it({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var oI=Object.freeze({__proto__:null,base32:YE,base32upper:ZE,base32pad:XE,base32padupper:eI,base32hex:tI,base32hexupper:rI,base32hexpad:iI,base32hexpadupper:nI,base32z:sI});const aI=ls({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),cI=ls({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var uI=Object.freeze({__proto__:null,base36:aI,base36upper:cI});const hI=ls({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),lI=ls({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var fI=Object.freeze({__proto__:null,base58btc:hI,base58flickr:lI});const pI=it({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),dI=it({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),gI=it({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),yI=it({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var vI=Object.freeze({__proto__:null,base64:pI,base64pad:dI,base64url:gI,base64urlpad:yI});const Bp=Array.from(""),mI=Bp.reduce((n,t,r)=>(n[r]=t,n),[]),wI=Bp.reduce((n,t,r)=>(n[t.codePointAt(0)]=r,n),[]);function bI(n){return n.reduce((t,r)=>(t+=mI[r],t),"")}function _I(n){const t=[];for(const r of n){const s=wI[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const EI=Vo({prefix:"",name:"base256emoji",encode:bI,decode:_I});var II=Object.freeze({__proto__:null,base256emoji:EI}),PI=qp,of=128,xI=127,SI=~xI,AI=Math.pow(2,31);function qp(n,t,r){t=t||[],r=r||0;for(var s=r;n>=AI;)t[r++]=n&255|of,n/=128;for(;n&SI;)t[r++]=n&255|of,n>>>=7;return t[r]=n|0,qp.bytes=r-s+1,t}var FI=iu,OI=128,af=127;function iu(n,s){var r=0,s=s||0,o=0,c=s,h,p=n.length;do{if(c>=p)throw iu.bytes=0,new RangeError("Could not decode varint");h=n[c++],r+=o<28?(h&af)<<o:(h&af)*Math.pow(2,o),o+=7}while(h>=OI);return iu.bytes=c-s,r}var RI=Math.pow(2,7),CI=Math.pow(2,14),$I=Math.pow(2,21),TI=Math.pow(2,28),NI=Math.pow(2,35),DI=Math.pow(2,42),BI=Math.pow(2,49),qI=Math.pow(2,56),jI=Math.pow(2,63),zI=function(n){return n<RI?1:n<CI?2:n<$I?3:n<TI?4:n<NI?5:n<DI?6:n<BI?7:n<qI?8:n<jI?9:10},LI={encode:PI,decode:FI,encodingLength:zI},jp=LI;const cf=(n,t,r=0)=>(jp.encode(n,t,r),t),uf=n=>jp.encodingLength(n),nu=(n,t)=>{const r=t.byteLength,s=uf(n),o=s+uf(r),c=new Uint8Array(o+r);return cf(n,c,0),cf(r,c,s),c.set(t,o),new UI(n,r,t,c)};class UI{constructor(t,r,s,o){this.code=t,this.size=r,this.digest=s,this.bytes=o}}const zp=({name:n,code:t,encode:r})=>new MI(n,t,r);class MI{constructor(t,r,s){this.name=t,this.code=r,this.encode=s}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?nu(this.code,r):r.then(s=>nu(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Lp=n=>async t=>new Uint8Array(await crypto.subtle.digest(n,t)),HI=zp({name:"sha2-256",code:18,encode:Lp("SHA-256")}),kI=zp({name:"sha2-512",code:19,encode:Lp("SHA-512")});var VI=Object.freeze({__proto__:null,sha256:HI,sha512:kI});const Up=0,KI="identity",Mp=Np,GI=n=>nu(Up,Mp(n)),WI={code:Up,name:KI,encode:Mp,digest:GI};var JI=Object.freeze({__proto__:null,identity:WI});new TextEncoder,new TextDecoder;const hf={...UE,...HE,...VE,...GE,...QE,...oI,...uI,...fI,...vI,...II};({...VI,...JI});function Hp(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const lf=Hp("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),Lc=Hp("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=$p(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),kp={utf8:lf,"utf-8":lf,hex:hf.base16,latin1:Lc,ascii:Lc,binary:Lc,...hf};function bu(n,t="utf8"){const r=kp[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):r.encoder.encode(n).substring(1)}function _u(n,t="utf8"){const r=kp[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?wu(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}function jo(n){return bu(_u(Oi(n),_E),Cp)}function Vp(n){const t=_u(AE,sf),r=SE+bu(Tp([t,n]),sf);return[PE,xE,r].join(IE)}function QI(n){return bu(n,Cp)}function YI(n){return _u([jo(n.header),jo(n.payload)].join(Rp),EE)}function ZI(n){return[jo(n.header),jo(n.payload),QI(n.signature)].join(Rp)}function ff(n=wp(FE)){const t=Op.getPublicKey(n);return{secretKey:Tp([n,t]),publicKey:t}}async function XI(n,t,r,s,o=X.fromMiliseconds(Date.now())){const c={alg:wE,typ:bE},h=Vp(s.publicKey),p=o+r,f={iss:h,sub:n,aud:t,iat:o,exp:p},y=YI({header:c,payload:f}),v=Op.sign(y,s.secretKey.slice(0,32));return ZI({header:c,payload:f,signature:v})}const e2="PARSE_ERROR",t2="INVALID_REQUEST",r2="METHOD_NOT_FOUND",i2="INVALID_PARAMS",Kp="INTERNAL_ERROR",Eu="SERVER_ERROR",n2=[-32700,-32600,-32601,-32602,-32603],is={[e2]:{code:-32700,message:"Parse error"},[t2]:{code:-32600,message:"Invalid Request"},[r2]:{code:-32601,message:"Method not found"},[i2]:{code:-32602,message:"Invalid params"},[Kp]:{code:-32603,message:"Internal error"},[Eu]:{code:-32e3,message:"Server error"}},Gp=Eu;function s2(n){return n2.includes(n)}function pf(n){return Object.keys(is).includes(n)?is[n]:is[Gp]}function o2(n){const t=Object.values(is).find(r=>r.code===n);return t||is[Gp]}function Wp(n,t,r){return n.message.includes("getaddrinfo ENOTFOUND")||n.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):n}var Jp={},jr={},df;function a2(){if(df)return jr;df=1,Object.defineProperty(jr,"__esModule",{value:!0}),jr.isBrowserCryptoAvailable=jr.getSubtleCrypto=jr.getBrowerCrypto=void 0;function n(){return(St===null||St===void 0?void 0:St.crypto)||(St===null||St===void 0?void 0:St.msCrypto)||{}}jr.getBrowerCrypto=n;function t(){const s=n();return s.subtle||s.webkitSubtle}jr.getSubtleCrypto=t;function r(){return!!n()&&!!t()}return jr.isBrowserCryptoAvailable=r,jr}var zr={},gf;function c2(){if(gf)return zr;gf=1,Object.defineProperty(zr,"__esModule",{value:!0}),zr.isBrowser=zr.isNode=zr.isReactNative=void 0;function n(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}zr.isReactNative=n;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}zr.isNode=t;function r(){return!n()&&!t()}return zr.isBrowser=r,zr}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=as;t.__exportStar(a2(),n),t.__exportStar(c2(),n)})(Jp);function Iu(n=3){const t=Date.now()*Math.pow(10,n),r=Math.floor(Math.random()*Math.pow(10,n));return t+r}function Pu(n=6){return BigInt(Iu(n))}function Fi(n,t,r){return{id:r||Iu(),jsonrpc:"2.0",method:n,params:t}}function Ko(n,t){return{id:n,jsonrpc:"2.0",result:t}}function Go(n,t,r){return{id:n,jsonrpc:"2.0",error:u2(t,r)}}function u2(n,t){return typeof n>"u"?pf(Kp):(typeof n=="string"&&(n=Object.assign(Object.assign({},pf(Eu)),{message:n})),typeof t<"u"&&(n.data=t),s2(n.code)&&(n=o2(n.code)),n)}class h2{}class l2 extends h2{constructor(){super()}}class Qp extends l2{constructor(t){super()}}const f2="^https?:",p2="^wss?:";function d2(n){const t=n.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function Yp(n,t){const r=d2(n);return typeof r>"u"?!1:new RegExp(t).test(r)}function yf(n){return Yp(n,f2)}function vf(n){return Yp(n,p2)}function g2(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function Zp(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function xu(n){return Zp(n)&&"method"in n}function fs(n){return Zp(n)&&(Mr(n)||Xt(n))}function Mr(n){return"result"in n}function Xt(n){return"error"in n}let y2=class extends Qp{constructor(t){super(t),this.events=new zt.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(Fi(t.method,t.params||[],t.id||Pu().toString()),r)}async requestStrict(t,r){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${t.id}`,c=>{Xt(c)?o(c.error):s(c.result)});try{await this.connection.send(t,r)}catch(c){o(c)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),fs(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const v2=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),m2=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",mf=n=>n.split("?")[0],wf=10,w2=v2();let b2=class{constructor(t){if(this.url=t,this.events=new zt.EventEmitter,this.registering=!1,!vf(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Oi(t))}catch(r){this.onError(t.id,r)}}register(t=this.url){if(!vf(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,s)=>{const o=new URLSearchParams(t).get("origin"),c=Jp.isReactNative()?{headers:{origin:o}}:{rejectUnauthorized:!g2(t)},h=new w2(t,[],c);m2()?h.onerror=p=>{const f=p;s(this.emitError(f.error))}:h.on("error",p=>{s(this.emitError(p))}),h.onopen=()=>{this.onOpen(h),r(h)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?us(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),o=s.message||s.toString(),c=Go(t,o);this.events.emit("payload",c)}parseError(t,r=this.url){return Wp(t,mf(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>wf&&this.events.setMaxListeners(wf)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${mf(this.url)}`));return this.events.emit("register_error",r),r}};var zo={exports:{}};zo.exports;(function(n,t){var r=200,s="__lodash_hash_undefined__",o=1,c=2,h=9007199254740991,p="[object Arguments]",f="[object Array]",y="[object AsyncFunction]",v="[object Boolean]",b="[object Date]",S="[object Error]",O="[object Function]",F="[object GeneratorFunction]",N="[object Map]",G="[object Number]",H="[object Null]",Z="[object Object]",B="[object Promise]",U="[object Proxy]",Y="[object RegExp]",he="[object Set]",ie="[object String]",ue="[object Symbol]",de="[object Undefined]",gt="[object WeakMap]",yt="[object ArrayBuffer]",Re="[object DataView]",er="[object Float32Array]",Lt="[object Float64Array]",E="[object Int8Array]",A="[object Int16Array]",j="[object Int32Array]",z="[object Uint8Array]",W="[object Uint8ClampedArray]",M="[object Uint16Array]",ne="[object Uint32Array]",Ee=/[\\^$.*+?()[\]{}|]/g,be=/^\[object .+?Constructor\]$/,se=/^(?:0|[1-9]\d*)$/,Q={};Q[er]=Q[Lt]=Q[E]=Q[A]=Q[j]=Q[z]=Q[W]=Q[M]=Q[ne]=!0,Q[p]=Q[f]=Q[yt]=Q[v]=Q[Re]=Q[b]=Q[S]=Q[O]=Q[N]=Q[G]=Q[Z]=Q[Y]=Q[he]=Q[ie]=Q[gt]=!1;var qe=typeof St=="object"&&St&&St.Object===Object&&St,Ot=typeof self=="object"&&self&&self.Object===Object&&self,Ce=qe||Ot||Function("return this")(),ze=t&&!t.nodeType&&t,Rt=ze&&!0&&n&&!n.nodeType&&n,ht=Rt&&Rt.exports===ze,Ct=ht&&qe.process,kr=function(){try{return Ct&&Ct.binding&&Ct.binding("util")}catch{}}(),et=kr&&kr.isTypedArray;function _r(m,I){for(var D=-1,k=m==null?0:m.length,Ae=0,ae=[];++D<k;){var $e=m[D];I($e,D,m)&&(ae[Ae++]=$e)}return ae}function wn(m,I){for(var D=-1,k=I.length,Ae=m.length;++D<k;)m[Ae+D]=I[D];return m}function $t(m,I){for(var D=-1,k=m==null?0:m.length;++D<k;)if(I(m[D],D,m))return!0;return!1}function Ti(m,I){for(var D=-1,k=Array(m);++D<m;)k[D]=I(D);return k}function Ni(m){return function(I){return m(I)}}function hr(m,I){return m.has(I)}function tt(m,I){return m==null?void 0:m[I]}function lr(m){var I=-1,D=Array(m.size);return m.forEach(function(k,Ae){D[++I]=[Ae,k]}),D}function Er(m,I){return function(D){return m(I(D))}}function Di(m){var I=-1,D=Array(m.size);return m.forEach(function(k){D[++I]=k}),D}var fr=Array.prototype,Bi=Function.prototype,Ut=Object.prototype,Mt=Ce["__core-js_shared__"],Vr=Bi.toString,st=Ut.hasOwnProperty,qi=function(){var m=/[^.]+$/.exec(Mt&&Mt.keys&&Mt.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),ji=Ut.toString,bn=RegExp("^"+Vr.call(st).replace(Ee,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),zi=ht?Ce.Buffer:void 0,Kr=Ce.Symbol,Li=Ce.Uint8Array,Ui=Ut.propertyIsEnumerable,Qo=fr.splice,Ir=Kr?Kr.toStringTag:void 0,ds=Object.getOwnPropertySymbols,gs=zi?zi.isBuffer:void 0,ys=Er(Object.keys,Object),_n=Tt(Ce,"DataView"),li=Tt(Ce,"Map"),En=Tt(Ce,"Promise"),In=Tt(Ce,"Set"),Mi=Tt(Ce,"WeakMap"),fi=Tt(Object,"create"),Yo=Sr(_n),Zo=Sr(li),Pn=Sr(En),Xo=Sr(In),xn=Sr(Mi),vs=Kr?Kr.prototype:void 0,Sn=vs?vs.valueOf:void 0;function Pr(m){var I=-1,D=m==null?0:m.length;for(this.clear();++I<D;){var k=m[I];this.set(k[0],k[1])}}function ea(){this.__data__=fi?fi(null):{},this.size=0}function ta(m){var I=this.has(m)&&delete this.__data__[m];return this.size-=I?1:0,I}function ra(m){var I=this.__data__;if(fi){var D=I[m];return D===s?void 0:D}return st.call(I,m)?I[m]:void 0}function ia(m){var I=this.__data__;return fi?I[m]!==void 0:st.call(I,m)}function na(m,I){var D=this.__data__;return this.size+=this.has(m)?0:1,D[m]=fi&&I===void 0?s:I,this}Pr.prototype.clear=ea,Pr.prototype.delete=ta,Pr.prototype.get=ra,Pr.prototype.has=ia,Pr.prototype.set=na;function Ht(m){var I=-1,D=m==null?0:m.length;for(this.clear();++I<D;){var k=m[I];this.set(k[0],k[1])}}function sa(){this.__data__=[],this.size=0}function oa(m){var I=this.__data__,D=pi(I,m);if(D<0)return!1;var k=I.length-1;return D==k?I.pop():Qo.call(I,D,1),--this.size,!0}function aa(m){var I=this.__data__,D=pi(I,m);return D<0?void 0:I[D][1]}function ca(m){return pi(this.__data__,m)>-1}function ua(m,I){var D=this.__data__,k=pi(D,m);return k<0?(++this.size,D.push([m,I])):D[k][1]=I,this}Ht.prototype.clear=sa,Ht.prototype.delete=oa,Ht.prototype.get=aa,Ht.prototype.has=ca,Ht.prototype.set=ua;function xr(m){var I=-1,D=m==null?0:m.length;for(this.clear();++I<D;){var k=m[I];this.set(k[0],k[1])}}function Hi(){this.size=0,this.__data__={hash:new Pr,map:new(li||Ht),string:new Pr}}function ha(m){var I=Gr(this,m).delete(m);return this.size-=I?1:0,I}function ki(m){return Gr(this,m).get(m)}function la(m){return Gr(this,m).has(m)}function fa(m,I){var D=Gr(this,m),k=D.size;return D.set(m,I),this.size+=D.size==k?0:1,this}xr.prototype.clear=Hi,xr.prototype.delete=ha,xr.prototype.get=ki,xr.prototype.has=la,xr.prototype.set=fa;function Vi(m){var I=-1,D=m==null?0:m.length;for(this.__data__=new xr;++I<D;)this.add(m[I])}function ms(m){return this.__data__.set(m,s),this}function ws(m){return this.__data__.has(m)}Vi.prototype.add=Vi.prototype.push=ms,Vi.prototype.has=ws;function tr(m){var I=this.__data__=new Ht(m);this.size=I.size}function pa(){this.__data__=new Ht,this.size=0}function da(m){var I=this.__data__,D=I.delete(m);return this.size=I.size,D}function ga(m){return this.__data__.get(m)}function ya(m){return this.__data__.has(m)}function bs(m,I){var D=this.__data__;if(D instanceof Ht){var k=D.__data__;if(!li||k.length<r-1)return k.push([m,I]),this.size=++D.size,this;D=this.__data__=new xr(k)}return D.set(m,I),this.size=D.size,this}tr.prototype.clear=pa,tr.prototype.delete=da,tr.prototype.get=ga,tr.prototype.has=ya,tr.prototype.set=bs;function _s(m,I){var D=Wi(m),k=!D&&Ts(m),Ae=!D&&!k&&On(m),ae=!D&&!k&&!Ae&&Bs(m),$e=D||k||Ae||ae,ke=$e?Ti(m.length,String):[],me=ke.length;for(var Fe in m)(I||st.call(m,Fe))&&!($e&&(Fe=="length"||Ae&&(Fe=="offset"||Fe=="parent")||ae&&(Fe=="buffer"||Fe=="byteLength"||Fe=="byteOffset")||Fs(Fe,me)))&&ke.push(Fe);return ke}function pi(m,I){for(var D=m.length;D--;)if($s(m[D][0],I))return D;return-1}function An(m,I,D){var k=I(m);return Wi(m)?k:wn(k,D(m))}function di(m){return m==null?m===void 0?de:H:Ir&&Ir in Object(m)?Ss(m):wa(m)}function Fn(m){return yi(m)&&di(m)==p}function gi(m,I,D,k,Ae){return m===I?!0:m==null||I==null||!yi(m)&&!yi(I)?m!==m&&I!==I:Es(m,I,D,k,gi,Ae)}function Es(m,I,D,k,Ae,ae){var $e=Wi(m),ke=Wi(I),me=$e?f:pr(m),Fe=ke?f:pr(I);me=me==p?Z:me,Fe=Fe==p?Z:Fe;var Le=me==Z,vt=Fe==Z,Ve=me==Fe;if(Ve&&On(m)){if(!On(I))return!1;$e=!0,Le=!1}if(Ve&&!Le)return ae||(ae=new tr),$e||Bs(m)?Ki(m,I,D,k,Ae,ae):ma(m,I,me,D,k,Ae,ae);if(!(D&o)){var Te=Le&&st.call(m,"__wrapped__"),lt=vt&&st.call(I,"__wrapped__");if(Te||lt){var rr=Te?m.value():m,kt=lt?I.value():I;return ae||(ae=new tr),Ae(rr,kt,D,k,ae)}}return Ve?(ae||(ae=new tr),xs(m,I,D,k,Ae,ae)):!1}function va(m){if(!Ds(m)||Rs(m))return!1;var I=Ji(m)?bn:be;return I.test(Sr(m))}function Is(m){return yi(m)&&Ns(m.length)&&!!Q[di(m)]}function Ps(m){if(!Cs(m))return ys(m);var I=[];for(var D in Object(m))st.call(m,D)&&D!="constructor"&&I.push(D);return I}function Ki(m,I,D,k,Ae,ae){var $e=D&o,ke=m.length,me=I.length;if(ke!=me&&!($e&&me>ke))return!1;var Fe=ae.get(m);if(Fe&&ae.get(I))return Fe==I;var Le=-1,vt=!0,Ve=D&c?new Vi:void 0;for(ae.set(m,I),ae.set(I,m);++Le<ke;){var Te=m[Le],lt=I[Le];if(k)var rr=$e?k(lt,Te,Le,I,m,ae):k(Te,lt,Le,m,I,ae);if(rr!==void 0){if(rr)continue;vt=!1;break}if(Ve){if(!$t(I,function(kt,dr){if(!hr(Ve,dr)&&(Te===kt||Ae(Te,kt,D,k,ae)))return Ve.push(dr)})){vt=!1;break}}else if(!(Te===lt||Ae(Te,lt,D,k,ae))){vt=!1;break}}return ae.delete(m),ae.delete(I),vt}function ma(m,I,D,k,Ae,ae,$e){switch(D){case Re:if(m.byteLength!=I.byteLength||m.byteOffset!=I.byteOffset)return!1;m=m.buffer,I=I.buffer;case yt:return!(m.byteLength!=I.byteLength||!ae(new Li(m),new Li(I)));case v:case b:case G:return $s(+m,+I);case S:return m.name==I.name&&m.message==I.message;case Y:case ie:return m==I+"";case N:var ke=lr;case he:var me=k&o;if(ke||(ke=Di),m.size!=I.size&&!me)return!1;var Fe=$e.get(m);if(Fe)return Fe==I;k|=c,$e.set(m,I);var Le=Ki(ke(m),ke(I),k,Ae,ae,$e);return $e.delete(m),Le;case ue:if(Sn)return Sn.call(m)==Sn.call(I)}return!1}function xs(m,I,D,k,Ae,ae){var $e=D&o,ke=Gi(m),me=ke.length,Fe=Gi(I),Le=Fe.length;if(me!=Le&&!$e)return!1;for(var vt=me;vt--;){var Ve=ke[vt];if(!($e?Ve in I:st.call(I,Ve)))return!1}var Te=ae.get(m);if(Te&&ae.get(I))return Te==I;var lt=!0;ae.set(m,I),ae.set(I,m);for(var rr=$e;++vt<me;){Ve=ke[vt];var kt=m[Ve],dr=I[Ve];if(k)var Rn=$e?k(dr,kt,Ve,I,m,ae):k(kt,dr,Ve,m,I,ae);if(!(Rn===void 0?kt===dr||Ae(kt,dr,D,k,ae):Rn)){lt=!1;break}rr||(rr=Ve=="constructor")}if(lt&&!rr){var vi=m.constructor,Qe=I.constructor;vi!=Qe&&"constructor"in m&&"constructor"in I&&!(typeof vi=="function"&&vi instanceof vi&&typeof Qe=="function"&&Qe instanceof Qe)&&(lt=!1)}return ae.delete(m),ae.delete(I),lt}function Gi(m){return An(m,Ea,As)}function Gr(m,I){var D=m.__data__;return Os(I)?D[typeof I=="string"?"string":"hash"]:D.map}function Tt(m,I){var D=tt(m,I);return va(D)?D:void 0}function Ss(m){var I=st.call(m,Ir),D=m[Ir];try{m[Ir]=void 0;var k=!0}catch{}var Ae=ji.call(m);return k&&(I?m[Ir]=D:delete m[Ir]),Ae}var As=ds?function(m){return m==null?[]:(m=Object(m),_r(ds(m),function(I){return Ui.call(m,I)}))}:Se,pr=di;(_n&&pr(new _n(new ArrayBuffer(1)))!=Re||li&&pr(new li)!=N||En&&pr(En.resolve())!=B||In&&pr(new In)!=he||Mi&&pr(new Mi)!=gt)&&(pr=function(m){var I=di(m),D=I==Z?m.constructor:void 0,k=D?Sr(D):"";if(k)switch(k){case Yo:return Re;case Zo:return N;case Pn:return B;case Xo:return he;case xn:return gt}return I});function Fs(m,I){return I=I??h,!!I&&(typeof m=="number"||se.test(m))&&m>-1&&m%1==0&&m<I}function Os(m){var I=typeof m;return I=="string"||I=="number"||I=="symbol"||I=="boolean"?m!=="__proto__":m===null}function Rs(m){return!!qi&&qi in m}function Cs(m){var I=m&&m.constructor,D=typeof I=="function"&&I.prototype||Ut;return m===D}function wa(m){return ji.call(m)}function Sr(m){if(m!=null){try{return Vr.call(m)}catch{}try{return m+""}catch{}}return""}function $s(m,I){return m===I||m!==m&&I!==I}var Ts=Fn(function(){return arguments}())?Fn:function(m){return yi(m)&&st.call(m,"callee")&&!Ui.call(m,"callee")},Wi=Array.isArray;function ba(m){return m!=null&&Ns(m.length)&&!Ji(m)}var On=gs||xe;function _a(m,I){return gi(m,I)}function Ji(m){if(!Ds(m))return!1;var I=di(m);return I==O||I==F||I==y||I==U}function Ns(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=h}function Ds(m){var I=typeof m;return m!=null&&(I=="object"||I=="function")}function yi(m){return m!=null&&typeof m=="object"}var Bs=et?Ni(et):Is;function Ea(m){return ba(m)?_s(m):Ps(m)}function Se(){return[]}function xe(){return!1}n.exports=_a})(zo,zo.exports);var _2=zo.exports;const E2=Uo(_2);function I2(n,t){return t=t||{},new Promise(function(r,s){var o=new XMLHttpRequest,c=[],h=[],p={},f=function(){return{ok:(o.status/100|0)==2,statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:f,headers:{keys:function(){return c},entries:function(){return h},get:function(v){return p[v.toLowerCase()]},has:function(v){return v.toLowerCase()in p}}}};for(var y in o.open(t.method||"get",n,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(v,b,S){c.push(b=b.toLowerCase()),h.push([b,S]),p[b]=p[b]?p[b]+","+S:S}),r(f())},o.onerror=s,o.withCredentials=t.credentials=="include",t.headers)o.setRequestHeader(y,t.headers[y]);o.send(t.body||null)})}const P2=Object.freeze(Object.defineProperty({__proto__:null,default:I2},Symbol.toStringTag,{value:"Module"})),bf=lp(P2);var x2=self.fetch||(self.fetch=bf.default||bf);const S2=Uo(x2);function A2(n,t){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var o=0;o<n.length;o++){var c=n.charAt(o),h=c.charCodeAt(0);if(r[h]!==255)throw new TypeError(c+" is ambiguous");r[h]=o}var p=n.length,f=n.charAt(0),y=Math.log(p)/Math.log(256),v=Math.log(256)/Math.log(p);function b(F){if(F instanceof Uint8Array||(ArrayBuffer.isView(F)?F=new Uint8Array(F.buffer,F.byteOffset,F.byteLength):Array.isArray(F)&&(F=Uint8Array.from(F))),!(F instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(F.length===0)return"";for(var N=0,G=0,H=0,Z=F.length;H!==Z&&F[H]===0;)H++,N++;for(var B=(Z-H)*v+1>>>0,U=new Uint8Array(B);H!==Z;){for(var Y=F[H],he=0,ie=B-1;(Y!==0||he<G)&&ie!==-1;ie--,he++)Y+=256*U[ie]>>>0,U[ie]=Y%p>>>0,Y=Y/p>>>0;if(Y!==0)throw new Error("Non-zero carry");G=he,H++}for(var ue=B-G;ue!==B&&U[ue]===0;)ue++;for(var de=f.repeat(N);ue<B;++ue)de+=n.charAt(U[ue]);return de}function S(F){if(typeof F!="string")throw new TypeError("Expected String");if(F.length===0)return new Uint8Array;var N=0;if(F[N]!==" "){for(var G=0,H=0;F[N]===f;)G++,N++;for(var Z=(F.length-N)*y+1>>>0,B=new Uint8Array(Z);F[N];){var U=r[F.charCodeAt(N)];if(U===255)return;for(var Y=0,he=Z-1;(U!==0||Y<H)&&he!==-1;he--,Y++)U+=p*B[he]>>>0,B[he]=U%256>>>0,U=U/256>>>0;if(U!==0)throw new Error("Non-zero carry");H=Y,N++}if(F[N]!==" "){for(var ie=Z-H;ie!==Z&&B[ie]===0;)ie++;for(var ue=new Uint8Array(G+(Z-ie)),de=G;ie!==Z;)ue[de++]=B[ie++];return ue}}}function O(F){var N=S(F);if(N)return N;throw new Error(`Non-${t} character`)}return{encode:b,decodeUnsafe:S,decode:O}}var F2=A2,O2=F2;const Xp=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},R2=n=>new TextEncoder().encode(n),C2=n=>new TextDecoder().decode(n);class $2{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class T2{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return ed(this,t)}}class N2{constructor(t){this.decoders=t}or(t){return ed(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ed=(n,t)=>new N2({...n.decoders||{[n.prefix]:n},...t.decoders||{[t.prefix]:t}});class D2{constructor(t,r,s,o){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=o,this.encoder=new $2(t,r,s),this.decoder=new T2(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Wo=({name:n,prefix:t,encode:r,decode:s})=>new D2(n,t,r,s),ps=({prefix:n,name:t,alphabet:r})=>{const{encode:s,decode:o}=O2(r,t);return Wo({prefix:n,name:t,encode:s,decode:c=>Xp(o(c))})},B2=(n,t,r,s)=>{const o={};for(let v=0;v<t.length;++v)o[t[v]]=v;let c=n.length;for(;n[c-1]==="=";)--c;const h=new Uint8Array(c*r/8|0);let p=0,f=0,y=0;for(let v=0;v<c;++v){const b=o[n[v]];if(b===void 0)throw new SyntaxError(`Non-${s} character`);f=f<<r|b,p+=r,p>=8&&(p-=8,h[y++]=255&f>>p)}if(p>=r||255&f<<8-p)throw new SyntaxError("Unexpected end of data");return h},q2=(n,t,r)=>{const s=t[t.length-1]==="=",o=(1<<r)-1;let c="",h=0,p=0;for(let f=0;f<n.length;++f)for(p=p<<8|n[f],h+=8;h>r;)h-=r,c+=t[o&p>>h];if(h&&(c+=t[o&p<<r-h]),s)for(;c.length*r&7;)c+="=";return c},nt=({name:n,prefix:t,bitsPerChar:r,alphabet:s})=>Wo({prefix:t,name:n,encode(o){return q2(o,s,r)},decode(o){return B2(o,s,r,n)}}),j2=Wo({prefix:"\0",name:"identity",encode:n=>C2(n),decode:n=>R2(n)});var z2=Object.freeze({__proto__:null,identity:j2});const L2=nt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var U2=Object.freeze({__proto__:null,base2:L2});const M2=nt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var H2=Object.freeze({__proto__:null,base8:M2});const k2=ps({prefix:"9",name:"base10",alphabet:"0123456789"});var V2=Object.freeze({__proto__:null,base10:k2});const K2=nt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),G2=nt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var W2=Object.freeze({__proto__:null,base16:K2,base16upper:G2});const J2=nt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Q2=nt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Y2=nt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Z2=nt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),X2=nt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),eP=nt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),tP=nt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),rP=nt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),iP=nt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var nP=Object.freeze({__proto__:null,base32:J2,base32upper:Q2,base32pad:Y2,base32padupper:Z2,base32hex:X2,base32hexupper:eP,base32hexpad:tP,base32hexpadupper:rP,base32z:iP});const sP=ps({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),oP=ps({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var aP=Object.freeze({__proto__:null,base36:sP,base36upper:oP});const cP=ps({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),uP=ps({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var hP=Object.freeze({__proto__:null,base58btc:cP,base58flickr:uP});const lP=nt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),fP=nt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),pP=nt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),dP=nt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var gP=Object.freeze({__proto__:null,base64:lP,base64pad:fP,base64url:pP,base64urlpad:dP});const td=Array.from(""),yP=td.reduce((n,t,r)=>(n[r]=t,n),[]),vP=td.reduce((n,t,r)=>(n[t.codePointAt(0)]=r,n),[]);function mP(n){return n.reduce((t,r)=>(t+=yP[r],t),"")}function wP(n){const t=[];for(const r of n){const s=vP[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const bP=Wo({prefix:"",name:"base256emoji",encode:mP,decode:wP});var _P=Object.freeze({__proto__:null,base256emoji:bP}),EP=rd,_f=128,IP=127,PP=~IP,xP=Math.pow(2,31);function rd(n,t,r){t=t||[],r=r||0;for(var s=r;n>=xP;)t[r++]=n&255|_f,n/=128;for(;n&PP;)t[r++]=n&255|_f,n>>>=7;return t[r]=n|0,rd.bytes=r-s+1,t}var SP=su,AP=128,Ef=127;function su(n,s){var r=0,s=s||0,o=0,c=s,h,p=n.length;do{if(c>=p)throw su.bytes=0,new RangeError("Could not decode varint");h=n[c++],r+=o<28?(h&Ef)<<o:(h&Ef)*Math.pow(2,o),o+=7}while(h>=AP);return su.bytes=c-s,r}var FP=Math.pow(2,7),OP=Math.pow(2,14),RP=Math.pow(2,21),CP=Math.pow(2,28),$P=Math.pow(2,35),TP=Math.pow(2,42),NP=Math.pow(2,49),DP=Math.pow(2,56),BP=Math.pow(2,63),qP=function(n){return n<FP?1:n<OP?2:n<RP?3:n<CP?4:n<$P?5:n<TP?6:n<NP?7:n<DP?8:n<BP?9:10},jP={encode:EP,decode:SP,encodingLength:qP},id=jP;const If=(n,t,r=0)=>(id.encode(n,t,r),t),Pf=n=>id.encodingLength(n),ou=(n,t)=>{const r=t.byteLength,s=Pf(n),o=s+Pf(r),c=new Uint8Array(o+r);return If(n,c,0),If(r,c,s),c.set(t,o),new zP(n,r,t,c)};class zP{constructor(t,r,s,o){this.code=t,this.size=r,this.digest=s,this.bytes=o}}const nd=({name:n,code:t,encode:r})=>new LP(n,t,r);class LP{constructor(t,r,s){this.name=t,this.code=r,this.encode=s}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?ou(this.code,r):r.then(s=>ou(this.code,s))}else throw Error("Unknown type, must be binary type")}}const sd=n=>async t=>new Uint8Array(await crypto.subtle.digest(n,t)),UP=nd({name:"sha2-256",code:18,encode:sd("SHA-256")}),MP=nd({name:"sha2-512",code:19,encode:sd("SHA-512")});var HP=Object.freeze({__proto__:null,sha256:UP,sha512:MP});const od=0,kP="identity",ad=Xp,VP=n=>ou(od,ad(n)),KP={code:od,name:kP,encode:ad,digest:VP};var GP=Object.freeze({__proto__:null,identity:KP});new TextEncoder,new TextDecoder;const xf={...z2,...U2,...H2,...V2,...W2,...nP,...aP,...hP,...gP,..._P};({...HP,...GP});function cd(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function WP(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?cd(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function ud(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const Sf=ud("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),Uc=ud("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=WP(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),JP={utf8:Sf,"utf-8":Sf,hex:xf.base16,latin1:Uc,ascii:Uc,binary:Uc,...xf};function QP(n,t="utf8"){const r=JP[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?cd(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}const hd="wc",YP=2,Su="core",ai=`${hd}@2:${Su}:`,ZP={name:Su,logger:"error"},XP={database:":memory:"},ex="crypto",Af="client_ed25519_seed",tx=X.ONE_DAY,rx="keychain",ix="0.3",nx="messages",sx="0.3",ox=X.SIX_HOURS,ax="publisher",ld="irn",cx="error",fd="wss://relay.walletconnect.com",Ff="wss://relay.walletconnect.org",ux="relayer",ut={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},hx="_subscription",Lr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},lx=X.ONE_SECOND,fx="2.11.0",px=1e4,dx="0.3",gx="WALLETCONNECT_CLIENT_ID",cr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},yx="subscription",vx="0.3",mx=X.FIVE_SECONDS*1e3,wx="pairing",bx="0.3",Jn={wc_pairingDelete:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:X.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:X.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:X.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:X.ONE_DAY,prompt:!1,tag:0},res:{ttl:X.ONE_DAY,prompt:!1,tag:0}}},ts={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},wr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},_x="history",Ex="0.3",Ix="expirer",Zt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},Px="0.3",Mc="verify-api",gn="https://verify.walletconnect.com",au="https://verify.walletconnect.org",xx=[gn,au],Sx="echo",Ax="https://echo.walletconnect.com";class Fx{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=rx,this.version=ix,this.initialized=!1,this.storagePrefix=ai,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:c}=V("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(c)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=t,this.logger=Ft(r,this.name)}get context(){return At(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,cp(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?up(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Ox{constructor(t,r,s){this.core=t,this.logger=r,this.name=ex,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),c=ff(o);return Vp(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=e0();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const c=await this.getClientSeed(),h=ff(c),p=Qc();return await XI(p,o,tx,h)},this.generateSharedKey=(o,c,h)=>{this.isInitialized();const p=this.getPrivateKey(o),f=t0(p,c);return this.setSymKey(f,h)},this.setSymKey=async(o,c)=>{this.isInitialized();const h=c||r0(o);return await this.keychain.set(h,o),h},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,c,h)=>{this.isInitialized();const p=i0(h),f=Oi(c);if(Rl(p)){const S=p.senderPublicKey,O=p.receiverPublicKey;o=await this.generateSharedKey(S,O)}const y=this.getSymKey(o),{type:v,senderPublicKey:b}=p;return n0({type:v,symKey:y,message:f,senderPublicKey:b})},this.decode=async(o,c,h)=>{this.isInitialized();const p=s0(c,h);if(Rl(p)){const f=p.receiverPublicKey,y=p.senderPublicKey;o=await this.generateSharedKey(f,y)}try{const f=this.getSymKey(o),y=o0({symKey:f,encoded:c});return us(y)}catch(f){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(f)}},this.getPayloadType=o=>{const c=Cl(o);return a0(c.type)},this.getPayloadSenderPublicKey=o=>{const c=Cl(o);return c.senderPublicKey?c0(c.senderPublicKey,u0):void 0},this.core=t,this.logger=Ft(r,this.name),this.keychain=s||new Fx(this.core,this.logger)}get context(){return At(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Af)}catch{t=Qc(),await this.keychain.set(Af,t)}return QP(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Rx extends Zb{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=nx,this.version=sx,this.initialized=!1,this.storagePrefix=ai,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const c=yn(o);let h=this.messages.get(s);return typeof h>"u"&&(h={}),typeof h[c]<"u"||(h[c]=o,this.messages.set(s,h),await this.persist()),c},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const c=this.get(s),h=yn(o);return typeof c[h]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Ft(t,this.name),this.core=r}get context(){return At(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,cp(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?up(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Cx extends Xb{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new zt.EventEmitter,this.name=ax,this.queue=new Map,this.publishTimeout=X.toMiliseconds(X.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,o,c)=>{var h;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}});try{const p=(c==null?void 0:c.ttl)||ox,f=Yc(c),y=(c==null?void 0:c.prompt)||!1,v=(c==null?void 0:c.tag)||0,b=(c==null?void 0:c.id)||Pu().toString(),S={topic:s,message:o,opts:{ttl:p,relay:f,prompt:y,tag:v,id:b}},O=setTimeout(()=>this.queue.set(b,S),this.publishTimeout);try{await await ns(this.rpcPublish(s,o,p,f,y,v,b),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(b),this.relayer.events.emit(ut.publish,S)}catch(F){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(h=c==null?void 0:c.internal)!=null&&h.throwOnFailedPublish)throw this.removeRequestFromQueue(b),F;return}finally{clearTimeout(O)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}})}catch(p){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(p),p}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=t,this.logger=Ft(r,this.name),this.registerEventListeners()}get context(){return At(this.logger)}rpcPublish(t,r,s,o,c,h,p){var f,y,v,b;const S={method:To(o.protocol).publish,params:{topic:t,message:r,ttl:s,prompt:c,tag:h},id:p};return oi((f=S.params)==null?void 0:f.prompt)&&((y=S.params)==null||delete y.prompt),oi((v=S.params)==null?void 0:v.tag)&&((b=S.params)==null||delete b.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:S}),this.relayer.request(S)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:s,opts:o}=t;await this.publish(r,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(mn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(ut.connection_stalled);return}this.checkQueue()}),this.relayer.on(ut.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class $x{constructor(){this.map=new Map,this.set=(t,r)=>{const s=this.get(t);this.exists(t,r)||this.map.set(t,[...s,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const s=this.get(t);if(!this.exists(t,r))return;const o=s.filter(c=>c!==r);if(!o.length){this.map.delete(t);return}this.map.set(t,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var Tx=Object.defineProperty,Nx=Object.defineProperties,Dx=Object.getOwnPropertyDescriptors,Of=Object.getOwnPropertySymbols,Bx=Object.prototype.hasOwnProperty,qx=Object.prototype.propertyIsEnumerable,Rf=(n,t,r)=>t in n?Tx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Qn=(n,t)=>{for(var r in t||(t={}))Bx.call(t,r)&&Rf(n,r,t[r]);if(Of)for(var r of Of(t))qx.call(t,r)&&Rf(n,r,t[r]);return n},Hc=(n,t)=>Nx(n,Dx(t));class jx extends r_{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new $x,this.events=new zt.EventEmitter,this.name=yx,this.version=vx,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=ai,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const c=Yc(o),h={topic:s,relay:c};this.pending.set(s,h);const p=await this.rpcSubscribe(s,c);return this.onSubscribe(p,h),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),p}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((o,c)=>{const h=new X.Watch;h.start(this.pendingSubscriptionWatchLabel);const p=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(p),h.stop(this.pendingSubscriptionWatchLabel),o(!0)),h.elapsed(this.pendingSubscriptionWatchLabel)>=mx&&(clearInterval(p),h.stop(this.pendingSubscriptionWatchLabel),c(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Ft(r,this.name),this.clientId=""}get context(){return At(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let s=!1;try{s=this.getSubscription(t).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const s=this.topicMap.get(t);await Promise.all(s.map(async o=>await this.unsubscribeById(t,o,r)))}async unsubscribeById(t,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}});try{const o=Yc(s);await this.rpcUnsubscribe(t,r,o);const c=ct("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(t,r){const s={method:To(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await ns(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(ut.connection_stalled)}return yn(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,s={method:To(r.protocol).batchSubscribe,params:{topics:t.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await ns(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(ut.connection_stalled)}}rpcUnsubscribe(t,r,s){const o={method:To(s.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(t,r){this.setSubscription(t,Hc(Qn({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,Qn({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,Qn({},r)),this.topicMap.set(r.topic,t),this.events.emit(cr.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:s}=V("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(cr.deleted,Hc(Qn({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(cr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(cr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);vn(r)&&this.onBatchSubscribe(r.map((s,o)=>Hc(Qn({},t[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(mn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(ut.connect,async()=>{await this.onConnect()}),this.relayer.on(ut.disconnect,()=>{this.onDisconnect()}),this.events.on(cr.created,async t=>{const r=cr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(cr.deleted,async t=>{const r=cr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var zx=Object.defineProperty,Cf=Object.getOwnPropertySymbols,Lx=Object.prototype.hasOwnProperty,Ux=Object.prototype.propertyIsEnumerable,$f=(n,t,r)=>t in n?zx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Mx=(n,t)=>{for(var r in t||(t={}))Lx.call(t,r)&&$f(n,r,t[r]);if(Cf)for(var r of Cf(t))Ux.call(t,r)&&$f(n,r,t[r]);return n};class Hx extends e_{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new zt.EventEmitter,this.name=ux,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(ut.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(ut.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(Lr.payload,this.onPayloadHandler),this.provider.on(Lr.connect,this.onConnectHandler),this.provider.on(Lr.disconnect,this.onDisconnectHandler),this.provider.on(Lr.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Ft(t.logger,this.name):Ho(ko({level:t.logger||cx})),this.messages=new Rx(this.logger,t.core),this.subscriber=new jx(this,this.logger),this.publisher=new Cx(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||fd,this.projectId=t.projectId,this.bundleId=h0(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Ff}...`),await this.restartTransport(Ff)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},px)}get context(){return At(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,s){this.isInitialized(),await this.publisher.publish(t,r,s),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"";if(o)return o;let c;const h=p=>{p.topic===t&&(this.subscriber.off(cr.created,h),c())};return await Promise.all([new Promise(p=>{c=p,this.subscriber.on(cr.created,h)}),new Promise(async p=>{o=await this.subscriber.subscribe(t,r),p()})]),o}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await ns(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(cr.resubscribed,()=>{r()})}),new Promise(async(r,s)=>{try{await ns(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){s(o);return}r()})])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.provider.events.emit(Lr.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await $l())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new y2(new b2(l0({sdkVersion:fx,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:s}=t;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(t){const{topic:r,message:s}=t;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const o=this.messages.has(r,s);return o&&this.logger.debug(`Ignoring duplicate message: ${s}`),o}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),xu(t)){if(!t.method.endsWith(hx))return;const r=t.params,{topic:s,message:o,publishedAt:c}=r.data,h={topic:s,message:o,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Mx({type:"event",event:r.id},h)),this.events.emit(r.id,h),await this.acknowledgePayload(t),await this.onMessageEvent(h)}else fs(t)&&this.events.emit(ut.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(ut.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=Ko(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(Lr.payload,this.onPayloadHandler),this.provider.off(Lr.connect,this.onConnectHandler),this.provider.off(Lr.disconnect,this.onDisconnectHandler),this.provider.off(Lr.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(ut.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let t=await $l();f0(async r=>{this.initialized&&t!==r&&(t=r,r?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(ut.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},X.toMiliseconds(lx)))}isInitialized(){if(!this.initialized){const{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var kx=Object.defineProperty,Tf=Object.getOwnPropertySymbols,Vx=Object.prototype.hasOwnProperty,Kx=Object.prototype.propertyIsEnumerable,Nf=(n,t,r)=>t in n?kx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Df=(n,t)=>{for(var r in t||(t={}))Vx.call(t,r)&&Nf(n,r,t[r]);if(Tf)for(var r of Tf(t))Kx.call(t,r)&&Nf(n,r,t[r]);return n};class Jo extends t_{constructor(t,r,s,o=ai,c=void 0){super(t,r,s,o),this.core=t,this.logger=r,this.name=s,this.map=new Map,this.version=dx,this.cached=[],this.initialized=!1,this.storagePrefix=ai,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(h=>{this.getKey&&h!==null&&!oi(h)?this.map.set(this.getKey(h),h):Zw(h)?this.map.set(h.id,h):Xw(h)&&this.map.set(h.topic,h)}),this.cached=[],this.initialized=!0)},this.set=async(h,p)=>{this.isInitialized(),this.map.has(h)?await this.update(h,p):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:h,value:p}),this.map.set(h,p),await this.persist())},this.get=h=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:h}),this.getData(h)),this.getAll=h=>(this.isInitialized(),h?this.values.filter(p=>Object.keys(h).every(f=>E2(p[f],h[f]))):this.values),this.update=async(h,p)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:h,update:p});const f=Df(Df({},this.getData(h)),p);this.map.set(h,f),await this.persist()},this.delete=async(h,p)=>{this.isInitialized(),this.map.has(h)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:h,reason:p}),this.map.delete(h),await this.persist())},this.logger=Ft(r,this.name),this.storagePrefix=o,this.getKey=c}get context(){return At(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:s}=V("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Gx{constructor(t,r){this.core=t,this.logger=r,this.name=wx,this.version=bx,this.events=new fu,this.initialized=!1,this.storagePrefix=ai,this.ignoredPayloadTypes=[sp],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Qc(),o=await this.core.crypto.setSymKey(s),c=ur(X.FIVE_MINUTES),h={protocol:ld},p={topic:o,expiry:c,relay:h,active:!1},f=p0({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:h});return await this.pairings.set(o,p),await this.core.relayer.subscribe(o),this.core.expirer.set(o,c),{topic:o,uri:f}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:c,relay:h}=Tl(s.uri);let p;if(this.pairings.keys.includes(o)&&(p=this.pairings.get(o),p.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);const f=ur(X.FIVE_MINUTES),y={topic:o,relay:h,expiry:f,active:!1};return await this.pairings.set(o,y),this.core.expirer.set(o,f),s.activatePairing&&await this.activate({topic:o}),this.events.emit(ts.create,y),this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(c,o),await this.core.relayer.subscribe(o,{relay:h})),y},this.activate=async({topic:s})=>{this.isInitialized();const o=ur(X.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const c=await this.sendRequest(o,"wc_pairingPing",{}),{done:h,resolve:p,reject:f}=pn();this.events.once(Ke("pairing_ping",c),({error:y})=>{y?f(y):p()}),await h()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",ct("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,c)=>{const h=Fi(o,c),p=await this.core.crypto.encode(s,h),f=Jn[o].req;return this.core.history.set(s,h),this.core.relayer.publish(s,p,f),h.id},this.sendResult=async(s,o,c)=>{const h=Ko(s,c),p=await this.core.crypto.encode(o,h),f=await this.core.history.get(o,s),y=Jn[f.request.method].res;await this.core.relayer.publish(o,p,y),await this.core.history.resolve(h)},this.sendError=async(s,o,c)=>{const h=Go(s,c),p=await this.core.crypto.encode(o,h),f=await this.core.history.get(o,s),y=Jn[f.request.method]?Jn[f.request.method].res:Jn.unregistered_method.res;await this.core.relayer.publish(o,p,y),await this.core.history.resolve(h)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,ct("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>si(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:c}=s;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(o,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,c);default:return this.onUnknownRpcMethodRequest(o,c)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:c}=s,h=(await this.core.history.get(o,c.id)).request.method;switch(h){case"wc_pairingPing":return this.onPairingPingResponse(o,c);default:return this.onUnknownRpcMethodResponse(h)}},this.onPairingPingRequest=async(s,o)=>{const{id:c}=o;try{this.isValidPing({topic:s}),await this.sendResult(c,s,!0),this.events.emit(ts.ping,{id:c,topic:s})}catch(h){await this.sendError(c,s,h),this.logger.error(h)}},this.onPairingPingResponse=(s,o)=>{const{id:c}=o;setTimeout(()=>{Mr(o)?this.events.emit(Ke("pairing_ping",c),{}):Xt(o)&&this.events.emit(Ke("pairing_ping",c),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:c}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(ts.delete,{id:c,topic:s})}catch(h){await this.sendError(c,s,h),this.logger.error(h)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:c,method:h}=o;try{if(this.registeredMethods.includes(h))return;const p=ct("WC_METHOD_UNSUPPORTED",h);await this.sendError(c,s,p),this.logger.error(p)}catch(p){await this.sendError(c,s,p),this.logger.error(p)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(ct("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var o;if(!xt(s)){const{message:h}=V("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(h)}if(!d0(s.uri)){const{message:h}=V("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(h)}const c=Tl(s.uri);if(!((o=c==null?void 0:c.relay)!=null&&o.protocol)){const{message:h}=V("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(h)}if(!(c!=null&&c.symKey)){const{message:h}=V("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(h)}},this.isValidPing=async s=>{if(!xt(s)){const{message:c}=V("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!xt(s)){const{message:c}=V("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!dn(s,!1)){const{message:o}=V("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=V("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(si(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=V("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=t,this.logger=Ft(r,this.name),this.pairings=new Jo(this.core,this.logger,this.name,this.storagePrefix)}get context(){return At(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(ut.message,async t=>{const{topic:r,message:s}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(r,s);try{xu(o)?(this.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):fs(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.core.history.delete(r,o.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(Zt.expired,async t=>{const{topic:r}=op(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(ts.expire,{topic:r}))})}}class Wx extends Yb{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new zt.EventEmitter,this.name=_x,this.version=Ex,this.cached=[],this.initialized=!1,this.storagePrefix=ai,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:c}),this.records.has(o.id))return;const h={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:c,expiry:ur(X.THIRTY_DAYS)};this.records.set(h.id,h),this.events.emit(wr.created,h)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=Xt(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(wr.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(c=>{if(c.topic===s){if(typeof o<"u"&&c.id!==o)return;this.records.delete(c.id),this.events.emit(wr.deleted,c)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Ft(r,this.name)}get context(){return At(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:Fi(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:s}=V("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(wr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(wr.created,t=>{const r=wr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(wr.updated,t=>{const r=wr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(wr.deleted,t=>{const r=wr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(mn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{X.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Jx extends i_{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new zt.EventEmitter,this.name=Ix,this.version=Px,this.cached=[],this.initialized=!1,this.storagePrefix=ai,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const c=this.formatTarget(s),h={target:c,expiry:o};this.expirations.set(c,h),this.checkExpiry(c,h),this.events.emit(Zt.created,{target:c,expiration:h})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),c=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Zt.deleted,{target:o,expiration:c})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Ft(r,this.name)}get context(){return At(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return g0(t);if(typeof t=="number")return y0(t);const{message:r}=V("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Zt.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:s}=V("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(t,r){const{expiry:s}=r;X.toMiliseconds(s)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Zt.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(mn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Zt.created,t=>{const r=Zt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Zt.expired,t=>{const r=Zt.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Zt.deleted,t=>{const r=Zt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Qx extends n_{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=Mc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||v0()||!ap())return;const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c)}if(!this.initialized){this.removeIframe(),this.verifyUrl=au;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);let c;try{c=await this.fetchAttestation(s.attestationId,o)}catch(h){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${o}`),this.logger.info(h),c=await this.fetchAttestation(s.attestationId,au)}return c},this.fetchAttestation=async(s,o)=>{this.logger.info(`resolving attestation: ${s} from url: ${o}`);const c=this.startAbortTimer(X.ONE_SECOND*2),h=await fetch(`${o}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(c),h.status===200?await h.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const o=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),s())};await Promise.race([new Promise(c=>{if(document.getElementById(Mc))return c();window.addEventListener("message",o);const h=document.createElement("iframe");h.id=Mc,h.src=`${this.verifyUrl}/${this.projectId}`,h.style.display="none",document.body.append(h),this.iframe=h,s=c}),new Promise((c,h)=>setTimeout(()=>{window.removeEventListener("message",o),h("verify iframe load timeout")},X.toMiliseconds(X.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let o=s||gn;return xx.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${gn}`),o=gn),o},this.logger=Ft(r,this.name),this.verifyUrl=gn,this.abortController=new AbortController,this.isDevEnv=m0()&&{}.IS_VITEST}get context(){return At(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),X.toMiliseconds(t))}}class Yx extends s_{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.context=Sx,this.registerDeviceToken=async s=>{const{clientId:o,token:c,notificationType:h,enableEncrypted:p=!1}=s,f=`${Ax}/${this.projectId}/clients`;await S2(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:o,type:h,token:c,always_raw:p})})},this.logger=Ft(r,this.context)}}var Zx=Object.defineProperty,Bf=Object.getOwnPropertySymbols,Xx=Object.prototype.hasOwnProperty,eS=Object.prototype.propertyIsEnumerable,qf=(n,t,r)=>t in n?Zx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,jf=(n,t)=>{for(var r in t||(t={}))Xx.call(t,r)&&qf(n,r,t[r]);if(Bf)for(var r of Bf(t))eS.call(t,r)&&qf(n,r,t[r]);return n};class Au extends Qb{constructor(t){super(t),this.protocol=hd,this.version=YP,this.name=Su,this.events=new zt.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||fd,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ho(ko({level:(t==null?void 0:t.logger)||ZP.logger}));this.logger=Ft(r,this.name),this.heartbeat=new mn.HeartBeat,this.crypto=new Ox(this,this.logger,t==null?void 0:t.keychain),this.history=new Wx(this,this.logger),this.expirer=new Jx(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new wb(jf(jf({},XP),t==null?void 0:t.storageOptions)),this.relayer=new Hx({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Gx(this,this.logger),this.verify=new Qx(this.projectId||"",this.logger),this.echoClient=new Yx(this.projectId||"",this.logger)}static async init(t){const r=new Au(t);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(gx,s),r}get context(){return At(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const tS=Au,pd="wc",dd=2,gd="client",Fu=`${pd}@${dd}:${gd}:`,kc={name:gd,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},zf="WALLETCONNECT_DEEPLINK_CHOICE",rS="proposal",yd="Proposal expired",iS="session",Ro=X.SEVEN_DAYS,nS="engine",Yn={wc_sessionPropose:{req:{ttl:X.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1104},res:{ttl:X.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1106},res:{ttl:X.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:X.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:X.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1112},res:{ttl:X.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:X.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:X.THIRTY_SECONDS,prompt:!1,tag:1115}}},Vc={min:X.FIVE_MINUTES,max:X.SEVEN_DAYS},Ur={idle:"IDLE",active:"ACTIVE"},sS="request",oS=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var aS=Object.defineProperty,cS=Object.defineProperties,uS=Object.getOwnPropertyDescriptors,Lf=Object.getOwnPropertySymbols,hS=Object.prototype.hasOwnProperty,lS=Object.prototype.propertyIsEnumerable,Uf=(n,t,r)=>t in n?aS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,It=(n,t)=>{for(var r in t||(t={}))hS.call(t,r)&&Uf(n,r,t[r]);if(Lf)for(var r of Lf(t))lS.call(t,r)&&Uf(n,r,t[r]);return n},Zn=(n,t)=>cS(n,uS(t));class fS extends a_{constructor(t){super(t),this.name=nS,this.events=new fu,this.initialized=!1,this.ignoredPayloadTypes=[sp],this.requestQueue={state:Ur.idle,queue:[]},this.sessionRequestQueue={state:Ur.idle,queue:[]},this.requestQueueDelay=X.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Yn)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},X.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const s=Zn(It({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:h,sessionProperties:p,relays:f}=s;let y=o,v,b=!1;if(y&&(b=this.client.core.pairing.pairings.get(y).active),!y||!b){const{topic:B,uri:U}=await this.client.core.pairing.create();y=B,v=U}const S=await this.client.core.crypto.generateKeyPair(),O=It({requiredNamespaces:c,optionalNamespaces:h,relays:f??[{protocol:ld}],proposer:{publicKey:S,metadata:this.client.metadata}},p&&{sessionProperties:p}),{reject:F,resolve:N,done:G}=pn(X.FIVE_MINUTES,yd);if(this.events.once(Ke("session_connect"),async({error:B,session:U})=>{if(B)F(B);else if(U){U.self.publicKey=S;const Y=Zn(It({},U),{requiredNamespaces:U.requiredNamespaces,optionalNamespaces:U.optionalNamespaces});await this.client.session.set(U.topic,Y),await this.setExpiry(U.topic,U.expiry),y&&await this.client.core.pairing.updateMetadata({topic:y,metadata:U.peer.metadata}),N(Y)}}),!y){const{message:B}=V("NO_MATCHING_KEY",`connect() pairing topic: ${y}`);throw new Error(B)}const H=await this.sendRequest({topic:y,method:"wc_sessionPropose",params:O}),Z=ur(X.FIVE_MINUTES);return await this.setProposal(H,It({id:H,expiry:Z},O)),{uri:v,approval:G}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:o,namespaces:c,sessionProperties:h}=r,p=this.client.proposal.get(s);let{pairingTopic:f,proposer:y,requiredNamespaces:v,optionalNamespaces:b}=p;f=f||"",No(v)||(v=b0(c,"approve()"));const S=await this.client.core.crypto.generateKeyPair(),O=y.publicKey,F=await this.client.core.crypto.generateSharedKey(S,O);f&&s&&(await this.client.core.pairing.updateMetadata({topic:f,metadata:y.metadata}),await this.sendResult({id:s,topic:f,result:{relay:{protocol:o??"irn"},responderPublicKey:S}}),await this.client.proposal.delete(s,ct("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:f}));const N=It({relay:{protocol:o??"irn"},namespaces:c,requiredNamespaces:v,optionalNamespaces:b,pairingTopic:f,controller:{publicKey:S,metadata:this.client.metadata},expiry:ur(Ro)},h&&{sessionProperties:h});await this.client.core.relayer.subscribe(F),await this.sendRequest({topic:F,method:"wc_sessionSettle",params:N,throwOnFailedPublish:!0});const G=Zn(It({},N),{topic:F,pairingTopic:f,acknowledged:!1,self:N.controller,peer:{publicKey:y.publicKey,metadata:y.metadata},controller:S});return await this.client.session.set(F,G),await this.setExpiry(F,ur(Ro)),{topic:F,acknowledged:()=>new Promise(H=>setTimeout(()=>H(this.client.session.get(F)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:s,reason:o}=r,{pairingTopic:c}=this.client.proposal.get(s);c&&(await this.sendError(s,c,o),await this.client.proposal.delete(s,ct("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:o}=r,c=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:h,resolve:p,reject:f}=pn();return this.events.once(Ke("session_update",c),({error:y})=>{y?f(y):p()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:h}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,o=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:c,resolve:h,reject:p}=pn();return this.events.once(Ke("session_extend",o),({error:f})=>{f?p(f):h()}),await this.setExpiry(s,ur(Ro)),{acknowledged:c}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:o,topic:c,expiry:h}=r,p=Iu(),{done:f,resolve:y,reject:v}=pn(h,"Request expired. Please try again.");return this.events.once(Ke("session_request",p),({error:b,result:S})=>{b?v(b):y(S)}),await Promise.all([new Promise(async b=>{await this.sendRequest({clientRpcId:p,topic:c,method:"wc_sessionRequest",params:{request:o,chainId:s},expiry:h,throwOnFailedPublish:!0}).catch(S=>v(S)),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:s,id:p}),b()}),new Promise(async b=>{const S=await _0(this.client.core.storage,zf);E0({id:p,topic:c,wcDeepLink:S}),b()}),f()]).then(b=>b[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:o}=r,{id:c}=o;Mr(o)?await this.sendResult({id:c,topic:s,result:o.result,throwOnFailedPublish:!0}):Xt(o)&&await this.sendError(c,s,o.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const o=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:c,resolve:h,reject:p}=pn();this.events.once(Ke("session_ping",o),({error:f})=>{f?p(f):h()}),await c()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:o,chainId:c}=r;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:o,chainId:c}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.client.session.keys.includes(s)?(await this.sendRequest({topic:s,method:"wc_sessionDelete",params:ct("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>I0(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(c=>{var h,p;return((h=c.peerMetadata)==null?void 0:h.url)&&((p=c.peerMetadata)==null?void 0:p.url)===r.peer.metadata.url&&c.topic&&c.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(r,s)=>{const{self:o}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,ct("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),s||this.client.core.expirer.del(r),this.client.core.storage.removeItem(zf).catch(c=>this.client.logger.warn(c)),this.getPendingSessionRequests().forEach(c=>{c.topic===r&&this.deletePendingSessionRequest(c.id,ct("USER_DISCONNECTED"))})},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,ct("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),o?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==r),o&&(this.sessionRequestQueue.state=Ur.idle)},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=Yn.wc_sessionRequest.req.ttl,{id:o,topic:c,params:h,verifyContext:p}=r;await this.client.pendingRequest.set(o,{id:o,topic:c,params:h,verifyContext:p}),s&&this.client.core.expirer.set(o,ur(s))},this.sendRequest=async r=>{const{topic:s,method:o,params:c,expiry:h,relayRpcId:p,clientRpcId:f,throwOnFailedPublish:y}=r,v=Fi(o,c,f);if(ap()&&oS.includes(o)){const O=yn(JSON.stringify(v));this.client.core.verify.register({attestationId:O})}const b=await this.client.core.crypto.encode(s,v),S=Yn[o].req;return h&&(S.ttl=h),p&&(S.id=p),this.client.core.history.set(s,v),y?(S.internal=Zn(It({},S.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,b,S)):this.client.core.relayer.publish(s,b,S).catch(O=>this.client.logger.error(O)),v.id},this.sendResult=async r=>{const{id:s,topic:o,result:c,throwOnFailedPublish:h}=r,p=Ko(s,c),f=await this.client.core.crypto.encode(o,p),y=await this.client.core.history.get(o,s),v=Yn[y.request.method].res;h?(v.internal=Zn(It({},v.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,f,v)):this.client.core.relayer.publish(o,f,v).catch(b=>this.client.logger.error(b)),await this.client.core.history.resolve(p)},this.sendError=async(r,s,o)=>{const c=Go(r,o),h=await this.client.core.crypto.encode(s,c),p=await this.client.core.history.get(s,r),f=Yn[p.request.method].res;this.client.core.relayer.publish(s,h,f),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(o=>{si(o.expiry)&&r.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{si(o.expiry)&&s.push(o.id)}),await Promise.all([...r.map(o=>this.deleteSession(o)),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===Ur.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Ur.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=Ur.idle},this.processRequest=r=>{const{topic:s,payload:o}=r,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:o}=r,c=(await this.client.core.history.get(s,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:o}=V("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(r,s)=>{const{params:o,id:c}=s;try{this.isValidConnect(It({},s.params));const h=ur(X.FIVE_MINUTES),p=It({id:c,pairingTopic:r,expiry:h},o);await this.setProposal(c,p);const f=yn(JSON.stringify(s)),y=await this.getVerifyContext(f,p.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:p,verifyContext:y})}catch(h){await this.sendError(c,r,h),this.client.logger.error(h)}},this.onSessionProposeResponse=async(r,s)=>{const{id:o}=s;if(Mr(s)){const{result:c}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const h=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:h});const p=h.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:p});const f=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:f});const y=await this.client.core.crypto.generateSharedKey(p,f);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:y});const v=await this.client.core.relayer.subscribe(y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:v}),await this.client.core.pairing.activate({topic:r})}else Xt(s)&&(await this.client.proposal.delete(o,ct("USER_DISCONNECTED")),this.events.emit(Ke("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:o,params:c}=s;try{this.isValidSessionSettleRequest(c);const{relay:h,controller:p,expiry:f,namespaces:y,requiredNamespaces:v,optionalNamespaces:b,sessionProperties:S,pairingTopic:O}=s.params,F=It({topic:r,relay:h,expiry:f,namespaces:y,acknowledged:!0,pairingTopic:O,requiredNamespaces:v,optionalNamespaces:b,controller:p.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:p.publicKey,metadata:p.metadata}},S&&{sessionProperties:S});await this.sendResult({id:s.id,topic:r,result:!0}),this.events.emit(Ke("session_connect"),{session:F}),this.cleanupDuplicatePairings(F)}catch(h){await this.sendError(o,r,h),this.client.logger.error(h)}},this.onSessionSettleResponse=async(r,s)=>{const{id:o}=s;Mr(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Ke("session_approve",o),{})):Xt(s)&&(await this.client.session.delete(r,ct("USER_DISCONNECTED")),this.events.emit(Ke("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:o,id:c}=s;try{const h=`${r}_session_update`,p=Io.get(h);if(p&&this.isRequestOutOfSync(p,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(It({topic:r},o)),await this.client.session.update(r,{namespaces:o.namespaces}),await this.sendResult({id:c,topic:r,result:!0}),this.client.events.emit("session_update",{id:c,topic:r,params:o}),Io.set(h,c)}catch(h){await this.sendError(c,r,h),this.client.logger.error(h)}},this.isRequestOutOfSync=(r,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,s)=>{const{id:o}=s;Mr(s)?this.events.emit(Ke("session_update",o),{}):Xt(s)&&this.events.emit(Ke("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:o}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,ur(Ro)),await this.sendResult({id:o,topic:r,result:!0}),this.client.events.emit("session_extend",{id:o,topic:r})}catch(c){await this.sendError(o,r,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(r,s)=>{const{id:o}=s;Mr(s)?this.events.emit(Ke("session_extend",o),{}):Xt(s)&&this.events.emit(Ke("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:o}=s;try{this.isValidPing({topic:r}),await this.sendResult({id:o,topic:r,result:!0}),this.client.events.emit("session_ping",{id:o,topic:r})}catch(c){await this.sendError(o,r,c),this.client.logger.error(c)}},this.onSessionPingResponse=(r,s)=>{const{id:o}=s;setTimeout(()=>{Mr(s)?this.events.emit(Ke("session_ping",o),{}):Xt(s)&&this.events.emit(Ke("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(ut.publish,async()=>{c(await this.deleteSession(r))})}),this.sendResult({id:o,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:o,topic:r})}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(r,s)=>{const{id:o,params:c}=s;try{this.isValidRequest(It({topic:r},c));const h=yn(JSON.stringify(Fi("wc_sessionRequest",c,o))),p=this.client.session.get(r),f=await this.getVerifyContext(h,p.peer.metadata),y={id:o,topic:r,params:c,verifyContext:f};await this.setPendingSessionRequest(y),this.addSessionRequestToSessionRequestQueue(y),this.processSessionRequestQueue()}catch(h){await this.sendError(o,r,h),this.client.logger.error(h)}},this.onSessionRequestResponse=(r,s)=>{const{id:o}=s;Mr(s)?this.events.emit(Ke("session_request",o),{result:s.result}):Xt(s)&&this.events.emit(Ke("session_request",o),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:o,params:c}=s;try{const h=`${r}_session_event_${c.event.name}`,p=Io.get(h);if(p&&this.isRequestOutOfSync(p,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(It({topic:r},c)),this.client.events.emit("session_event",{id:o,topic:r,params:c}),Io.set(h,o)}catch(h){await this.sendError(o,r,h),this.client.logger.error(h)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Ur.idle,this.processSessionRequestQueue()},X.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===Ur.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=Ur.active,this.client.events.emit("session_request",r)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=r=>{if(r.active)return;const s=this.client.proposal.getAll().find(o=>o.pairingTopic===r.topic);s&&this.onSessionProposeRequest(r.topic,Fi("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=async r=>{if(!xt(r)){const{message:f}=V("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(f)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:h,relays:p}=r;if(oi(s)||await this.isValidPairingTopic(s),!P0(p,!0)){const{message:f}=V("MISSING_OR_INVALID",`connect() relays: ${p}`);throw new Error(f)}!oi(o)&&No(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!oi(c)&&No(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),oi(h)||this.validateSessionProps(h,"sessionProperties")},this.validateNamespaces=(r,s)=>{const o=x0(r,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async r=>{if(!xt(r))throw new Error(V("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:o,relayProtocol:c,sessionProperties:h}=r;await this.isValidProposalId(s);const p=this.client.proposal.get(s),f=Sc(o,"approve()");if(f)throw new Error(f.message);const y=Nl(p.requiredNamespaces,o,"approve()");if(y)throw new Error(y.message);if(!dn(c,!0)){const{message:v}=V("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(v)}oi(h)||this.validateSessionProps(h,"sessionProperties")},this.isValidReject=async r=>{if(!xt(r)){const{message:c}=V("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(c)}const{id:s,reason:o}=r;if(await this.isValidProposalId(s),!S0(o)){const{message:c}=V("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidSessionSettleRequest=r=>{if(!xt(r)){const{message:y}=V("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(y)}const{relay:s,controller:o,namespaces:c,expiry:h}=r;if(!A0(s)){const{message:y}=V("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(y)}const p=F0(o,"onSessionSettleRequest()");if(p)throw new Error(p.message);const f=Sc(c,"onSessionSettleRequest()");if(f)throw new Error(f.message);if(si(h)){const{message:y}=V("EXPIRED","onSessionSettleRequest()");throw new Error(y)}},this.isValidUpdate=async r=>{if(!xt(r)){const{message:f}=V("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(f)}const{topic:s,namespaces:o}=r;await this.isValidSessionTopic(s);const c=this.client.session.get(s),h=Sc(o,"update()");if(h)throw new Error(h.message);const p=Nl(c.requiredNamespaces,o,"update()");if(p)throw new Error(p.message)},this.isValidExtend=async r=>{if(!xt(r)){const{message:o}=V("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!xt(r)){const{message:f}=V("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(f)}const{topic:s,request:o,chainId:c,expiry:h}=r;await this.isValidSessionTopic(s);const{namespaces:p}=this.client.session.get(s);if(!Dl(p,c)){const{message:f}=V("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(f)}if(!O0(o)){const{message:f}=V("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(f)}if(!R0(p,c,o.method)){const{message:f}=V("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(f)}if(h&&!C0(h,Vc)){const{message:f}=V("MISSING_OR_INVALID",`request() expiry: ${h}. Expiry must be a number (in seconds) between ${Vc.min} and ${Vc.max}`);throw new Error(f)}},this.isValidRespond=async r=>{var s;if(!xt(r)){const{message:h}=V("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(h)}const{topic:o,response:c}=r;try{await this.isValidSessionTopic(o)}catch(h){throw(s=r==null?void 0:r.response)!=null&&s.id&&this.cleanupAfterResponse(r),h}if(!$0(c)){const{message:h}=V("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(c)}`);throw new Error(h)}},this.isValidPing=async r=>{if(!xt(r)){const{message:o}=V("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!xt(r)){const{message:p}=V("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(p)}const{topic:s,event:o,chainId:c}=r;await this.isValidSessionTopic(s);const{namespaces:h}=this.client.session.get(s);if(!Dl(h,c)){const{message:p}=V("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(p)}if(!T0(o)){const{message:p}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(p)}if(!N0(h,c,o.name)){const{message:p}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(p)}},this.isValidDisconnect=async r=>{if(!xt(r)){const{message:o}=V("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const o={verified:{verifyUrl:s.verifyUrl||gn,validation:"UNKNOWN",origin:s.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});c&&(o.verified.origin=c.origin,o.verified.isScam=c.isScam,o.verified.validation=c.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.info(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(o=>{if(!dn(o,!1)){const{message:c}=V("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(c)}})}}async isInitialized(){if(!this.initialized){const{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(ut.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(r,s);try{xu(o)?(this.client.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):fs(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.client.core.history.delete(r,o.id)):this.onRelayEventUnknownPayload({topic:r,payload:o})}catch(c){this.client.logger.error(c)}})}registerExpirerEvents(){this.client.core.expirer.on(Zt.expired,async t=>{const{topic:r,id:s}=op(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,V("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(ts.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!dn(t,!1)){const{message:r}=V("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=V("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(si(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=V("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!dn(t,!1)){const{message:r}=V("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=V("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(si(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=V("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(dn(t,!1)){const{message:r}=V("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=V("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!D0(t)){const{message:r}=V("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=V("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(si(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=V("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class pS extends Jo{constructor(t,r){super(t,r,rS,Fu),this.core=t,this.logger=r}}class dS extends Jo{constructor(t,r){super(t,r,iS,Fu),this.core=t,this.logger=r}}class gS extends Jo{constructor(t,r){super(t,r,sS,Fu,s=>s.id),this.core=t,this.logger=r}}let yS=class vd extends o_{constructor(t){super(t),this.protocol=pd,this.version=dd,this.name=kc.name,this.events=new zt.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(t==null?void 0:t.name)||kc.name,this.metadata=(t==null?void 0:t.metadata)||w0();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ho(ko({level:(t==null?void 0:t.logger)||kc.logger}));this.core=(t==null?void 0:t.core)||new tS(t),this.logger=Ft(r,this.name),this.session=new dS(this.core,this.logger),this.proposal=new pS(this.core,this.logger),this.pendingRequest=new gS(this.core,this.logger),this.engine=new fS(this)}static async init(t){const r=new vd(t);return await r.initialize(),r}get context(){return At(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var cu={exports:{}};(function(n,t){var r=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof St<"u"&&St,s=function(){function c(){this.fetch=!1,this.DOMException=r.DOMException}return c.prototype=r,new c}();(function(c){(function(h){var p=typeof c<"u"&&c||typeof self<"u"&&self||typeof St<"u"&&St||{},f={searchParams:"URLSearchParams"in p,iterable:"Symbol"in p&&"iterator"in Symbol,blob:"FileReader"in p&&"Blob"in p&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in p,arrayBuffer:"ArrayBuffer"in p};function y(E){return E&&DataView.prototype.isPrototypeOf(E)}if(f.arrayBuffer)var v=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],b=ArrayBuffer.isView||function(E){return E&&v.indexOf(Object.prototype.toString.call(E))>-1};function S(E){if(typeof E!="string"&&(E=String(E)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(E)||E==="")throw new TypeError('Invalid character in header field name: "'+E+'"');return E.toLowerCase()}function O(E){return typeof E!="string"&&(E=String(E)),E}function F(E){var A={next:function(){var j=E.shift();return{done:j===void 0,value:j}}};return f.iterable&&(A[Symbol.iterator]=function(){return A}),A}function N(E){this.map={},E instanceof N?E.forEach(function(A,j){this.append(j,A)},this):Array.isArray(E)?E.forEach(function(A){if(A.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+A.length);this.append(A[0],A[1])},this):E&&Object.getOwnPropertyNames(E).forEach(function(A){this.append(A,E[A])},this)}N.prototype.append=function(E,A){E=S(E),A=O(A);var j=this.map[E];this.map[E]=j?j+", "+A:A},N.prototype.delete=function(E){delete this.map[S(E)]},N.prototype.get=function(E){return E=S(E),this.has(E)?this.map[E]:null},N.prototype.has=function(E){return this.map.hasOwnProperty(S(E))},N.prototype.set=function(E,A){this.map[S(E)]=O(A)},N.prototype.forEach=function(E,A){for(var j in this.map)this.map.hasOwnProperty(j)&&E.call(A,this.map[j],j,this)},N.prototype.keys=function(){var E=[];return this.forEach(function(A,j){E.push(j)}),F(E)},N.prototype.values=function(){var E=[];return this.forEach(function(A){E.push(A)}),F(E)},N.prototype.entries=function(){var E=[];return this.forEach(function(A,j){E.push([j,A])}),F(E)},f.iterable&&(N.prototype[Symbol.iterator]=N.prototype.entries);function G(E){if(!E._noBody){if(E.bodyUsed)return Promise.reject(new TypeError("Already read"));E.bodyUsed=!0}}function H(E){return new Promise(function(A,j){E.onload=function(){A(E.result)},E.onerror=function(){j(E.error)}})}function Z(E){var A=new FileReader,j=H(A);return A.readAsArrayBuffer(E),j}function B(E){var A=new FileReader,j=H(A),z=/charset=([A-Za-z0-9_-]+)/.exec(E.type),W=z?z[1]:"utf-8";return A.readAsText(E,W),j}function U(E){for(var A=new Uint8Array(E),j=new Array(A.length),z=0;z<A.length;z++)j[z]=String.fromCharCode(A[z]);return j.join("")}function Y(E){if(E.slice)return E.slice(0);var A=new Uint8Array(E.byteLength);return A.set(new Uint8Array(E)),A.buffer}function he(){return this.bodyUsed=!1,this._initBody=function(E){this.bodyUsed=this.bodyUsed,this._bodyInit=E,E?typeof E=="string"?this._bodyText=E:f.blob&&Blob.prototype.isPrototypeOf(E)?this._bodyBlob=E:f.formData&&FormData.prototype.isPrototypeOf(E)?this._bodyFormData=E:f.searchParams&&URLSearchParams.prototype.isPrototypeOf(E)?this._bodyText=E.toString():f.arrayBuffer&&f.blob&&y(E)?(this._bodyArrayBuffer=Y(E.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):f.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(E)||b(E))?this._bodyArrayBuffer=Y(E):this._bodyText=E=Object.prototype.toString.call(E):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof E=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):f.searchParams&&URLSearchParams.prototype.isPrototypeOf(E)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},f.blob&&(this.blob=function(){var E=G(this);if(E)return E;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var E=G(this);return E||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(f.blob)return this.blob().then(Z);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var E=G(this);if(E)return E;if(this._bodyBlob)return B(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(U(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},f.formData&&(this.formData=function(){return this.text().then(gt)}),this.json=function(){return this.text().then(JSON.parse)},this}var ie=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function ue(E){var A=E.toUpperCase();return ie.indexOf(A)>-1?A:E}function de(E,A){if(!(this instanceof de))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');A=A||{};var j=A.body;if(E instanceof de){if(E.bodyUsed)throw new TypeError("Already read");this.url=E.url,this.credentials=E.credentials,A.headers||(this.headers=new N(E.headers)),this.method=E.method,this.mode=E.mode,this.signal=E.signal,!j&&E._bodyInit!=null&&(j=E._bodyInit,E.bodyUsed=!0)}else this.url=String(E);if(this.credentials=A.credentials||this.credentials||"same-origin",(A.headers||!this.headers)&&(this.headers=new N(A.headers)),this.method=ue(A.method||this.method||"GET"),this.mode=A.mode||this.mode||null,this.signal=A.signal||this.signal||function(){if("AbortController"in p){var M=new AbortController;return M.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&j)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(j),(this.method==="GET"||this.method==="HEAD")&&(A.cache==="no-store"||A.cache==="no-cache")){var z=/([?&])_=[^&]*/;if(z.test(this.url))this.url=this.url.replace(z,"$1_="+new Date().getTime());else{var W=/\?/;this.url+=(W.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}de.prototype.clone=function(){return new de(this,{body:this._bodyInit})};function gt(E){var A=new FormData;return E.trim().split("&").forEach(function(j){if(j){var z=j.split("="),W=z.shift().replace(/\+/g," "),M=z.join("=").replace(/\+/g," ");A.append(decodeURIComponent(W),decodeURIComponent(M))}}),A}function yt(E){var A=new N,j=E.replace(/\r?\n[\t ]+/g," ");return j.split("\r").map(function(z){return z.indexOf(`
`)===0?z.substr(1,z.length):z}).forEach(function(z){var W=z.split(":"),M=W.shift().trim();if(M){var ne=W.join(":").trim();try{A.append(M,ne)}catch(Ee){console.warn("Response "+Ee.message)}}}),A}he.call(de.prototype);function Re(E,A){if(!(this instanceof Re))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(A||(A={}),this.type="default",this.status=A.status===void 0?200:A.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=A.statusText===void 0?"":""+A.statusText,this.headers=new N(A.headers),this.url=A.url||"",this._initBody(E)}he.call(Re.prototype),Re.prototype.clone=function(){return new Re(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new N(this.headers),url:this.url})},Re.error=function(){var E=new Re(null,{status:200,statusText:""});return E.ok=!1,E.status=0,E.type="error",E};var er=[301,302,303,307,308];Re.redirect=function(E,A){if(er.indexOf(A)===-1)throw new RangeError("Invalid status code");return new Re(null,{status:A,headers:{location:E}})},h.DOMException=p.DOMException;try{new h.DOMException}catch{h.DOMException=function(A,j){this.message=A,this.name=j;var z=Error(A);this.stack=z.stack},h.DOMException.prototype=Object.create(Error.prototype),h.DOMException.prototype.constructor=h.DOMException}function Lt(E,A){return new Promise(function(j,z){var W=new de(E,A);if(W.signal&&W.signal.aborted)return z(new h.DOMException("Aborted","AbortError"));var M=new XMLHttpRequest;function ne(){M.abort()}M.onload=function(){var se={statusText:M.statusText,headers:yt(M.getAllResponseHeaders()||"")};W.url.indexOf("file://")===0&&(M.status<200||M.status>599)?se.status=200:se.status=M.status,se.url="responseURL"in M?M.responseURL:se.headers.get("X-Request-URL");var Q="response"in M?M.response:M.responseText;setTimeout(function(){j(new Re(Q,se))},0)},M.onerror=function(){setTimeout(function(){z(new TypeError("Network request failed"))},0)},M.ontimeout=function(){setTimeout(function(){z(new TypeError("Network request timed out"))},0)},M.onabort=function(){setTimeout(function(){z(new h.DOMException("Aborted","AbortError"))},0)};function Ee(se){try{return se===""&&p.location.href?p.location.href:se}catch{return se}}if(M.open(W.method,Ee(W.url),!0),W.credentials==="include"?M.withCredentials=!0:W.credentials==="omit"&&(M.withCredentials=!1),"responseType"in M&&(f.blob?M.responseType="blob":f.arrayBuffer&&(M.responseType="arraybuffer")),A&&typeof A.headers=="object"&&!(A.headers instanceof N||p.Headers&&A.headers instanceof p.Headers)){var be=[];Object.getOwnPropertyNames(A.headers).forEach(function(se){be.push(S(se)),M.setRequestHeader(se,O(A.headers[se]))}),W.headers.forEach(function(se,Q){be.indexOf(Q)===-1&&M.setRequestHeader(Q,se)})}else W.headers.forEach(function(se,Q){M.setRequestHeader(Q,se)});W.signal&&(W.signal.addEventListener("abort",ne),M.onreadystatechange=function(){M.readyState===4&&W.signal.removeEventListener("abort",ne)}),M.send(typeof W._bodyInit>"u"?null:W._bodyInit)})}return Lt.polyfill=!0,p.fetch||(p.fetch=Lt,p.Headers=N,p.Request=de,p.Response=Re),h.Headers=N,h.Request=de,h.Response=Re,h.fetch=Lt,Object.defineProperty(h,"__esModule",{value:!0}),h})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var o=r.fetch?r:s;t=o.fetch,t.default=o.fetch,t.fetch=o.fetch,t.Headers=o.Headers,t.Request=o.Request,t.Response=o.Response,n.exports=t})(cu,cu.exports);var vS=cu.exports;const Mf=Uo(vS);var mS=Object.defineProperty,wS=Object.defineProperties,bS=Object.getOwnPropertyDescriptors,Hf=Object.getOwnPropertySymbols,_S=Object.prototype.hasOwnProperty,ES=Object.prototype.propertyIsEnumerable,kf=(n,t,r)=>t in n?mS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Vf=(n,t)=>{for(var r in t||(t={}))_S.call(t,r)&&kf(n,r,t[r]);if(Hf)for(var r of Hf(t))ES.call(t,r)&&kf(n,r,t[r]);return n},Kf=(n,t)=>wS(n,bS(t));const IS={Accept:"application/json","Content-Type":"application/json"},PS="POST",Gf={headers:IS,method:PS},Wf=10;let ui=class{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new zt.EventEmitter,this.isAvailable=!1,this.registering=!1,!yf(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t){this.isAvailable||await this.register();try{const r=Oi(t),s=await(await Mf(this.url,Kf(Vf({},Gf),{body:r}))).json();this.onPayload({data:s})}catch(r){this.onError(t.id,r)}}async register(t=this.url){if(!yf(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=Oi({id:1,jsonrpc:"2.0",method:"test",params:[]});await Mf(t,Kf(Vf({},Gf),{body:r}))}this.onOpen()}catch(r){const s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?us(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),o=s.message||s.toString(),c=Go(t,o);this.events.emit("payload",c)}parseError(t,r=this.url){return Wp(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Wf&&this.events.setMaxListeners(Wf)}};class hi extends Qp{constructor(t){super(t),this.events=new zt.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(Fi(t.method,t.params||[],t.id||Pu().toString()),r)}async requestStrict(t,r){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${t.id}`,c=>{Xt(c)?o(c.error):s(c.result)});try{await this.connection.send(t,r)}catch(c){o(c)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),fs(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Jf="error",xS="wss://relay.walletconnect.com",SS="wc",AS="universal_provider",Qf=`${SS}@2:${AS}:`,FS="https://rpc.walletconnect.com/v1/",Hr={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Xn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},uu={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(n,t){(function(){var r,s="4.17.21",o=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",h="Expected a function",p="Invalid `variable` option passed into `_.template`",f="__lodash_hash_undefined__",y=500,v="__lodash_placeholder__",b=1,S=2,O=4,F=1,N=2,G=1,H=2,Z=4,B=8,U=16,Y=32,he=64,ie=128,ue=256,de=512,gt=30,yt="...",Re=800,er=16,Lt=1,E=2,A=3,j=1/0,z=9007199254740991,W=17976931348623157e292,M=0/0,ne=4294967295,Ee=ne-1,be=ne>>>1,se=[["ary",ie],["bind",G],["bindKey",H],["curry",B],["curryRight",U],["flip",de],["partial",Y],["partialRight",he],["rearg",ue]],Q="[object Arguments]",qe="[object Array]",Ot="[object AsyncFunction]",Ce="[object Boolean]",ze="[object Date]",Rt="[object DOMException]",ht="[object Error]",Ct="[object Function]",kr="[object GeneratorFunction]",et="[object Map]",_r="[object Number]",wn="[object Null]",$t="[object Object]",Ti="[object Promise]",Ni="[object Proxy]",hr="[object RegExp]",tt="[object Set]",lr="[object String]",Er="[object Symbol]",Di="[object Undefined]",fr="[object WeakMap]",Bi="[object WeakSet]",Ut="[object ArrayBuffer]",Mt="[object DataView]",Vr="[object Float32Array]",st="[object Float64Array]",qi="[object Int8Array]",ji="[object Int16Array]",bn="[object Int32Array]",zi="[object Uint8Array]",Kr="[object Uint8ClampedArray]",Li="[object Uint16Array]",Ui="[object Uint32Array]",Qo=/\b__p \+= '';/g,Ir=/\b(__p \+=) '' \+/g,ds=/(__e\(.*?\)|\b__t\)) \+\n'';/g,gs=/&(?:amp|lt|gt|quot|#39);/g,ys=/[&<>"']/g,_n=RegExp(gs.source),li=RegExp(ys.source),En=/<%-([\s\S]+?)%>/g,In=/<%([\s\S]+?)%>/g,Mi=/<%=([\s\S]+?)%>/g,fi=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Yo=/^\w*$/,Zo=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Pn=/[\\^$.*+?()[\]{}|]/g,Xo=RegExp(Pn.source),xn=/^\s+/,vs=/\s/,Sn=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Pr=/\{\n\/\* \[wrapped with (.+)\] \*/,ea=/,? & /,ta=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ra=/[()=,{}\[\]\/\s]/,ia=/\\(\\)?/g,na=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ht=/\w*$/,sa=/^[-+]0x[0-9a-f]+$/i,oa=/^0b[01]+$/i,aa=/^\[object .+?Constructor\]$/,ca=/^0o[0-7]+$/i,ua=/^(?:0|[1-9]\d*)$/,xr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Hi=/($^)/,ha=/['\n\r\u2028\u2029\\]/g,ki="\\ud800-\\udfff",la="\\u0300-\\u036f",fa="\\ufe20-\\ufe2f",Vi="\\u20d0-\\u20ff",ms=la+fa+Vi,ws="\\u2700-\\u27bf",tr="a-z\\xdf-\\xf6\\xf8-\\xff",pa="\\xac\\xb1\\xd7\\xf7",da="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ga="\\u2000-\\u206f",ya=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",bs="A-Z\\xc0-\\xd6\\xd8-\\xde",_s="\\ufe0e\\ufe0f",pi=pa+da+ga+ya,An="[']",di="["+ki+"]",Fn="["+pi+"]",gi="["+ms+"]",Es="\\d+",va="["+ws+"]",Is="["+tr+"]",Ps="[^"+ki+pi+Es+ws+tr+bs+"]",Ki="\\ud83c[\\udffb-\\udfff]",ma="(?:"+gi+"|"+Ki+")",xs="[^"+ki+"]",Gi="(?:\\ud83c[\\udde6-\\uddff]){2}",Gr="[\\ud800-\\udbff][\\udc00-\\udfff]",Tt="["+bs+"]",Ss="\\u200d",As="(?:"+Is+"|"+Ps+")",pr="(?:"+Tt+"|"+Ps+")",Fs="(?:"+An+"(?:d|ll|m|re|s|t|ve))?",Os="(?:"+An+"(?:D|LL|M|RE|S|T|VE))?",Rs=ma+"?",Cs="["+_s+"]?",wa="(?:"+Ss+"(?:"+[xs,Gi,Gr].join("|")+")"+Cs+Rs+")*",Sr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",$s="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ts=Cs+Rs+wa,Wi="(?:"+[va,Gi,Gr].join("|")+")"+Ts,ba="(?:"+[xs+gi+"?",gi,Gi,Gr,di].join("|")+")",On=RegExp(An,"g"),_a=RegExp(gi,"g"),Ji=RegExp(Ki+"(?="+Ki+")|"+ba+Ts,"g"),Ns=RegExp([Tt+"?"+Is+"+"+Fs+"(?="+[Fn,Tt,"$"].join("|")+")",pr+"+"+Os+"(?="+[Fn,Tt+As,"$"].join("|")+")",Tt+"?"+As+"+"+Fs,Tt+"+"+Os,$s,Sr,Es,Wi].join("|"),"g"),Ds=RegExp("["+Ss+ki+ms+_s+"]"),yi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Bs=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ea=-1,Se={};Se[Vr]=Se[st]=Se[qi]=Se[ji]=Se[bn]=Se[zi]=Se[Kr]=Se[Li]=Se[Ui]=!0,Se[Q]=Se[qe]=Se[Ut]=Se[Ce]=Se[Mt]=Se[ze]=Se[ht]=Se[Ct]=Se[et]=Se[_r]=Se[$t]=Se[hr]=Se[tt]=Se[lr]=Se[fr]=!1;var xe={};xe[Q]=xe[qe]=xe[Ut]=xe[Mt]=xe[Ce]=xe[ze]=xe[Vr]=xe[st]=xe[qi]=xe[ji]=xe[bn]=xe[et]=xe[_r]=xe[$t]=xe[hr]=xe[tt]=xe[lr]=xe[Er]=xe[zi]=xe[Kr]=xe[Li]=xe[Ui]=!0,xe[ht]=xe[Ct]=xe[fr]=!1;var m={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},I={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},D={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},k={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ae=parseFloat,ae=parseInt,$e=typeof Xn=="object"&&Xn&&Xn.Object===Object&&Xn,ke=typeof self=="object"&&self&&self.Object===Object&&self,me=$e||ke||Function("return this")(),Fe=t&&!t.nodeType&&t,Le=Fe&&!0&&n&&!n.nodeType&&n,vt=Le&&Le.exports===Fe,Ve=vt&&$e.process,Te=function(){try{var P=Le&&Le.require&&Le.require("util").types;return P||Ve&&Ve.binding&&Ve.binding("util")}catch{}}(),lt=Te&&Te.isArrayBuffer,rr=Te&&Te.isDate,kt=Te&&Te.isMap,dr=Te&&Te.isRegExp,Rn=Te&&Te.isSet,vi=Te&&Te.isTypedArray;function Qe(P,C,R){switch(R.length){case 0:return P.call(C);case 1:return P.call(C,R[0]);case 2:return P.call(C,R[0],R[1]);case 3:return P.call(C,R[0],R[1],R[2])}return P.apply(C,R)}function bd(P,C,R,K){for(var oe=-1,_e=P==null?0:P.length;++oe<_e;){var Ge=P[oe];C(K,Ge,R(Ge),P)}return K}function Vt(P,C){for(var R=-1,K=P==null?0:P.length;++R<K&&C(P[R],R,P)!==!1;);return P}function _d(P,C){for(var R=P==null?0:P.length;R--&&C(P[R],R,P)!==!1;);return P}function Cu(P,C){for(var R=-1,K=P==null?0:P.length;++R<K;)if(!C(P[R],R,P))return!1;return!0}function Wr(P,C){for(var R=-1,K=P==null?0:P.length,oe=0,_e=[];++R<K;){var Ge=P[R];C(Ge,R,P)&&(_e[oe++]=Ge)}return _e}function qs(P,C){var R=P==null?0:P.length;return!!R&&Qi(P,C,0)>-1}function Ia(P,C,R){for(var K=-1,oe=P==null?0:P.length;++K<oe;)if(R(C,P[K]))return!0;return!1}function Ne(P,C){for(var R=-1,K=P==null?0:P.length,oe=Array(K);++R<K;)oe[R]=C(P[R],R,P);return oe}function Jr(P,C){for(var R=-1,K=C.length,oe=P.length;++R<K;)P[oe+R]=C[R];return P}function Pa(P,C,R,K){var oe=-1,_e=P==null?0:P.length;for(K&&_e&&(R=P[++oe]);++oe<_e;)R=C(R,P[oe],oe,P);return R}function Ed(P,C,R,K){var oe=P==null?0:P.length;for(K&&oe&&(R=P[--oe]);oe--;)R=C(R,P[oe],oe,P);return R}function xa(P,C){for(var R=-1,K=P==null?0:P.length;++R<K;)if(C(P[R],R,P))return!0;return!1}var Id=Sa("length");function Pd(P){return P.split("")}function xd(P){return P.match(ta)||[]}function $u(P,C,R){var K;return R(P,function(oe,_e,Ge){if(C(oe,_e,Ge))return K=_e,!1}),K}function js(P,C,R,K){for(var oe=P.length,_e=R+(K?1:-1);K?_e--:++_e<oe;)if(C(P[_e],_e,P))return _e;return-1}function Qi(P,C,R){return C===C?qd(P,C,R):js(P,Tu,R)}function Sd(P,C,R,K){for(var oe=R-1,_e=P.length;++oe<_e;)if(K(P[oe],C))return oe;return-1}function Tu(P){return P!==P}function Nu(P,C){var R=P==null?0:P.length;return R?Fa(P,C)/R:M}function Sa(P){return function(C){return C==null?r:C[P]}}function Aa(P){return function(C){return P==null?r:P[C]}}function Du(P,C,R,K,oe){return oe(P,function(_e,Ge,Oe){R=K?(K=!1,_e):C(R,_e,Ge,Oe)}),R}function Ad(P,C){var R=P.length;for(P.sort(C);R--;)P[R]=P[R].value;return P}function Fa(P,C){for(var R,K=-1,oe=P.length;++K<oe;){var _e=C(P[K]);_e!==r&&(R=R===r?_e:R+_e)}return R}function Oa(P,C){for(var R=-1,K=Array(P);++R<P;)K[R]=C(R);return K}function Fd(P,C){return Ne(C,function(R){return[R,P[R]]})}function Bu(P){return P&&P.slice(0,Lu(P)+1).replace(xn,"")}function Nt(P){return function(C){return P(C)}}function Ra(P,C){return Ne(C,function(R){return P[R]})}function Cn(P,C){return P.has(C)}function qu(P,C){for(var R=-1,K=P.length;++R<K&&Qi(C,P[R],0)>-1;);return R}function ju(P,C){for(var R=P.length;R--&&Qi(C,P[R],0)>-1;);return R}function Od(P,C){for(var R=P.length,K=0;R--;)P[R]===C&&++K;return K}var Rd=Aa(m),Cd=Aa(I);function $d(P){return"\\"+k[P]}function Td(P,C){return P==null?r:P[C]}function Yi(P){return Ds.test(P)}function Nd(P){return yi.test(P)}function Dd(P){for(var C,R=[];!(C=P.next()).done;)R.push(C.value);return R}function Ca(P){var C=-1,R=Array(P.size);return P.forEach(function(K,oe){R[++C]=[oe,K]}),R}function zu(P,C){return function(R){return P(C(R))}}function Qr(P,C){for(var R=-1,K=P.length,oe=0,_e=[];++R<K;){var Ge=P[R];(Ge===C||Ge===v)&&(P[R]=v,_e[oe++]=R)}return _e}function zs(P){var C=-1,R=Array(P.size);return P.forEach(function(K){R[++C]=K}),R}function Bd(P){var C=-1,R=Array(P.size);return P.forEach(function(K){R[++C]=[K,K]}),R}function qd(P,C,R){for(var K=R-1,oe=P.length;++K<oe;)if(P[K]===C)return K;return-1}function jd(P,C,R){for(var K=R+1;K--;)if(P[K]===C)return K;return K}function Zi(P){return Yi(P)?Ld(P):Id(P)}function ir(P){return Yi(P)?Ud(P):Pd(P)}function Lu(P){for(var C=P.length;C--&&vs.test(P.charAt(C)););return C}var zd=Aa(D);function Ld(P){for(var C=Ji.lastIndex=0;Ji.test(P);)++C;return C}function Ud(P){return P.match(Ji)||[]}function Md(P){return P.match(Ns)||[]}var Hd=function P(C){C=C==null?me:Xi.defaults(me.Object(),C,Xi.pick(me,Bs));var R=C.Array,K=C.Date,oe=C.Error,_e=C.Function,Ge=C.Math,Oe=C.Object,$a=C.RegExp,kd=C.String,Kt=C.TypeError,Ls=R.prototype,Vd=_e.prototype,en=Oe.prototype,Us=C["__core-js_shared__"],Ms=Vd.toString,Pe=en.hasOwnProperty,Kd=0,Uu=function(){var e=/[^.]+$/.exec(Us&&Us.keys&&Us.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Hs=en.toString,Gd=Ms.call(Oe),Wd=me._,Jd=$a("^"+Ms.call(Pe).replace(Pn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ks=vt?C.Buffer:r,Yr=C.Symbol,Vs=C.Uint8Array,Mu=ks?ks.allocUnsafe:r,Ks=zu(Oe.getPrototypeOf,Oe),Hu=Oe.create,ku=en.propertyIsEnumerable,Gs=Ls.splice,Vu=Yr?Yr.isConcatSpreadable:r,$n=Yr?Yr.iterator:r,mi=Yr?Yr.toStringTag:r,Ws=function(){try{var e=Ii(Oe,"defineProperty");return e({},"",{}),e}catch{}}(),Qd=C.clearTimeout!==me.clearTimeout&&C.clearTimeout,Yd=K&&K.now!==me.Date.now&&K.now,Zd=C.setTimeout!==me.setTimeout&&C.setTimeout,Js=Ge.ceil,Qs=Ge.floor,Ta=Oe.getOwnPropertySymbols,Xd=ks?ks.isBuffer:r,Ku=C.isFinite,eg=Ls.join,tg=zu(Oe.keys,Oe),We=Ge.max,ot=Ge.min,rg=K.now,ig=C.parseInt,Gu=Ge.random,ng=Ls.reverse,Na=Ii(C,"DataView"),Tn=Ii(C,"Map"),Da=Ii(C,"Promise"),tn=Ii(C,"Set"),Nn=Ii(C,"WeakMap"),Dn=Ii(Oe,"create"),Ys=Nn&&new Nn,rn={},sg=Pi(Na),og=Pi(Tn),ag=Pi(Da),cg=Pi(tn),ug=Pi(Nn),Zs=Yr?Yr.prototype:r,Bn=Zs?Zs.valueOf:r,Wu=Zs?Zs.toString:r;function d(e){if(je(e)&&!ce(e)&&!(e instanceof ve)){if(e instanceof Gt)return e;if(Pe.call(e,"__wrapped__"))return Jh(e)}return new Gt(e)}var nn=function(){function e(){}return function(i){if(!Be(i))return{};if(Hu)return Hu(i);e.prototype=i;var a=new e;return e.prototype=r,a}}();function Xs(){}function Gt(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}d.templateSettings={escape:En,evaluate:In,interpolate:Mi,variable:"",imports:{_:d}},d.prototype=Xs.prototype,d.prototype.constructor=d,Gt.prototype=nn(Xs.prototype),Gt.prototype.constructor=Gt;function ve(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ne,this.__views__=[]}function hg(){var e=new ve(this.__wrapped__);return e.__actions__=mt(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=mt(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=mt(this.__views__),e}function lg(){if(this.__filtered__){var e=new ve(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function fg(){var e=this.__wrapped__.value(),i=this.__dir__,a=ce(e),u=i<0,l=a?e.length:0,g=Py(0,l,this.__views__),w=g.start,_=g.end,x=_-w,$=u?_:w-1,T=this.__iteratees__,q=T.length,L=0,J=ot(x,this.__takeCount__);if(!a||!u&&l==x&&J==x)return mh(e,this.__actions__);var te=[];e:for(;x--&&L<J;){$+=i;for(var fe=-1,re=e[$];++fe<q;){var ye=T[fe],we=ye.iteratee,qt=ye.type,dt=we(re);if(qt==E)re=dt;else if(!dt){if(qt==Lt)continue e;break e}}te[L++]=re}return te}ve.prototype=nn(Xs.prototype),ve.prototype.constructor=ve;function wi(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var u=e[i];this.set(u[0],u[1])}}function pg(){this.__data__=Dn?Dn(null):{},this.size=0}function dg(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function gg(e){var i=this.__data__;if(Dn){var a=i[e];return a===f?r:a}return Pe.call(i,e)?i[e]:r}function yg(e){var i=this.__data__;return Dn?i[e]!==r:Pe.call(i,e)}function vg(e,i){var a=this.__data__;return this.size+=this.has(e)?0:1,a[e]=Dn&&i===r?f:i,this}wi.prototype.clear=pg,wi.prototype.delete=dg,wi.prototype.get=gg,wi.prototype.has=yg,wi.prototype.set=vg;function Ar(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var u=e[i];this.set(u[0],u[1])}}function mg(){this.__data__=[],this.size=0}function wg(e){var i=this.__data__,a=eo(i,e);if(a<0)return!1;var u=i.length-1;return a==u?i.pop():Gs.call(i,a,1),--this.size,!0}function bg(e){var i=this.__data__,a=eo(i,e);return a<0?r:i[a][1]}function _g(e){return eo(this.__data__,e)>-1}function Eg(e,i){var a=this.__data__,u=eo(a,e);return u<0?(++this.size,a.push([e,i])):a[u][1]=i,this}Ar.prototype.clear=mg,Ar.prototype.delete=wg,Ar.prototype.get=bg,Ar.prototype.has=_g,Ar.prototype.set=Eg;function Fr(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var u=e[i];this.set(u[0],u[1])}}function Ig(){this.size=0,this.__data__={hash:new wi,map:new(Tn||Ar),string:new wi}}function Pg(e){var i=fo(this,e).delete(e);return this.size-=i?1:0,i}function xg(e){return fo(this,e).get(e)}function Sg(e){return fo(this,e).has(e)}function Ag(e,i){var a=fo(this,e),u=a.size;return a.set(e,i),this.size+=a.size==u?0:1,this}Fr.prototype.clear=Ig,Fr.prototype.delete=Pg,Fr.prototype.get=xg,Fr.prototype.has=Sg,Fr.prototype.set=Ag;function bi(e){var i=-1,a=e==null?0:e.length;for(this.__data__=new Fr;++i<a;)this.add(e[i])}function Fg(e){return this.__data__.set(e,f),this}function Og(e){return this.__data__.has(e)}bi.prototype.add=bi.prototype.push=Fg,bi.prototype.has=Og;function nr(e){var i=this.__data__=new Ar(e);this.size=i.size}function Rg(){this.__data__=new Ar,this.size=0}function Cg(e){var i=this.__data__,a=i.delete(e);return this.size=i.size,a}function $g(e){return this.__data__.get(e)}function Tg(e){return this.__data__.has(e)}function Ng(e,i){var a=this.__data__;if(a instanceof Ar){var u=a.__data__;if(!Tn||u.length<o-1)return u.push([e,i]),this.size=++a.size,this;a=this.__data__=new Fr(u)}return a.set(e,i),this.size=a.size,this}nr.prototype.clear=Rg,nr.prototype.delete=Cg,nr.prototype.get=$g,nr.prototype.has=Tg,nr.prototype.set=Ng;function Ju(e,i){var a=ce(e),u=!a&&xi(e),l=!a&&!u&&ri(e),g=!a&&!u&&!l&&cn(e),w=a||u||l||g,_=w?Oa(e.length,kd):[],x=_.length;for(var $ in e)(i||Pe.call(e,$))&&!(w&&($=="length"||l&&($=="offset"||$=="parent")||g&&($=="buffer"||$=="byteLength"||$=="byteOffset")||$r($,x)))&&_.push($);return _}function Qu(e){var i=e.length;return i?e[Ka(0,i-1)]:r}function Dg(e,i){return po(mt(e),_i(i,0,e.length))}function Bg(e){return po(mt(e))}function Ba(e,i,a){(a!==r&&!sr(e[i],a)||a===r&&!(i in e))&&Or(e,i,a)}function qn(e,i,a){var u=e[i];(!(Pe.call(e,i)&&sr(u,a))||a===r&&!(i in e))&&Or(e,i,a)}function eo(e,i){for(var a=e.length;a--;)if(sr(e[a][0],i))return a;return-1}function qg(e,i,a,u){return Zr(e,function(l,g,w){i(u,l,a(l),w)}),u}function Yu(e,i){return e&&yr(i,Ye(i),e)}function jg(e,i){return e&&yr(i,bt(i),e)}function Or(e,i,a){i=="__proto__"&&Ws?Ws(e,i,{configurable:!0,enumerable:!0,value:a,writable:!0}):e[i]=a}function qa(e,i){for(var a=-1,u=i.length,l=R(u),g=e==null;++a<u;)l[a]=g?r:vc(e,i[a]);return l}function _i(e,i,a){return e===e&&(a!==r&&(e=e<=a?e:a),i!==r&&(e=e>=i?e:i)),e}function Wt(e,i,a,u,l,g){var w,_=i&b,x=i&S,$=i&O;if(a&&(w=l?a(e,u,l,g):a(e)),w!==r)return w;if(!Be(e))return e;var T=ce(e);if(T){if(w=Sy(e),!_)return mt(e,w)}else{var q=at(e),L=q==Ct||q==kr;if(ri(e))return _h(e,_);if(q==$t||q==Q||L&&!l){if(w=x||L?{}:Lh(e),!_)return x?gy(e,jg(w,e)):dy(e,Yu(w,e))}else{if(!xe[q])return l?e:{};w=Ay(e,q,_)}}g||(g=new nr);var J=g.get(e);if(J)return J;g.set(e,w),gl(e)?e.forEach(function(re){w.add(Wt(re,i,a,re,e,g))}):pl(e)&&e.forEach(function(re,ye){w.set(ye,Wt(re,i,a,ye,e,g))});var te=$?x?ic:rc:x?bt:Ye,fe=T?r:te(e);return Vt(fe||e,function(re,ye){fe&&(ye=re,re=e[ye]),qn(w,ye,Wt(re,i,a,ye,e,g))}),w}function zg(e){var i=Ye(e);return function(a){return Zu(a,e,i)}}function Zu(e,i,a){var u=a.length;if(e==null)return!u;for(e=Oe(e);u--;){var l=a[u],g=i[l],w=e[l];if(w===r&&!(l in e)||!g(w))return!1}return!0}function Xu(e,i,a){if(typeof e!="function")throw new Kt(h);return kn(function(){e.apply(r,a)},i)}function jn(e,i,a,u){var l=-1,g=qs,w=!0,_=e.length,x=[],$=i.length;if(!_)return x;a&&(i=Ne(i,Nt(a))),u?(g=Ia,w=!1):i.length>=o&&(g=Cn,w=!1,i=new bi(i));e:for(;++l<_;){var T=e[l],q=a==null?T:a(T);if(T=u||T!==0?T:0,w&&q===q){for(var L=$;L--;)if(i[L]===q)continue e;x.push(T)}else g(i,q,u)||x.push(T)}return x}var Zr=Sh(gr),eh=Sh(za,!0);function Lg(e,i){var a=!0;return Zr(e,function(u,l,g){return a=!!i(u,l,g),a}),a}function to(e,i,a){for(var u=-1,l=e.length;++u<l;){var g=e[u],w=i(g);if(w!=null&&(_===r?w===w&&!Bt(w):a(w,_)))var _=w,x=g}return x}function Ug(e,i,a,u){var l=e.length;for(a=le(a),a<0&&(a=-a>l?0:l+a),u=u===r||u>l?l:le(u),u<0&&(u+=l),u=a>u?0:vl(u);a<u;)e[a++]=i;return e}function th(e,i){var a=[];return Zr(e,function(u,l,g){i(u,l,g)&&a.push(u)}),a}function rt(e,i,a,u,l){var g=-1,w=e.length;for(a||(a=Oy),l||(l=[]);++g<w;){var _=e[g];i>0&&a(_)?i>1?rt(_,i-1,a,u,l):Jr(l,_):u||(l[l.length]=_)}return l}var ja=Ah(),rh=Ah(!0);function gr(e,i){return e&&ja(e,i,Ye)}function za(e,i){return e&&rh(e,i,Ye)}function ro(e,i){return Wr(i,function(a){return Tr(e[a])})}function Ei(e,i){i=ei(i,e);for(var a=0,u=i.length;e!=null&&a<u;)e=e[vr(i[a++])];return a&&a==u?e:r}function ih(e,i,a){var u=i(e);return ce(e)?u:Jr(u,a(e))}function ft(e){return e==null?e===r?Di:wn:mi&&mi in Oe(e)?Iy(e):By(e)}function La(e,i){return e>i}function Mg(e,i){return e!=null&&Pe.call(e,i)}function Hg(e,i){return e!=null&&i in Oe(e)}function kg(e,i,a){return e>=ot(i,a)&&e<We(i,a)}function Ua(e,i,a){for(var u=a?Ia:qs,l=e[0].length,g=e.length,w=g,_=R(g),x=1/0,$=[];w--;){var T=e[w];w&&i&&(T=Ne(T,Nt(i))),x=ot(T.length,x),_[w]=!a&&(i||l>=120&&T.length>=120)?new bi(w&&T):r}T=e[0];var q=-1,L=_[0];e:for(;++q<l&&$.length<x;){var J=T[q],te=i?i(J):J;if(J=a||J!==0?J:0,!(L?Cn(L,te):u($,te,a))){for(w=g;--w;){var fe=_[w];if(!(fe?Cn(fe,te):u(e[w],te,a)))continue e}L&&L.push(te),$.push(J)}}return $}function Vg(e,i,a,u){return gr(e,function(l,g,w){i(u,a(l),g,w)}),u}function zn(e,i,a){i=ei(i,e),e=kh(e,i);var u=e==null?e:e[vr(Qt(i))];return u==null?r:Qe(u,e,a)}function nh(e){return je(e)&&ft(e)==Q}function Kg(e){return je(e)&&ft(e)==Ut}function Gg(e){return je(e)&&ft(e)==ze}function Ln(e,i,a,u,l){return e===i?!0:e==null||i==null||!je(e)&&!je(i)?e!==e&&i!==i:Wg(e,i,a,u,Ln,l)}function Wg(e,i,a,u,l,g){var w=ce(e),_=ce(i),x=w?qe:at(e),$=_?qe:at(i);x=x==Q?$t:x,$=$==Q?$t:$;var T=x==$t,q=$==$t,L=x==$;if(L&&ri(e)){if(!ri(i))return!1;w=!0,T=!1}if(L&&!T)return g||(g=new nr),w||cn(e)?qh(e,i,a,u,l,g):_y(e,i,x,a,u,l,g);if(!(a&F)){var J=T&&Pe.call(e,"__wrapped__"),te=q&&Pe.call(i,"__wrapped__");if(J||te){var fe=J?e.value():e,re=te?i.value():i;return g||(g=new nr),l(fe,re,a,u,g)}}return L?(g||(g=new nr),Ey(e,i,a,u,l,g)):!1}function Jg(e){return je(e)&&at(e)==et}function Ma(e,i,a,u){var l=a.length,g=l,w=!u;if(e==null)return!g;for(e=Oe(e);l--;){var _=a[l];if(w&&_[2]?_[1]!==e[_[0]]:!(_[0]in e))return!1}for(;++l<g;){_=a[l];var x=_[0],$=e[x],T=_[1];if(w&&_[2]){if($===r&&!(x in e))return!1}else{var q=new nr;if(u)var L=u($,T,x,e,i,q);if(!(L===r?Ln(T,$,F|N,u,q):L))return!1}}return!0}function sh(e){if(!Be(e)||Cy(e))return!1;var i=Tr(e)?Jd:aa;return i.test(Pi(e))}function Qg(e){return je(e)&&ft(e)==hr}function Yg(e){return je(e)&&at(e)==tt}function Zg(e){return je(e)&&bo(e.length)&&!!Se[ft(e)]}function oh(e){return typeof e=="function"?e:e==null?_t:typeof e=="object"?ce(e)?uh(e[0],e[1]):ch(e):Fl(e)}function Ha(e){if(!Hn(e))return tg(e);var i=[];for(var a in Oe(e))Pe.call(e,a)&&a!="constructor"&&i.push(a);return i}function Xg(e){if(!Be(e))return Dy(e);var i=Hn(e),a=[];for(var u in e)u=="constructor"&&(i||!Pe.call(e,u))||a.push(u);return a}function ka(e,i){return e<i}function ah(e,i){var a=-1,u=wt(e)?R(e.length):[];return Zr(e,function(l,g,w){u[++a]=i(l,g,w)}),u}function ch(e){var i=sc(e);return i.length==1&&i[0][2]?Mh(i[0][0],i[0][1]):function(a){return a===e||Ma(a,e,i)}}function uh(e,i){return ac(e)&&Uh(i)?Mh(vr(e),i):function(a){var u=vc(a,e);return u===r&&u===i?mc(a,e):Ln(i,u,F|N)}}function io(e,i,a,u,l){e!==i&&ja(i,function(g,w){if(l||(l=new nr),Be(g))ey(e,i,w,a,io,u,l);else{var _=u?u(uc(e,w),g,w+"",e,i,l):r;_===r&&(_=g),Ba(e,w,_)}},bt)}function ey(e,i,a,u,l,g,w){var _=uc(e,a),x=uc(i,a),$=w.get(x);if($){Ba(e,a,$);return}var T=g?g(_,x,a+"",e,i,w):r,q=T===r;if(q){var L=ce(x),J=!L&&ri(x),te=!L&&!J&&cn(x);T=x,L||J||te?ce(_)?T=_:Ue(_)?T=mt(_):J?(q=!1,T=_h(x,!0)):te?(q=!1,T=Eh(x,!0)):T=[]:Vn(x)||xi(x)?(T=_,xi(_)?T=ml(_):(!Be(_)||Tr(_))&&(T=Lh(x))):q=!1}q&&(w.set(x,T),l(T,x,u,g,w),w.delete(x)),Ba(e,a,T)}function hh(e,i){var a=e.length;if(a)return i+=i<0?a:0,$r(i,a)?e[i]:r}function lh(e,i,a){i.length?i=Ne(i,function(g){return ce(g)?function(w){return Ei(w,g.length===1?g[0]:g)}:g}):i=[_t];var u=-1;i=Ne(i,Nt(ee()));var l=ah(e,function(g,w,_){var x=Ne(i,function($){return $(g)});return{criteria:x,index:++u,value:g}});return Ad(l,function(g,w){return py(g,w,a)})}function ty(e,i){return fh(e,i,function(a,u){return mc(e,u)})}function fh(e,i,a){for(var u=-1,l=i.length,g={};++u<l;){var w=i[u],_=Ei(e,w);a(_,w)&&Un(g,ei(w,e),_)}return g}function ry(e){return function(i){return Ei(i,e)}}function Va(e,i,a,u){var l=u?Sd:Qi,g=-1,w=i.length,_=e;for(e===i&&(i=mt(i)),a&&(_=Ne(e,Nt(a)));++g<w;)for(var x=0,$=i[g],T=a?a($):$;(x=l(_,T,x,u))>-1;)_!==e&&Gs.call(_,x,1),Gs.call(e,x,1);return e}function ph(e,i){for(var a=e?i.length:0,u=a-1;a--;){var l=i[a];if(a==u||l!==g){var g=l;$r(l)?Gs.call(e,l,1):Ja(e,l)}}return e}function Ka(e,i){return e+Qs(Gu()*(i-e+1))}function iy(e,i,a,u){for(var l=-1,g=We(Js((i-e)/(a||1)),0),w=R(g);g--;)w[u?g:++l]=e,e+=a;return w}function Ga(e,i){var a="";if(!e||i<1||i>z)return a;do i%2&&(a+=e),i=Qs(i/2),i&&(e+=e);while(i);return a}function ge(e,i){return hc(Hh(e,i,_t),e+"")}function ny(e){return Qu(un(e))}function sy(e,i){var a=un(e);return po(a,_i(i,0,a.length))}function Un(e,i,a,u){if(!Be(e))return e;i=ei(i,e);for(var l=-1,g=i.length,w=g-1,_=e;_!=null&&++l<g;){var x=vr(i[l]),$=a;if(x==="__proto__"||x==="constructor"||x==="prototype")return e;if(l!=w){var T=_[x];$=u?u(T,x,_):r,$===r&&($=Be(T)?T:$r(i[l+1])?[]:{})}qn(_,x,$),_=_[x]}return e}var dh=Ys?function(e,i){return Ys.set(e,i),e}:_t,oy=Ws?function(e,i){return Ws(e,"toString",{configurable:!0,enumerable:!1,value:bc(i),writable:!0})}:_t;function ay(e){return po(un(e))}function Jt(e,i,a){var u=-1,l=e.length;i<0&&(i=-i>l?0:l+i),a=a>l?l:a,a<0&&(a+=l),l=i>a?0:a-i>>>0,i>>>=0;for(var g=R(l);++u<l;)g[u]=e[u+i];return g}function cy(e,i){var a;return Zr(e,function(u,l,g){return a=i(u,l,g),!a}),!!a}function no(e,i,a){var u=0,l=e==null?u:e.length;if(typeof i=="number"&&i===i&&l<=be){for(;u<l;){var g=u+l>>>1,w=e[g];w!==null&&!Bt(w)&&(a?w<=i:w<i)?u=g+1:l=g}return l}return Wa(e,i,_t,a)}function Wa(e,i,a,u){var l=0,g=e==null?0:e.length;if(g===0)return 0;i=a(i);for(var w=i!==i,_=i===null,x=Bt(i),$=i===r;l<g;){var T=Qs((l+g)/2),q=a(e[T]),L=q!==r,J=q===null,te=q===q,fe=Bt(q);if(w)var re=u||te;else $?re=te&&(u||L):_?re=te&&L&&(u||!J):x?re=te&&L&&!J&&(u||!fe):J||fe?re=!1:re=u?q<=i:q<i;re?l=T+1:g=T}return ot(g,Ee)}function gh(e,i){for(var a=-1,u=e.length,l=0,g=[];++a<u;){var w=e[a],_=i?i(w):w;if(!a||!sr(_,x)){var x=_;g[l++]=w===0?0:w}}return g}function yh(e){return typeof e=="number"?e:Bt(e)?M:+e}function Dt(e){if(typeof e=="string")return e;if(ce(e))return Ne(e,Dt)+"";if(Bt(e))return Wu?Wu.call(e):"";var i=e+"";return i=="0"&&1/e==-j?"-0":i}function Xr(e,i,a){var u=-1,l=qs,g=e.length,w=!0,_=[],x=_;if(a)w=!1,l=Ia;else if(g>=o){var $=i?null:wy(e);if($)return zs($);w=!1,l=Cn,x=new bi}else x=i?[]:_;e:for(;++u<g;){var T=e[u],q=i?i(T):T;if(T=a||T!==0?T:0,w&&q===q){for(var L=x.length;L--;)if(x[L]===q)continue e;i&&x.push(q),_.push(T)}else l(x,q,a)||(x!==_&&x.push(q),_.push(T))}return _}function Ja(e,i){return i=ei(i,e),e=kh(e,i),e==null||delete e[vr(Qt(i))]}function vh(e,i,a,u){return Un(e,i,a(Ei(e,i)),u)}function so(e,i,a,u){for(var l=e.length,g=u?l:-1;(u?g--:++g<l)&&i(e[g],g,e););return a?Jt(e,u?0:g,u?g+1:l):Jt(e,u?g+1:0,u?l:g)}function mh(e,i){var a=e;return a instanceof ve&&(a=a.value()),Pa(i,function(u,l){return l.func.apply(l.thisArg,Jr([u],l.args))},a)}function Qa(e,i,a){var u=e.length;if(u<2)return u?Xr(e[0]):[];for(var l=-1,g=R(u);++l<u;)for(var w=e[l],_=-1;++_<u;)_!=l&&(g[l]=jn(g[l]||w,e[_],i,a));return Xr(rt(g,1),i,a)}function wh(e,i,a){for(var u=-1,l=e.length,g=i.length,w={};++u<l;){var _=u<g?i[u]:r;a(w,e[u],_)}return w}function Ya(e){return Ue(e)?e:[]}function Za(e){return typeof e=="function"?e:_t}function ei(e,i){return ce(e)?e:ac(e,i)?[e]:Wh(Ie(e))}var uy=ge;function ti(e,i,a){var u=e.length;return a=a===r?u:a,!i&&a>=u?e:Jt(e,i,a)}var bh=Qd||function(e){return me.clearTimeout(e)};function _h(e,i){if(i)return e.slice();var a=e.length,u=Mu?Mu(a):new e.constructor(a);return e.copy(u),u}function Xa(e){var i=new e.constructor(e.byteLength);return new Vs(i).set(new Vs(e)),i}function hy(e,i){var a=i?Xa(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.byteLength)}function ly(e){var i=new e.constructor(e.source,Ht.exec(e));return i.lastIndex=e.lastIndex,i}function fy(e){return Bn?Oe(Bn.call(e)):{}}function Eh(e,i){var a=i?Xa(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.length)}function Ih(e,i){if(e!==i){var a=e!==r,u=e===null,l=e===e,g=Bt(e),w=i!==r,_=i===null,x=i===i,$=Bt(i);if(!_&&!$&&!g&&e>i||g&&w&&x&&!_&&!$||u&&w&&x||!a&&x||!l)return 1;if(!u&&!g&&!$&&e<i||$&&a&&l&&!u&&!g||_&&a&&l||!w&&l||!x)return-1}return 0}function py(e,i,a){for(var u=-1,l=e.criteria,g=i.criteria,w=l.length,_=a.length;++u<w;){var x=Ih(l[u],g[u]);if(x){if(u>=_)return x;var $=a[u];return x*($=="desc"?-1:1)}}return e.index-i.index}function Ph(e,i,a,u){for(var l=-1,g=e.length,w=a.length,_=-1,x=i.length,$=We(g-w,0),T=R(x+$),q=!u;++_<x;)T[_]=i[_];for(;++l<w;)(q||l<g)&&(T[a[l]]=e[l]);for(;$--;)T[_++]=e[l++];return T}function xh(e,i,a,u){for(var l=-1,g=e.length,w=-1,_=a.length,x=-1,$=i.length,T=We(g-_,0),q=R(T+$),L=!u;++l<T;)q[l]=e[l];for(var J=l;++x<$;)q[J+x]=i[x];for(;++w<_;)(L||l<g)&&(q[J+a[w]]=e[l++]);return q}function mt(e,i){var a=-1,u=e.length;for(i||(i=R(u));++a<u;)i[a]=e[a];return i}function yr(e,i,a,u){var l=!a;a||(a={});for(var g=-1,w=i.length;++g<w;){var _=i[g],x=u?u(a[_],e[_],_,a,e):r;x===r&&(x=e[_]),l?Or(a,_,x):qn(a,_,x)}return a}function dy(e,i){return yr(e,oc(e),i)}function gy(e,i){return yr(e,jh(e),i)}function oo(e,i){return function(a,u){var l=ce(a)?bd:qg,g=i?i():{};return l(a,e,ee(u,2),g)}}function sn(e){return ge(function(i,a){var u=-1,l=a.length,g=l>1?a[l-1]:r,w=l>2?a[2]:r;for(g=e.length>3&&typeof g=="function"?(l--,g):r,w&&pt(a[0],a[1],w)&&(g=l<3?r:g,l=1),i=Oe(i);++u<l;){var _=a[u];_&&e(i,_,u,g)}return i})}function Sh(e,i){return function(a,u){if(a==null)return a;if(!wt(a))return e(a,u);for(var l=a.length,g=i?l:-1,w=Oe(a);(i?g--:++g<l)&&u(w[g],g,w)!==!1;);return a}}function Ah(e){return function(i,a,u){for(var l=-1,g=Oe(i),w=u(i),_=w.length;_--;){var x=w[e?_:++l];if(a(g[x],x,g)===!1)break}return i}}function yy(e,i,a){var u=i&G,l=Mn(e);function g(){var w=this&&this!==me&&this instanceof g?l:e;return w.apply(u?a:this,arguments)}return g}function Fh(e){return function(i){i=Ie(i);var a=Yi(i)?ir(i):r,u=a?a[0]:i.charAt(0),l=a?ti(a,1).join(""):i.slice(1);return u[e]()+l}}function on(e){return function(i){return Pa(Sl(xl(i).replace(On,"")),e,"")}}function Mn(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var a=nn(e.prototype),u=e.apply(a,i);return Be(u)?u:a}}function vy(e,i,a){var u=Mn(e);function l(){for(var g=arguments.length,w=R(g),_=g,x=an(l);_--;)w[_]=arguments[_];var $=g<3&&w[0]!==x&&w[g-1]!==x?[]:Qr(w,x);if(g-=$.length,g<a)return Th(e,i,ao,l.placeholder,r,w,$,r,r,a-g);var T=this&&this!==me&&this instanceof l?u:e;return Qe(T,this,w)}return l}function Oh(e){return function(i,a,u){var l=Oe(i);if(!wt(i)){var g=ee(a,3);i=Ye(i),a=function(_){return g(l[_],_,l)}}var w=e(i,a,u);return w>-1?l[g?i[w]:w]:r}}function Rh(e){return Cr(function(i){var a=i.length,u=a,l=Gt.prototype.thru;for(e&&i.reverse();u--;){var g=i[u];if(typeof g!="function")throw new Kt(h);if(l&&!w&&lo(g)=="wrapper")var w=new Gt([],!0)}for(u=w?u:a;++u<a;){g=i[u];var _=lo(g),x=_=="wrapper"?nc(g):r;x&&cc(x[0])&&x[1]==(ie|B|Y|ue)&&!x[4].length&&x[9]==1?w=w[lo(x[0])].apply(w,x[3]):w=g.length==1&&cc(g)?w[_]():w.thru(g)}return function(){var $=arguments,T=$[0];if(w&&$.length==1&&ce(T))return w.plant(T).value();for(var q=0,L=a?i[q].apply(this,$):T;++q<a;)L=i[q].call(this,L);return L}})}function ao(e,i,a,u,l,g,w,_,x,$){var T=i&ie,q=i&G,L=i&H,J=i&(B|U),te=i&de,fe=L?r:Mn(e);function re(){for(var ye=arguments.length,we=R(ye),qt=ye;qt--;)we[qt]=arguments[qt];if(J)var dt=an(re),jt=Od(we,dt);if(u&&(we=Ph(we,u,l,J)),g&&(we=xh(we,g,w,J)),ye-=jt,J&&ye<$){var Me=Qr(we,dt);return Th(e,i,ao,re.placeholder,a,we,Me,_,x,$-ye)}var or=q?a:this,Dr=L?or[e]:e;return ye=we.length,_?we=qy(we,_):te&&ye>1&&we.reverse(),T&&x<ye&&(we.length=x),this&&this!==me&&this instanceof re&&(Dr=fe||Mn(Dr)),Dr.apply(or,we)}return re}function Ch(e,i){return function(a,u){return Vg(a,e,i(u),{})}}function co(e,i){return function(a,u){var l;if(a===r&&u===r)return i;if(a!==r&&(l=a),u!==r){if(l===r)return u;typeof a=="string"||typeof u=="string"?(a=Dt(a),u=Dt(u)):(a=yh(a),u=yh(u)),l=e(a,u)}return l}}function ec(e){return Cr(function(i){return i=Ne(i,Nt(ee())),ge(function(a){var u=this;return e(i,function(l){return Qe(l,u,a)})})})}function uo(e,i){i=i===r?" ":Dt(i);var a=i.length;if(a<2)return a?Ga(i,e):i;var u=Ga(i,Js(e/Zi(i)));return Yi(i)?ti(ir(u),0,e).join(""):u.slice(0,e)}function my(e,i,a,u){var l=i&G,g=Mn(e);function w(){for(var _=-1,x=arguments.length,$=-1,T=u.length,q=R(T+x),L=this&&this!==me&&this instanceof w?g:e;++$<T;)q[$]=u[$];for(;x--;)q[$++]=arguments[++_];return Qe(L,l?a:this,q)}return w}function $h(e){return function(i,a,u){return u&&typeof u!="number"&&pt(i,a,u)&&(a=u=r),i=Nr(i),a===r?(a=i,i=0):a=Nr(a),u=u===r?i<a?1:-1:Nr(u),iy(i,a,u,e)}}function ho(e){return function(i,a){return typeof i=="string"&&typeof a=="string"||(i=Yt(i),a=Yt(a)),e(i,a)}}function Th(e,i,a,u,l,g,w,_,x,$){var T=i&B,q=T?w:r,L=T?r:w,J=T?g:r,te=T?r:g;i|=T?Y:he,i&=~(T?he:Y),i&Z||(i&=~(G|H));var fe=[e,i,l,J,q,te,L,_,x,$],re=a.apply(r,fe);return cc(e)&&Vh(re,fe),re.placeholder=u,Kh(re,e,i)}function tc(e){var i=Ge[e];return function(a,u){if(a=Yt(a),u=u==null?0:ot(le(u),292),u&&Ku(a)){var l=(Ie(a)+"e").split("e"),g=i(l[0]+"e"+(+l[1]+u));return l=(Ie(g)+"e").split("e"),+(l[0]+"e"+(+l[1]-u))}return i(a)}}var wy=tn&&1/zs(new tn([,-0]))[1]==j?function(e){return new tn(e)}:Ic;function Nh(e){return function(i){var a=at(i);return a==et?Ca(i):a==tt?Bd(i):Fd(i,e(i))}}function Rr(e,i,a,u,l,g,w,_){var x=i&H;if(!x&&typeof e!="function")throw new Kt(h);var $=u?u.length:0;if($||(i&=~(Y|he),u=l=r),w=w===r?w:We(le(w),0),_=_===r?_:le(_),$-=l?l.length:0,i&he){var T=u,q=l;u=l=r}var L=x?r:nc(e),J=[e,i,a,u,l,T,q,g,w,_];if(L&&Ny(J,L),e=J[0],i=J[1],a=J[2],u=J[3],l=J[4],_=J[9]=J[9]===r?x?0:e.length:We(J[9]-$,0),!_&&i&(B|U)&&(i&=~(B|U)),!i||i==G)var te=yy(e,i,a);else i==B||i==U?te=vy(e,i,_):(i==Y||i==(G|Y))&&!l.length?te=my(e,i,a,u):te=ao.apply(r,J);var fe=L?dh:Vh;return Kh(fe(te,J),e,i)}function Dh(e,i,a,u){return e===r||sr(e,en[a])&&!Pe.call(u,a)?i:e}function Bh(e,i,a,u,l,g){return Be(e)&&Be(i)&&(g.set(i,e),io(e,i,r,Bh,g),g.delete(i)),e}function by(e){return Vn(e)?r:e}function qh(e,i,a,u,l,g){var w=a&F,_=e.length,x=i.length;if(_!=x&&!(w&&x>_))return!1;var $=g.get(e),T=g.get(i);if($&&T)return $==i&&T==e;var q=-1,L=!0,J=a&N?new bi:r;for(g.set(e,i),g.set(i,e);++q<_;){var te=e[q],fe=i[q];if(u)var re=w?u(fe,te,q,i,e,g):u(te,fe,q,e,i,g);if(re!==r){if(re)continue;L=!1;break}if(J){if(!xa(i,function(ye,we){if(!Cn(J,we)&&(te===ye||l(te,ye,a,u,g)))return J.push(we)})){L=!1;break}}else if(!(te===fe||l(te,fe,a,u,g))){L=!1;break}}return g.delete(e),g.delete(i),L}function _y(e,i,a,u,l,g,w){switch(a){case Mt:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case Ut:return!(e.byteLength!=i.byteLength||!g(new Vs(e),new Vs(i)));case Ce:case ze:case _r:return sr(+e,+i);case ht:return e.name==i.name&&e.message==i.message;case hr:case lr:return e==i+"";case et:var _=Ca;case tt:var x=u&F;if(_||(_=zs),e.size!=i.size&&!x)return!1;var $=w.get(e);if($)return $==i;u|=N,w.set(e,i);var T=qh(_(e),_(i),u,l,g,w);return w.delete(e),T;case Er:if(Bn)return Bn.call(e)==Bn.call(i)}return!1}function Ey(e,i,a,u,l,g){var w=a&F,_=rc(e),x=_.length,$=rc(i),T=$.length;if(x!=T&&!w)return!1;for(var q=x;q--;){var L=_[q];if(!(w?L in i:Pe.call(i,L)))return!1}var J=g.get(e),te=g.get(i);if(J&&te)return J==i&&te==e;var fe=!0;g.set(e,i),g.set(i,e);for(var re=w;++q<x;){L=_[q];var ye=e[L],we=i[L];if(u)var qt=w?u(we,ye,L,i,e,g):u(ye,we,L,e,i,g);if(!(qt===r?ye===we||l(ye,we,a,u,g):qt)){fe=!1;break}re||(re=L=="constructor")}if(fe&&!re){var dt=e.constructor,jt=i.constructor;dt!=jt&&"constructor"in e&&"constructor"in i&&!(typeof dt=="function"&&dt instanceof dt&&typeof jt=="function"&&jt instanceof jt)&&(fe=!1)}return g.delete(e),g.delete(i),fe}function Cr(e){return hc(Hh(e,r,Zh),e+"")}function rc(e){return ih(e,Ye,oc)}function ic(e){return ih(e,bt,jh)}var nc=Ys?function(e){return Ys.get(e)}:Ic;function lo(e){for(var i=e.name+"",a=rn[i],u=Pe.call(rn,i)?a.length:0;u--;){var l=a[u],g=l.func;if(g==null||g==e)return l.name}return i}function an(e){var i=Pe.call(d,"placeholder")?d:e;return i.placeholder}function ee(){var e=d.iteratee||_c;return e=e===_c?oh:e,arguments.length?e(arguments[0],arguments[1]):e}function fo(e,i){var a=e.__data__;return Ry(i)?a[typeof i=="string"?"string":"hash"]:a.map}function sc(e){for(var i=Ye(e),a=i.length;a--;){var u=i[a],l=e[u];i[a]=[u,l,Uh(l)]}return i}function Ii(e,i){var a=Td(e,i);return sh(a)?a:r}function Iy(e){var i=Pe.call(e,mi),a=e[mi];try{e[mi]=r;var u=!0}catch{}var l=Hs.call(e);return u&&(i?e[mi]=a:delete e[mi]),l}var oc=Ta?function(e){return e==null?[]:(e=Oe(e),Wr(Ta(e),function(i){return ku.call(e,i)}))}:Pc,jh=Ta?function(e){for(var i=[];e;)Jr(i,oc(e)),e=Ks(e);return i}:Pc,at=ft;(Na&&at(new Na(new ArrayBuffer(1)))!=Mt||Tn&&at(new Tn)!=et||Da&&at(Da.resolve())!=Ti||tn&&at(new tn)!=tt||Nn&&at(new Nn)!=fr)&&(at=function(e){var i=ft(e),a=i==$t?e.constructor:r,u=a?Pi(a):"";if(u)switch(u){case sg:return Mt;case og:return et;case ag:return Ti;case cg:return tt;case ug:return fr}return i});function Py(e,i,a){for(var u=-1,l=a.length;++u<l;){var g=a[u],w=g.size;switch(g.type){case"drop":e+=w;break;case"dropRight":i-=w;break;case"take":i=ot(i,e+w);break;case"takeRight":e=We(e,i-w);break}}return{start:e,end:i}}function xy(e){var i=e.match(Pr);return i?i[1].split(ea):[]}function zh(e,i,a){i=ei(i,e);for(var u=-1,l=i.length,g=!1;++u<l;){var w=vr(i[u]);if(!(g=e!=null&&a(e,w)))break;e=e[w]}return g||++u!=l?g:(l=e==null?0:e.length,!!l&&bo(l)&&$r(w,l)&&(ce(e)||xi(e)))}function Sy(e){var i=e.length,a=new e.constructor(i);return i&&typeof e[0]=="string"&&Pe.call(e,"index")&&(a.index=e.index,a.input=e.input),a}function Lh(e){return typeof e.constructor=="function"&&!Hn(e)?nn(Ks(e)):{}}function Ay(e,i,a){var u=e.constructor;switch(i){case Ut:return Xa(e);case Ce:case ze:return new u(+e);case Mt:return hy(e,a);case Vr:case st:case qi:case ji:case bn:case zi:case Kr:case Li:case Ui:return Eh(e,a);case et:return new u;case _r:case lr:return new u(e);case hr:return ly(e);case tt:return new u;case Er:return fy(e)}}function Fy(e,i){var a=i.length;if(!a)return e;var u=a-1;return i[u]=(a>1?"& ":"")+i[u],i=i.join(a>2?", ":" "),e.replace(Sn,`{
/* [wrapped with `+i+`] */
`)}function Oy(e){return ce(e)||xi(e)||!!(Vu&&e&&e[Vu])}function $r(e,i){var a=typeof e;return i=i??z,!!i&&(a=="number"||a!="symbol"&&ua.test(e))&&e>-1&&e%1==0&&e<i}function pt(e,i,a){if(!Be(a))return!1;var u=typeof i;return(u=="number"?wt(a)&&$r(i,a.length):u=="string"&&i in a)?sr(a[i],e):!1}function ac(e,i){if(ce(e))return!1;var a=typeof e;return a=="number"||a=="symbol"||a=="boolean"||e==null||Bt(e)?!0:Yo.test(e)||!fi.test(e)||i!=null&&e in Oe(i)}function Ry(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function cc(e){var i=lo(e),a=d[i];if(typeof a!="function"||!(i in ve.prototype))return!1;if(e===a)return!0;var u=nc(a);return!!u&&e===u[0]}function Cy(e){return!!Uu&&Uu in e}var $y=Us?Tr:xc;function Hn(e){var i=e&&e.constructor,a=typeof i=="function"&&i.prototype||en;return e===a}function Uh(e){return e===e&&!Be(e)}function Mh(e,i){return function(a){return a==null?!1:a[e]===i&&(i!==r||e in Oe(a))}}function Ty(e){var i=mo(e,function(u){return a.size===y&&a.clear(),u}),a=i.cache;return i}function Ny(e,i){var a=e[1],u=i[1],l=a|u,g=l<(G|H|ie),w=u==ie&&a==B||u==ie&&a==ue&&e[7].length<=i[8]||u==(ie|ue)&&i[7].length<=i[8]&&a==B;if(!(g||w))return e;u&G&&(e[2]=i[2],l|=a&G?0:Z);var _=i[3];if(_){var x=e[3];e[3]=x?Ph(x,_,i[4]):_,e[4]=x?Qr(e[3],v):i[4]}return _=i[5],_&&(x=e[5],e[5]=x?xh(x,_,i[6]):_,e[6]=x?Qr(e[5],v):i[6]),_=i[7],_&&(e[7]=_),u&ie&&(e[8]=e[8]==null?i[8]:ot(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=l,e}function Dy(e){var i=[];if(e!=null)for(var a in Oe(e))i.push(a);return i}function By(e){return Hs.call(e)}function Hh(e,i,a){return i=We(i===r?e.length-1:i,0),function(){for(var u=arguments,l=-1,g=We(u.length-i,0),w=R(g);++l<g;)w[l]=u[i+l];l=-1;for(var _=R(i+1);++l<i;)_[l]=u[l];return _[i]=a(w),Qe(e,this,_)}}function kh(e,i){return i.length<2?e:Ei(e,Jt(i,0,-1))}function qy(e,i){for(var a=e.length,u=ot(i.length,a),l=mt(e);u--;){var g=i[u];e[u]=$r(g,a)?l[g]:r}return e}function uc(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var Vh=Gh(dh),kn=Zd||function(e,i){return me.setTimeout(e,i)},hc=Gh(oy);function Kh(e,i,a){var u=i+"";return hc(e,Fy(u,jy(xy(u),a)))}function Gh(e){var i=0,a=0;return function(){var u=rg(),l=er-(u-a);if(a=u,l>0){if(++i>=Re)return arguments[0]}else i=0;return e.apply(r,arguments)}}function po(e,i){var a=-1,u=e.length,l=u-1;for(i=i===r?u:i;++a<i;){var g=Ka(a,l),w=e[g];e[g]=e[a],e[a]=w}return e.length=i,e}var Wh=Ty(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(Zo,function(a,u,l,g){i.push(l?g.replace(ia,"$1"):u||a)}),i});function vr(e){if(typeof e=="string"||Bt(e))return e;var i=e+"";return i=="0"&&1/e==-j?"-0":i}function Pi(e){if(e!=null){try{return Ms.call(e)}catch{}try{return e+""}catch{}}return""}function jy(e,i){return Vt(se,function(a){var u="_."+a[0];i&a[1]&&!qs(e,u)&&e.push(u)}),e.sort()}function Jh(e){if(e instanceof ve)return e.clone();var i=new Gt(e.__wrapped__,e.__chain__);return i.__actions__=mt(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function zy(e,i,a){(a?pt(e,i,a):i===r)?i=1:i=We(le(i),0);var u=e==null?0:e.length;if(!u||i<1)return[];for(var l=0,g=0,w=R(Js(u/i));l<u;)w[g++]=Jt(e,l,l+=i);return w}function Ly(e){for(var i=-1,a=e==null?0:e.length,u=0,l=[];++i<a;){var g=e[i];g&&(l[u++]=g)}return l}function Uy(){var e=arguments.length;if(!e)return[];for(var i=R(e-1),a=arguments[0],u=e;u--;)i[u-1]=arguments[u];return Jr(ce(a)?mt(a):[a],rt(i,1))}var My=ge(function(e,i){return Ue(e)?jn(e,rt(i,1,Ue,!0)):[]}),Hy=ge(function(e,i){var a=Qt(i);return Ue(a)&&(a=r),Ue(e)?jn(e,rt(i,1,Ue,!0),ee(a,2)):[]}),ky=ge(function(e,i){var a=Qt(i);return Ue(a)&&(a=r),Ue(e)?jn(e,rt(i,1,Ue,!0),r,a):[]});function Vy(e,i,a){var u=e==null?0:e.length;return u?(i=a||i===r?1:le(i),Jt(e,i<0?0:i,u)):[]}function Ky(e,i,a){var u=e==null?0:e.length;return u?(i=a||i===r?1:le(i),i=u-i,Jt(e,0,i<0?0:i)):[]}function Gy(e,i){return e&&e.length?so(e,ee(i,3),!0,!0):[]}function Wy(e,i){return e&&e.length?so(e,ee(i,3),!0):[]}function Jy(e,i,a,u){var l=e==null?0:e.length;return l?(a&&typeof a!="number"&&pt(e,i,a)&&(a=0,u=l),Ug(e,i,a,u)):[]}function Qh(e,i,a){var u=e==null?0:e.length;if(!u)return-1;var l=a==null?0:le(a);return l<0&&(l=We(u+l,0)),js(e,ee(i,3),l)}function Yh(e,i,a){var u=e==null?0:e.length;if(!u)return-1;var l=u-1;return a!==r&&(l=le(a),l=a<0?We(u+l,0):ot(l,u-1)),js(e,ee(i,3),l,!0)}function Zh(e){var i=e==null?0:e.length;return i?rt(e,1):[]}function Qy(e){var i=e==null?0:e.length;return i?rt(e,j):[]}function Yy(e,i){var a=e==null?0:e.length;return a?(i=i===r?1:le(i),rt(e,i)):[]}function Zy(e){for(var i=-1,a=e==null?0:e.length,u={};++i<a;){var l=e[i];u[l[0]]=l[1]}return u}function Xh(e){return e&&e.length?e[0]:r}function Xy(e,i,a){var u=e==null?0:e.length;if(!u)return-1;var l=a==null?0:le(a);return l<0&&(l=We(u+l,0)),Qi(e,i,l)}function ev(e){var i=e==null?0:e.length;return i?Jt(e,0,-1):[]}var tv=ge(function(e){var i=Ne(e,Ya);return i.length&&i[0]===e[0]?Ua(i):[]}),rv=ge(function(e){var i=Qt(e),a=Ne(e,Ya);return i===Qt(a)?i=r:a.pop(),a.length&&a[0]===e[0]?Ua(a,ee(i,2)):[]}),iv=ge(function(e){var i=Qt(e),a=Ne(e,Ya);return i=typeof i=="function"?i:r,i&&a.pop(),a.length&&a[0]===e[0]?Ua(a,r,i):[]});function nv(e,i){return e==null?"":eg.call(e,i)}function Qt(e){var i=e==null?0:e.length;return i?e[i-1]:r}function sv(e,i,a){var u=e==null?0:e.length;if(!u)return-1;var l=u;return a!==r&&(l=le(a),l=l<0?We(u+l,0):ot(l,u-1)),i===i?jd(e,i,l):js(e,Tu,l,!0)}function ov(e,i){return e&&e.length?hh(e,le(i)):r}var av=ge(el);function el(e,i){return e&&e.length&&i&&i.length?Va(e,i):e}function cv(e,i,a){return e&&e.length&&i&&i.length?Va(e,i,ee(a,2)):e}function uv(e,i,a){return e&&e.length&&i&&i.length?Va(e,i,r,a):e}var hv=Cr(function(e,i){var a=e==null?0:e.length,u=qa(e,i);return ph(e,Ne(i,function(l){return $r(l,a)?+l:l}).sort(Ih)),u});function lv(e,i){var a=[];if(!(e&&e.length))return a;var u=-1,l=[],g=e.length;for(i=ee(i,3);++u<g;){var w=e[u];i(w,u,e)&&(a.push(w),l.push(u))}return ph(e,l),a}function lc(e){return e==null?e:ng.call(e)}function fv(e,i,a){var u=e==null?0:e.length;return u?(a&&typeof a!="number"&&pt(e,i,a)?(i=0,a=u):(i=i==null?0:le(i),a=a===r?u:le(a)),Jt(e,i,a)):[]}function pv(e,i){return no(e,i)}function dv(e,i,a){return Wa(e,i,ee(a,2))}function gv(e,i){var a=e==null?0:e.length;if(a){var u=no(e,i);if(u<a&&sr(e[u],i))return u}return-1}function yv(e,i){return no(e,i,!0)}function vv(e,i,a){return Wa(e,i,ee(a,2),!0)}function mv(e,i){var a=e==null?0:e.length;if(a){var u=no(e,i,!0)-1;if(sr(e[u],i))return u}return-1}function wv(e){return e&&e.length?gh(e):[]}function bv(e,i){return e&&e.length?gh(e,ee(i,2)):[]}function _v(e){var i=e==null?0:e.length;return i?Jt(e,1,i):[]}function Ev(e,i,a){return e&&e.length?(i=a||i===r?1:le(i),Jt(e,0,i<0?0:i)):[]}function Iv(e,i,a){var u=e==null?0:e.length;return u?(i=a||i===r?1:le(i),i=u-i,Jt(e,i<0?0:i,u)):[]}function Pv(e,i){return e&&e.length?so(e,ee(i,3),!1,!0):[]}function xv(e,i){return e&&e.length?so(e,ee(i,3)):[]}var Sv=ge(function(e){return Xr(rt(e,1,Ue,!0))}),Av=ge(function(e){var i=Qt(e);return Ue(i)&&(i=r),Xr(rt(e,1,Ue,!0),ee(i,2))}),Fv=ge(function(e){var i=Qt(e);return i=typeof i=="function"?i:r,Xr(rt(e,1,Ue,!0),r,i)});function Ov(e){return e&&e.length?Xr(e):[]}function Rv(e,i){return e&&e.length?Xr(e,ee(i,2)):[]}function Cv(e,i){return i=typeof i=="function"?i:r,e&&e.length?Xr(e,r,i):[]}function fc(e){if(!(e&&e.length))return[];var i=0;return e=Wr(e,function(a){if(Ue(a))return i=We(a.length,i),!0}),Oa(i,function(a){return Ne(e,Sa(a))})}function tl(e,i){if(!(e&&e.length))return[];var a=fc(e);return i==null?a:Ne(a,function(u){return Qe(i,r,u)})}var $v=ge(function(e,i){return Ue(e)?jn(e,i):[]}),Tv=ge(function(e){return Qa(Wr(e,Ue))}),Nv=ge(function(e){var i=Qt(e);return Ue(i)&&(i=r),Qa(Wr(e,Ue),ee(i,2))}),Dv=ge(function(e){var i=Qt(e);return i=typeof i=="function"?i:r,Qa(Wr(e,Ue),r,i)}),Bv=ge(fc);function qv(e,i){return wh(e||[],i||[],qn)}function jv(e,i){return wh(e||[],i||[],Un)}var zv=ge(function(e){var i=e.length,a=i>1?e[i-1]:r;return a=typeof a=="function"?(e.pop(),a):r,tl(e,a)});function rl(e){var i=d(e);return i.__chain__=!0,i}function Lv(e,i){return i(e),e}function go(e,i){return i(e)}var Uv=Cr(function(e){var i=e.length,a=i?e[0]:0,u=this.__wrapped__,l=function(g){return qa(g,e)};return i>1||this.__actions__.length||!(u instanceof ve)||!$r(a)?this.thru(l):(u=u.slice(a,+a+(i?1:0)),u.__actions__.push({func:go,args:[l],thisArg:r}),new Gt(u,this.__chain__).thru(function(g){return i&&!g.length&&g.push(r),g}))});function Mv(){return rl(this)}function Hv(){return new Gt(this.value(),this.__chain__)}function kv(){this.__values__===r&&(this.__values__=yl(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function Vv(){return this}function Kv(e){for(var i,a=this;a instanceof Xs;){var u=Jh(a);u.__index__=0,u.__values__=r,i?l.__wrapped__=u:i=u;var l=u;a=a.__wrapped__}return l.__wrapped__=e,i}function Gv(){var e=this.__wrapped__;if(e instanceof ve){var i=e;return this.__actions__.length&&(i=new ve(this)),i=i.reverse(),i.__actions__.push({func:go,args:[lc],thisArg:r}),new Gt(i,this.__chain__)}return this.thru(lc)}function Wv(){return mh(this.__wrapped__,this.__actions__)}var Jv=oo(function(e,i,a){Pe.call(e,a)?++e[a]:Or(e,a,1)});function Qv(e,i,a){var u=ce(e)?Cu:Lg;return a&&pt(e,i,a)&&(i=r),u(e,ee(i,3))}function Yv(e,i){var a=ce(e)?Wr:th;return a(e,ee(i,3))}var Zv=Oh(Qh),Xv=Oh(Yh);function em(e,i){return rt(yo(e,i),1)}function tm(e,i){return rt(yo(e,i),j)}function rm(e,i,a){return a=a===r?1:le(a),rt(yo(e,i),a)}function il(e,i){var a=ce(e)?Vt:Zr;return a(e,ee(i,3))}function nl(e,i){var a=ce(e)?_d:eh;return a(e,ee(i,3))}var im=oo(function(e,i,a){Pe.call(e,a)?e[a].push(i):Or(e,a,[i])});function nm(e,i,a,u){e=wt(e)?e:un(e),a=a&&!u?le(a):0;var l=e.length;return a<0&&(a=We(l+a,0)),_o(e)?a<=l&&e.indexOf(i,a)>-1:!!l&&Qi(e,i,a)>-1}var sm=ge(function(e,i,a){var u=-1,l=typeof i=="function",g=wt(e)?R(e.length):[];return Zr(e,function(w){g[++u]=l?Qe(i,w,a):zn(w,i,a)}),g}),om=oo(function(e,i,a){Or(e,a,i)});function yo(e,i){var a=ce(e)?Ne:ah;return a(e,ee(i,3))}function am(e,i,a,u){return e==null?[]:(ce(i)||(i=i==null?[]:[i]),a=u?r:a,ce(a)||(a=a==null?[]:[a]),lh(e,i,a))}var cm=oo(function(e,i,a){e[a?0:1].push(i)},function(){return[[],[]]});function um(e,i,a){var u=ce(e)?Pa:Du,l=arguments.length<3;return u(e,ee(i,4),a,l,Zr)}function hm(e,i,a){var u=ce(e)?Ed:Du,l=arguments.length<3;return u(e,ee(i,4),a,l,eh)}function lm(e,i){var a=ce(e)?Wr:th;return a(e,wo(ee(i,3)))}function fm(e){var i=ce(e)?Qu:ny;return i(e)}function pm(e,i,a){(a?pt(e,i,a):i===r)?i=1:i=le(i);var u=ce(e)?Dg:sy;return u(e,i)}function dm(e){var i=ce(e)?Bg:ay;return i(e)}function gm(e){if(e==null)return 0;if(wt(e))return _o(e)?Zi(e):e.length;var i=at(e);return i==et||i==tt?e.size:Ha(e).length}function ym(e,i,a){var u=ce(e)?xa:cy;return a&&pt(e,i,a)&&(i=r),u(e,ee(i,3))}var vm=ge(function(e,i){if(e==null)return[];var a=i.length;return a>1&&pt(e,i[0],i[1])?i=[]:a>2&&pt(i[0],i[1],i[2])&&(i=[i[0]]),lh(e,rt(i,1),[])}),vo=Yd||function(){return me.Date.now()};function mm(e,i){if(typeof i!="function")throw new Kt(h);return e=le(e),function(){if(--e<1)return i.apply(this,arguments)}}function sl(e,i,a){return i=a?r:i,i=e&&i==null?e.length:i,Rr(e,ie,r,r,r,r,i)}function ol(e,i){var a;if(typeof i!="function")throw new Kt(h);return e=le(e),function(){return--e>0&&(a=i.apply(this,arguments)),e<=1&&(i=r),a}}var pc=ge(function(e,i,a){var u=G;if(a.length){var l=Qr(a,an(pc));u|=Y}return Rr(e,u,i,a,l)}),al=ge(function(e,i,a){var u=G|H;if(a.length){var l=Qr(a,an(al));u|=Y}return Rr(i,u,e,a,l)});function cl(e,i,a){i=a?r:i;var u=Rr(e,B,r,r,r,r,r,i);return u.placeholder=cl.placeholder,u}function ul(e,i,a){i=a?r:i;var u=Rr(e,U,r,r,r,r,r,i);return u.placeholder=ul.placeholder,u}function hl(e,i,a){var u,l,g,w,_,x,$=0,T=!1,q=!1,L=!0;if(typeof e!="function")throw new Kt(h);i=Yt(i)||0,Be(a)&&(T=!!a.leading,q="maxWait"in a,g=q?We(Yt(a.maxWait)||0,i):g,L="trailing"in a?!!a.trailing:L);function J(Me){var or=u,Dr=l;return u=l=r,$=Me,w=e.apply(Dr,or),w}function te(Me){return $=Me,_=kn(ye,i),T?J(Me):w}function fe(Me){var or=Me-x,Dr=Me-$,Ol=i-or;return q?ot(Ol,g-Dr):Ol}function re(Me){var or=Me-x,Dr=Me-$;return x===r||or>=i||or<0||q&&Dr>=g}function ye(){var Me=vo();if(re(Me))return we(Me);_=kn(ye,fe(Me))}function we(Me){return _=r,L&&u?J(Me):(u=l=r,w)}function qt(){_!==r&&bh(_),$=0,u=x=l=_=r}function dt(){return _===r?w:we(vo())}function jt(){var Me=vo(),or=re(Me);if(u=arguments,l=this,x=Me,or){if(_===r)return te(x);if(q)return bh(_),_=kn(ye,i),J(x)}return _===r&&(_=kn(ye,i)),w}return jt.cancel=qt,jt.flush=dt,jt}var wm=ge(function(e,i){return Xu(e,1,i)}),bm=ge(function(e,i,a){return Xu(e,Yt(i)||0,a)});function _m(e){return Rr(e,de)}function mo(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new Kt(h);var a=function(){var u=arguments,l=i?i.apply(this,u):u[0],g=a.cache;if(g.has(l))return g.get(l);var w=e.apply(this,u);return a.cache=g.set(l,w)||g,w};return a.cache=new(mo.Cache||Fr),a}mo.Cache=Fr;function wo(e){if(typeof e!="function")throw new Kt(h);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function Em(e){return ol(2,e)}var Im=uy(function(e,i){i=i.length==1&&ce(i[0])?Ne(i[0],Nt(ee())):Ne(rt(i,1),Nt(ee()));var a=i.length;return ge(function(u){for(var l=-1,g=ot(u.length,a);++l<g;)u[l]=i[l].call(this,u[l]);return Qe(e,this,u)})}),dc=ge(function(e,i){var a=Qr(i,an(dc));return Rr(e,Y,r,i,a)}),ll=ge(function(e,i){var a=Qr(i,an(ll));return Rr(e,he,r,i,a)}),Pm=Cr(function(e,i){return Rr(e,ue,r,r,r,i)});function xm(e,i){if(typeof e!="function")throw new Kt(h);return i=i===r?i:le(i),ge(e,i)}function Sm(e,i){if(typeof e!="function")throw new Kt(h);return i=i==null?0:We(le(i),0),ge(function(a){var u=a[i],l=ti(a,0,i);return u&&Jr(l,u),Qe(e,this,l)})}function Am(e,i,a){var u=!0,l=!0;if(typeof e!="function")throw new Kt(h);return Be(a)&&(u="leading"in a?!!a.leading:u,l="trailing"in a?!!a.trailing:l),hl(e,i,{leading:u,maxWait:i,trailing:l})}function Fm(e){return sl(e,1)}function Om(e,i){return dc(Za(i),e)}function Rm(){if(!arguments.length)return[];var e=arguments[0];return ce(e)?e:[e]}function Cm(e){return Wt(e,O)}function $m(e,i){return i=typeof i=="function"?i:r,Wt(e,O,i)}function Tm(e){return Wt(e,b|O)}function Nm(e,i){return i=typeof i=="function"?i:r,Wt(e,b|O,i)}function Dm(e,i){return i==null||Zu(e,i,Ye(i))}function sr(e,i){return e===i||e!==e&&i!==i}var Bm=ho(La),qm=ho(function(e,i){return e>=i}),xi=nh(function(){return arguments}())?nh:function(e){return je(e)&&Pe.call(e,"callee")&&!ku.call(e,"callee")},ce=R.isArray,jm=lt?Nt(lt):Kg;function wt(e){return e!=null&&bo(e.length)&&!Tr(e)}function Ue(e){return je(e)&&wt(e)}function zm(e){return e===!0||e===!1||je(e)&&ft(e)==Ce}var ri=Xd||xc,Lm=rr?Nt(rr):Gg;function Um(e){return je(e)&&e.nodeType===1&&!Vn(e)}function Mm(e){if(e==null)return!0;if(wt(e)&&(ce(e)||typeof e=="string"||typeof e.splice=="function"||ri(e)||cn(e)||xi(e)))return!e.length;var i=at(e);if(i==et||i==tt)return!e.size;if(Hn(e))return!Ha(e).length;for(var a in e)if(Pe.call(e,a))return!1;return!0}function Hm(e,i){return Ln(e,i)}function km(e,i,a){a=typeof a=="function"?a:r;var u=a?a(e,i):r;return u===r?Ln(e,i,r,a):!!u}function gc(e){if(!je(e))return!1;var i=ft(e);return i==ht||i==Rt||typeof e.message=="string"&&typeof e.name=="string"&&!Vn(e)}function Vm(e){return typeof e=="number"&&Ku(e)}function Tr(e){if(!Be(e))return!1;var i=ft(e);return i==Ct||i==kr||i==Ot||i==Ni}function fl(e){return typeof e=="number"&&e==le(e)}function bo(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=z}function Be(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function je(e){return e!=null&&typeof e=="object"}var pl=kt?Nt(kt):Jg;function Km(e,i){return e===i||Ma(e,i,sc(i))}function Gm(e,i,a){return a=typeof a=="function"?a:r,Ma(e,i,sc(i),a)}function Wm(e){return dl(e)&&e!=+e}function Jm(e){if($y(e))throw new oe(c);return sh(e)}function Qm(e){return e===null}function Ym(e){return e==null}function dl(e){return typeof e=="number"||je(e)&&ft(e)==_r}function Vn(e){if(!je(e)||ft(e)!=$t)return!1;var i=Ks(e);if(i===null)return!0;var a=Pe.call(i,"constructor")&&i.constructor;return typeof a=="function"&&a instanceof a&&Ms.call(a)==Gd}var yc=dr?Nt(dr):Qg;function Zm(e){return fl(e)&&e>=-z&&e<=z}var gl=Rn?Nt(Rn):Yg;function _o(e){return typeof e=="string"||!ce(e)&&je(e)&&ft(e)==lr}function Bt(e){return typeof e=="symbol"||je(e)&&ft(e)==Er}var cn=vi?Nt(vi):Zg;function Xm(e){return e===r}function e1(e){return je(e)&&at(e)==fr}function t1(e){return je(e)&&ft(e)==Bi}var r1=ho(ka),i1=ho(function(e,i){return e<=i});function yl(e){if(!e)return[];if(wt(e))return _o(e)?ir(e):mt(e);if($n&&e[$n])return Dd(e[$n]());var i=at(e),a=i==et?Ca:i==tt?zs:un;return a(e)}function Nr(e){if(!e)return e===0?e:0;if(e=Yt(e),e===j||e===-j){var i=e<0?-1:1;return i*W}return e===e?e:0}function le(e){var i=Nr(e),a=i%1;return i===i?a?i-a:i:0}function vl(e){return e?_i(le(e),0,ne):0}function Yt(e){if(typeof e=="number")return e;if(Bt(e))return M;if(Be(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=Be(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=Bu(e);var a=oa.test(e);return a||ca.test(e)?ae(e.slice(2),a?2:8):sa.test(e)?M:+e}function ml(e){return yr(e,bt(e))}function n1(e){return e?_i(le(e),-z,z):e===0?e:0}function Ie(e){return e==null?"":Dt(e)}var s1=sn(function(e,i){if(Hn(i)||wt(i)){yr(i,Ye(i),e);return}for(var a in i)Pe.call(i,a)&&qn(e,a,i[a])}),wl=sn(function(e,i){yr(i,bt(i),e)}),Eo=sn(function(e,i,a,u){yr(i,bt(i),e,u)}),o1=sn(function(e,i,a,u){yr(i,Ye(i),e,u)}),a1=Cr(qa);function c1(e,i){var a=nn(e);return i==null?a:Yu(a,i)}var u1=ge(function(e,i){e=Oe(e);var a=-1,u=i.length,l=u>2?i[2]:r;for(l&&pt(i[0],i[1],l)&&(u=1);++a<u;)for(var g=i[a],w=bt(g),_=-1,x=w.length;++_<x;){var $=w[_],T=e[$];(T===r||sr(T,en[$])&&!Pe.call(e,$))&&(e[$]=g[$])}return e}),h1=ge(function(e){return e.push(r,Bh),Qe(bl,r,e)});function l1(e,i){return $u(e,ee(i,3),gr)}function f1(e,i){return $u(e,ee(i,3),za)}function p1(e,i){return e==null?e:ja(e,ee(i,3),bt)}function d1(e,i){return e==null?e:rh(e,ee(i,3),bt)}function g1(e,i){return e&&gr(e,ee(i,3))}function y1(e,i){return e&&za(e,ee(i,3))}function v1(e){return e==null?[]:ro(e,Ye(e))}function m1(e){return e==null?[]:ro(e,bt(e))}function vc(e,i,a){var u=e==null?r:Ei(e,i);return u===r?a:u}function w1(e,i){return e!=null&&zh(e,i,Mg)}function mc(e,i){return e!=null&&zh(e,i,Hg)}var b1=Ch(function(e,i,a){i!=null&&typeof i.toString!="function"&&(i=Hs.call(i)),e[i]=a},bc(_t)),_1=Ch(function(e,i,a){i!=null&&typeof i.toString!="function"&&(i=Hs.call(i)),Pe.call(e,i)?e[i].push(a):e[i]=[a]},ee),E1=ge(zn);function Ye(e){return wt(e)?Ju(e):Ha(e)}function bt(e){return wt(e)?Ju(e,!0):Xg(e)}function I1(e,i){var a={};return i=ee(i,3),gr(e,function(u,l,g){Or(a,i(u,l,g),u)}),a}function P1(e,i){var a={};return i=ee(i,3),gr(e,function(u,l,g){Or(a,l,i(u,l,g))}),a}var x1=sn(function(e,i,a){io(e,i,a)}),bl=sn(function(e,i,a,u){io(e,i,a,u)}),S1=Cr(function(e,i){var a={};if(e==null)return a;var u=!1;i=Ne(i,function(g){return g=ei(g,e),u||(u=g.length>1),g}),yr(e,ic(e),a),u&&(a=Wt(a,b|S|O,by));for(var l=i.length;l--;)Ja(a,i[l]);return a});function A1(e,i){return _l(e,wo(ee(i)))}var F1=Cr(function(e,i){return e==null?{}:ty(e,i)});function _l(e,i){if(e==null)return{};var a=Ne(ic(e),function(u){return[u]});return i=ee(i),fh(e,a,function(u,l){return i(u,l[0])})}function O1(e,i,a){i=ei(i,e);var u=-1,l=i.length;for(l||(l=1,e=r);++u<l;){var g=e==null?r:e[vr(i[u])];g===r&&(u=l,g=a),e=Tr(g)?g.call(e):g}return e}function R1(e,i,a){return e==null?e:Un(e,i,a)}function C1(e,i,a,u){return u=typeof u=="function"?u:r,e==null?e:Un(e,i,a,u)}var El=Nh(Ye),Il=Nh(bt);function $1(e,i,a){var u=ce(e),l=u||ri(e)||cn(e);if(i=ee(i,4),a==null){var g=e&&e.constructor;l?a=u?new g:[]:Be(e)?a=Tr(g)?nn(Ks(e)):{}:a={}}return(l?Vt:gr)(e,function(w,_,x){return i(a,w,_,x)}),a}function T1(e,i){return e==null?!0:Ja(e,i)}function N1(e,i,a){return e==null?e:vh(e,i,Za(a))}function D1(e,i,a,u){return u=typeof u=="function"?u:r,e==null?e:vh(e,i,Za(a),u)}function un(e){return e==null?[]:Ra(e,Ye(e))}function B1(e){return e==null?[]:Ra(e,bt(e))}function q1(e,i,a){return a===r&&(a=i,i=r),a!==r&&(a=Yt(a),a=a===a?a:0),i!==r&&(i=Yt(i),i=i===i?i:0),_i(Yt(e),i,a)}function j1(e,i,a){return i=Nr(i),a===r?(a=i,i=0):a=Nr(a),e=Yt(e),kg(e,i,a)}function z1(e,i,a){if(a&&typeof a!="boolean"&&pt(e,i,a)&&(i=a=r),a===r&&(typeof i=="boolean"?(a=i,i=r):typeof e=="boolean"&&(a=e,e=r)),e===r&&i===r?(e=0,i=1):(e=Nr(e),i===r?(i=e,e=0):i=Nr(i)),e>i){var u=e;e=i,i=u}if(a||e%1||i%1){var l=Gu();return ot(e+l*(i-e+Ae("1e-"+((l+"").length-1))),i)}return Ka(e,i)}var L1=on(function(e,i,a){return i=i.toLowerCase(),e+(a?Pl(i):i)});function Pl(e){return wc(Ie(e).toLowerCase())}function xl(e){return e=Ie(e),e&&e.replace(xr,Rd).replace(_a,"")}function U1(e,i,a){e=Ie(e),i=Dt(i);var u=e.length;a=a===r?u:_i(le(a),0,u);var l=a;return a-=i.length,a>=0&&e.slice(a,l)==i}function M1(e){return e=Ie(e),e&&li.test(e)?e.replace(ys,Cd):e}function H1(e){return e=Ie(e),e&&Xo.test(e)?e.replace(Pn,"\\$&"):e}var k1=on(function(e,i,a){return e+(a?"-":"")+i.toLowerCase()}),V1=on(function(e,i,a){return e+(a?" ":"")+i.toLowerCase()}),K1=Fh("toLowerCase");function G1(e,i,a){e=Ie(e),i=le(i);var u=i?Zi(e):0;if(!i||u>=i)return e;var l=(i-u)/2;return uo(Qs(l),a)+e+uo(Js(l),a)}function W1(e,i,a){e=Ie(e),i=le(i);var u=i?Zi(e):0;return i&&u<i?e+uo(i-u,a):e}function J1(e,i,a){e=Ie(e),i=le(i);var u=i?Zi(e):0;return i&&u<i?uo(i-u,a)+e:e}function Q1(e,i,a){return a||i==null?i=0:i&&(i=+i),ig(Ie(e).replace(xn,""),i||0)}function Y1(e,i,a){return(a?pt(e,i,a):i===r)?i=1:i=le(i),Ga(Ie(e),i)}function Z1(){var e=arguments,i=Ie(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var X1=on(function(e,i,a){return e+(a?"_":"")+i.toLowerCase()});function ew(e,i,a){return a&&typeof a!="number"&&pt(e,i,a)&&(i=a=r),a=a===r?ne:a>>>0,a?(e=Ie(e),e&&(typeof i=="string"||i!=null&&!yc(i))&&(i=Dt(i),!i&&Yi(e))?ti(ir(e),0,a):e.split(i,a)):[]}var tw=on(function(e,i,a){return e+(a?" ":"")+wc(i)});function rw(e,i,a){return e=Ie(e),a=a==null?0:_i(le(a),0,e.length),i=Dt(i),e.slice(a,a+i.length)==i}function iw(e,i,a){var u=d.templateSettings;a&&pt(e,i,a)&&(i=r),e=Ie(e),i=Eo({},i,u,Dh);var l=Eo({},i.imports,u.imports,Dh),g=Ye(l),w=Ra(l,g),_,x,$=0,T=i.interpolate||Hi,q="__p += '",L=$a((i.escape||Hi).source+"|"+T.source+"|"+(T===Mi?na:Hi).source+"|"+(i.evaluate||Hi).source+"|$","g"),J="//# sourceURL="+(Pe.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ea+"]")+`
`;e.replace(L,function(re,ye,we,qt,dt,jt){return we||(we=qt),q+=e.slice($,jt).replace(ha,$d),ye&&(_=!0,q+=`' +
__e(`+ye+`) +
'`),dt&&(x=!0,q+=`';
`+dt+`;
__p += '`),we&&(q+=`' +
((__t = (`+we+`)) == null ? '' : __t) +
'`),$=jt+re.length,re}),q+=`';
`;var te=Pe.call(i,"variable")&&i.variable;if(!te)q=`with (obj) {
`+q+`
}
`;else if(ra.test(te))throw new oe(p);q=(x?q.replace(Qo,""):q).replace(Ir,"$1").replace(ds,"$1;"),q="function("+(te||"obj")+`) {
`+(te?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(_?", __e = _.escape":"")+(x?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+q+`return __p
}`;var fe=Al(function(){return _e(g,J+"return "+q).apply(r,w)});if(fe.source=q,gc(fe))throw fe;return fe}function nw(e){return Ie(e).toLowerCase()}function sw(e){return Ie(e).toUpperCase()}function ow(e,i,a){if(e=Ie(e),e&&(a||i===r))return Bu(e);if(!e||!(i=Dt(i)))return e;var u=ir(e),l=ir(i),g=qu(u,l),w=ju(u,l)+1;return ti(u,g,w).join("")}function aw(e,i,a){if(e=Ie(e),e&&(a||i===r))return e.slice(0,Lu(e)+1);if(!e||!(i=Dt(i)))return e;var u=ir(e),l=ju(u,ir(i))+1;return ti(u,0,l).join("")}function cw(e,i,a){if(e=Ie(e),e&&(a||i===r))return e.replace(xn,"");if(!e||!(i=Dt(i)))return e;var u=ir(e),l=qu(u,ir(i));return ti(u,l).join("")}function uw(e,i){var a=gt,u=yt;if(Be(i)){var l="separator"in i?i.separator:l;a="length"in i?le(i.length):a,u="omission"in i?Dt(i.omission):u}e=Ie(e);var g=e.length;if(Yi(e)){var w=ir(e);g=w.length}if(a>=g)return e;var _=a-Zi(u);if(_<1)return u;var x=w?ti(w,0,_).join(""):e.slice(0,_);if(l===r)return x+u;if(w&&(_+=x.length-_),yc(l)){if(e.slice(_).search(l)){var $,T=x;for(l.global||(l=$a(l.source,Ie(Ht.exec(l))+"g")),l.lastIndex=0;$=l.exec(T);)var q=$.index;x=x.slice(0,q===r?_:q)}}else if(e.indexOf(Dt(l),_)!=_){var L=x.lastIndexOf(l);L>-1&&(x=x.slice(0,L))}return x+u}function hw(e){return e=Ie(e),e&&_n.test(e)?e.replace(gs,zd):e}var lw=on(function(e,i,a){return e+(a?" ":"")+i.toUpperCase()}),wc=Fh("toUpperCase");function Sl(e,i,a){return e=Ie(e),i=a?r:i,i===r?Nd(e)?Md(e):xd(e):e.match(i)||[]}var Al=ge(function(e,i){try{return Qe(e,r,i)}catch(a){return gc(a)?a:new oe(a)}}),fw=Cr(function(e,i){return Vt(i,function(a){a=vr(a),Or(e,a,pc(e[a],e))}),e});function pw(e){var i=e==null?0:e.length,a=ee();return e=i?Ne(e,function(u){if(typeof u[1]!="function")throw new Kt(h);return[a(u[0]),u[1]]}):[],ge(function(u){for(var l=-1;++l<i;){var g=e[l];if(Qe(g[0],this,u))return Qe(g[1],this,u)}})}function dw(e){return zg(Wt(e,b))}function bc(e){return function(){return e}}function gw(e,i){return e==null||e!==e?i:e}var yw=Rh(),vw=Rh(!0);function _t(e){return e}function _c(e){return oh(typeof e=="function"?e:Wt(e,b))}function mw(e){return ch(Wt(e,b))}function ww(e,i){return uh(e,Wt(i,b))}var bw=ge(function(e,i){return function(a){return zn(a,e,i)}}),_w=ge(function(e,i){return function(a){return zn(e,a,i)}});function Ec(e,i,a){var u=Ye(i),l=ro(i,u);a==null&&!(Be(i)&&(l.length||!u.length))&&(a=i,i=e,e=this,l=ro(i,Ye(i)));var g=!(Be(a)&&"chain"in a)||!!a.chain,w=Tr(e);return Vt(l,function(_){var x=i[_];e[_]=x,w&&(e.prototype[_]=function(){var $=this.__chain__;if(g||$){var T=e(this.__wrapped__),q=T.__actions__=mt(this.__actions__);return q.push({func:x,args:arguments,thisArg:e}),T.__chain__=$,T}return x.apply(e,Jr([this.value()],arguments))})}),e}function Ew(){return me._===this&&(me._=Wd),this}function Ic(){}function Iw(e){return e=le(e),ge(function(i){return hh(i,e)})}var Pw=ec(Ne),xw=ec(Cu),Sw=ec(xa);function Fl(e){return ac(e)?Sa(vr(e)):ry(e)}function Aw(e){return function(i){return e==null?r:Ei(e,i)}}var Fw=$h(),Ow=$h(!0);function Pc(){return[]}function xc(){return!1}function Rw(){return{}}function Cw(){return""}function $w(){return!0}function Tw(e,i){if(e=le(e),e<1||e>z)return[];var a=ne,u=ot(e,ne);i=ee(i),e-=ne;for(var l=Oa(u,i);++a<e;)i(a);return l}function Nw(e){return ce(e)?Ne(e,vr):Bt(e)?[e]:mt(Wh(Ie(e)))}function Dw(e){var i=++Kd;return Ie(e)+i}var Bw=co(function(e,i){return e+i},0),qw=tc("ceil"),jw=co(function(e,i){return e/i},1),zw=tc("floor");function Lw(e){return e&&e.length?to(e,_t,La):r}function Uw(e,i){return e&&e.length?to(e,ee(i,2),La):r}function Mw(e){return Nu(e,_t)}function Hw(e,i){return Nu(e,ee(i,2))}function kw(e){return e&&e.length?to(e,_t,ka):r}function Vw(e,i){return e&&e.length?to(e,ee(i,2),ka):r}var Kw=co(function(e,i){return e*i},1),Gw=tc("round"),Ww=co(function(e,i){return e-i},0);function Jw(e){return e&&e.length?Fa(e,_t):0}function Qw(e,i){return e&&e.length?Fa(e,ee(i,2)):0}return d.after=mm,d.ary=sl,d.assign=s1,d.assignIn=wl,d.assignInWith=Eo,d.assignWith=o1,d.at=a1,d.before=ol,d.bind=pc,d.bindAll=fw,d.bindKey=al,d.castArray=Rm,d.chain=rl,d.chunk=zy,d.compact=Ly,d.concat=Uy,d.cond=pw,d.conforms=dw,d.constant=bc,d.countBy=Jv,d.create=c1,d.curry=cl,d.curryRight=ul,d.debounce=hl,d.defaults=u1,d.defaultsDeep=h1,d.defer=wm,d.delay=bm,d.difference=My,d.differenceBy=Hy,d.differenceWith=ky,d.drop=Vy,d.dropRight=Ky,d.dropRightWhile=Gy,d.dropWhile=Wy,d.fill=Jy,d.filter=Yv,d.flatMap=em,d.flatMapDeep=tm,d.flatMapDepth=rm,d.flatten=Zh,d.flattenDeep=Qy,d.flattenDepth=Yy,d.flip=_m,d.flow=yw,d.flowRight=vw,d.fromPairs=Zy,d.functions=v1,d.functionsIn=m1,d.groupBy=im,d.initial=ev,d.intersection=tv,d.intersectionBy=rv,d.intersectionWith=iv,d.invert=b1,d.invertBy=_1,d.invokeMap=sm,d.iteratee=_c,d.keyBy=om,d.keys=Ye,d.keysIn=bt,d.map=yo,d.mapKeys=I1,d.mapValues=P1,d.matches=mw,d.matchesProperty=ww,d.memoize=mo,d.merge=x1,d.mergeWith=bl,d.method=bw,d.methodOf=_w,d.mixin=Ec,d.negate=wo,d.nthArg=Iw,d.omit=S1,d.omitBy=A1,d.once=Em,d.orderBy=am,d.over=Pw,d.overArgs=Im,d.overEvery=xw,d.overSome=Sw,d.partial=dc,d.partialRight=ll,d.partition=cm,d.pick=F1,d.pickBy=_l,d.property=Fl,d.propertyOf=Aw,d.pull=av,d.pullAll=el,d.pullAllBy=cv,d.pullAllWith=uv,d.pullAt=hv,d.range=Fw,d.rangeRight=Ow,d.rearg=Pm,d.reject=lm,d.remove=lv,d.rest=xm,d.reverse=lc,d.sampleSize=pm,d.set=R1,d.setWith=C1,d.shuffle=dm,d.slice=fv,d.sortBy=vm,d.sortedUniq=wv,d.sortedUniqBy=bv,d.split=ew,d.spread=Sm,d.tail=_v,d.take=Ev,d.takeRight=Iv,d.takeRightWhile=Pv,d.takeWhile=xv,d.tap=Lv,d.throttle=Am,d.thru=go,d.toArray=yl,d.toPairs=El,d.toPairsIn=Il,d.toPath=Nw,d.toPlainObject=ml,d.transform=$1,d.unary=Fm,d.union=Sv,d.unionBy=Av,d.unionWith=Fv,d.uniq=Ov,d.uniqBy=Rv,d.uniqWith=Cv,d.unset=T1,d.unzip=fc,d.unzipWith=tl,d.update=N1,d.updateWith=D1,d.values=un,d.valuesIn=B1,d.without=$v,d.words=Sl,d.wrap=Om,d.xor=Tv,d.xorBy=Nv,d.xorWith=Dv,d.zip=Bv,d.zipObject=qv,d.zipObjectDeep=jv,d.zipWith=zv,d.entries=El,d.entriesIn=Il,d.extend=wl,d.extendWith=Eo,Ec(d,d),d.add=Bw,d.attempt=Al,d.camelCase=L1,d.capitalize=Pl,d.ceil=qw,d.clamp=q1,d.clone=Cm,d.cloneDeep=Tm,d.cloneDeepWith=Nm,d.cloneWith=$m,d.conformsTo=Dm,d.deburr=xl,d.defaultTo=gw,d.divide=jw,d.endsWith=U1,d.eq=sr,d.escape=M1,d.escapeRegExp=H1,d.every=Qv,d.find=Zv,d.findIndex=Qh,d.findKey=l1,d.findLast=Xv,d.findLastIndex=Yh,d.findLastKey=f1,d.floor=zw,d.forEach=il,d.forEachRight=nl,d.forIn=p1,d.forInRight=d1,d.forOwn=g1,d.forOwnRight=y1,d.get=vc,d.gt=Bm,d.gte=qm,d.has=w1,d.hasIn=mc,d.head=Xh,d.identity=_t,d.includes=nm,d.indexOf=Xy,d.inRange=j1,d.invoke=E1,d.isArguments=xi,d.isArray=ce,d.isArrayBuffer=jm,d.isArrayLike=wt,d.isArrayLikeObject=Ue,d.isBoolean=zm,d.isBuffer=ri,d.isDate=Lm,d.isElement=Um,d.isEmpty=Mm,d.isEqual=Hm,d.isEqualWith=km,d.isError=gc,d.isFinite=Vm,d.isFunction=Tr,d.isInteger=fl,d.isLength=bo,d.isMap=pl,d.isMatch=Km,d.isMatchWith=Gm,d.isNaN=Wm,d.isNative=Jm,d.isNil=Ym,d.isNull=Qm,d.isNumber=dl,d.isObject=Be,d.isObjectLike=je,d.isPlainObject=Vn,d.isRegExp=yc,d.isSafeInteger=Zm,d.isSet=gl,d.isString=_o,d.isSymbol=Bt,d.isTypedArray=cn,d.isUndefined=Xm,d.isWeakMap=e1,d.isWeakSet=t1,d.join=nv,d.kebabCase=k1,d.last=Qt,d.lastIndexOf=sv,d.lowerCase=V1,d.lowerFirst=K1,d.lt=r1,d.lte=i1,d.max=Lw,d.maxBy=Uw,d.mean=Mw,d.meanBy=Hw,d.min=kw,d.minBy=Vw,d.stubArray=Pc,d.stubFalse=xc,d.stubObject=Rw,d.stubString=Cw,d.stubTrue=$w,d.multiply=Kw,d.nth=ov,d.noConflict=Ew,d.noop=Ic,d.now=vo,d.pad=G1,d.padEnd=W1,d.padStart=J1,d.parseInt=Q1,d.random=z1,d.reduce=um,d.reduceRight=hm,d.repeat=Y1,d.replace=Z1,d.result=O1,d.round=Gw,d.runInContext=P,d.sample=fm,d.size=gm,d.snakeCase=X1,d.some=ym,d.sortedIndex=pv,d.sortedIndexBy=dv,d.sortedIndexOf=gv,d.sortedLastIndex=yv,d.sortedLastIndexBy=vv,d.sortedLastIndexOf=mv,d.startCase=tw,d.startsWith=rw,d.subtract=Ww,d.sum=Jw,d.sumBy=Qw,d.template=iw,d.times=Tw,d.toFinite=Nr,d.toInteger=le,d.toLength=vl,d.toLower=nw,d.toNumber=Yt,d.toSafeInteger=n1,d.toString=Ie,d.toUpper=sw,d.trim=ow,d.trimEnd=aw,d.trimStart=cw,d.truncate=uw,d.unescape=hw,d.uniqueId=Dw,d.upperCase=lw,d.upperFirst=wc,d.each=il,d.eachRight=nl,d.first=Xh,Ec(d,function(){var e={};return gr(d,function(i,a){Pe.call(d.prototype,a)||(e[a]=i)}),e}(),{chain:!1}),d.VERSION=s,Vt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){d[e].placeholder=d}),Vt(["drop","take"],function(e,i){ve.prototype[e]=function(a){a=a===r?1:We(le(a),0);var u=this.__filtered__&&!i?new ve(this):this.clone();return u.__filtered__?u.__takeCount__=ot(a,u.__takeCount__):u.__views__.push({size:ot(a,ne),type:e+(u.__dir__<0?"Right":"")}),u},ve.prototype[e+"Right"]=function(a){return this.reverse()[e](a).reverse()}}),Vt(["filter","map","takeWhile"],function(e,i){var a=i+1,u=a==Lt||a==A;ve.prototype[e]=function(l){var g=this.clone();return g.__iteratees__.push({iteratee:ee(l,3),type:a}),g.__filtered__=g.__filtered__||u,g}}),Vt(["head","last"],function(e,i){var a="take"+(i?"Right":"");ve.prototype[e]=function(){return this[a](1).value()[0]}}),Vt(["initial","tail"],function(e,i){var a="drop"+(i?"":"Right");ve.prototype[e]=function(){return this.__filtered__?new ve(this):this[a](1)}}),ve.prototype.compact=function(){return this.filter(_t)},ve.prototype.find=function(e){return this.filter(e).head()},ve.prototype.findLast=function(e){return this.reverse().find(e)},ve.prototype.invokeMap=ge(function(e,i){return typeof e=="function"?new ve(this):this.map(function(a){return zn(a,e,i)})}),ve.prototype.reject=function(e){return this.filter(wo(ee(e)))},ve.prototype.slice=function(e,i){e=le(e);var a=this;return a.__filtered__&&(e>0||i<0)?new ve(a):(e<0?a=a.takeRight(-e):e&&(a=a.drop(e)),i!==r&&(i=le(i),a=i<0?a.dropRight(-i):a.take(i-e)),a)},ve.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},ve.prototype.toArray=function(){return this.take(ne)},gr(ve.prototype,function(e,i){var a=/^(?:filter|find|map|reject)|While$/.test(i),u=/^(?:head|last)$/.test(i),l=d[u?"take"+(i=="last"?"Right":""):i],g=u||/^find/.test(i);l&&(d.prototype[i]=function(){var w=this.__wrapped__,_=u?[1]:arguments,x=w instanceof ve,$=_[0],T=x||ce(w),q=function(ye){var we=l.apply(d,Jr([ye],_));return u&&L?we[0]:we};T&&a&&typeof $=="function"&&$.length!=1&&(x=T=!1);var L=this.__chain__,J=!!this.__actions__.length,te=g&&!L,fe=x&&!J;if(!g&&T){w=fe?w:new ve(this);var re=e.apply(w,_);return re.__actions__.push({func:go,args:[q],thisArg:r}),new Gt(re,L)}return te&&fe?e.apply(this,_):(re=this.thru(q),te?u?re.value()[0]:re.value():re)})}),Vt(["pop","push","shift","sort","splice","unshift"],function(e){var i=Ls[e],a=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",u=/^(?:pop|shift)$/.test(e);d.prototype[e]=function(){var l=arguments;if(u&&!this.__chain__){var g=this.value();return i.apply(ce(g)?g:[],l)}return this[a](function(w){return i.apply(ce(w)?w:[],l)})}}),gr(ve.prototype,function(e,i){var a=d[i];if(a){var u=a.name+"";Pe.call(rn,u)||(rn[u]=[]),rn[u].push({name:i,func:a})}}),rn[ao(r,H).name]=[{name:"wrapper",func:r}],ve.prototype.clone=hg,ve.prototype.reverse=lg,ve.prototype.value=fg,d.prototype.at=Uv,d.prototype.chain=Mv,d.prototype.commit=Hv,d.prototype.next=kv,d.prototype.plant=Kv,d.prototype.reverse=Gv,d.prototype.toJSON=d.prototype.valueOf=d.prototype.value=Wv,d.prototype.first=d.prototype.head,$n&&(d.prototype[$n]=Vv),d},Xi=Hd();Le?((Le.exports=Xi)._=Xi,Fe._=Xi):me._=Xi}).call(Xn)})(uu,uu.exports);var OS=Object.defineProperty,RS=Object.defineProperties,CS=Object.getOwnPropertyDescriptors,Yf=Object.getOwnPropertySymbols,$S=Object.prototype.hasOwnProperty,TS=Object.prototype.propertyIsEnumerable,Zf=(n,t,r)=>t in n?OS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Co=(n,t)=>{for(var r in t||(t={}))$S.call(t,r)&&Zf(n,r,t[r]);if(Yf)for(var r of Yf(t))TS.call(t,r)&&Zf(n,r,t[r]);return n},NS=(n,t)=>RS(n,CS(t));function ci(n,t,r){var s;const o=B0(n);return((s=t.rpcMap)==null?void 0:s[o.reference])||`${FS}?chainId=${o.namespace}:${o.reference}&projectId=${r}`}function $i(n){return n.includes(":")?n.split(":")[1]:n}function md(n){return n.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function DS(n,t){const r=Object.keys(t.namespaces).filter(o=>o.includes(n));if(!r.length)return[];const s=[];return r.forEach(o=>{const c=t.namespaces[o].accounts;s.push(...c)}),s}function BS(n={},t={}){const r=Xf(n),s=Xf(t);return uu.exports.merge(r,s)}function Xf(n){var t,r,s,o;const c={};if(!No(n))return c;for(const[h,p]of Object.entries(n)){const f=hp(h)?[h]:p.chains,y=p.methods||[],v=p.events||[],b=p.rpcMap||{},S=es(h);c[S]=NS(Co(Co({},c[S]),p),{chains:Ac(f,(t=c[S])==null?void 0:t.chains),methods:Ac(y,(r=c[S])==null?void 0:r.methods),events:Ac(v,(s=c[S])==null?void 0:s.events),rpcMap:Co(Co({},b),(o=c[S])==null?void 0:o.rpcMap)})}return c}function qS(n){return n.includes(":")?n.split(":")[2]:n}function jS(n){const t={};for(const[r,s]of Object.entries(n)){const o=s.methods||[],c=s.events||[],h=s.accounts||[],p=hp(r)?[r]:s.chains?s.chains:md(s.accounts);t[r]={chains:p,methods:o,events:c,accounts:h}}return t}function Kc(n){return typeof n=="number"?n:n.includes("0x")?parseInt(n,16):n.includes(":")?Number(n.split(":")[1]):Number(n)}const wd={},De=n=>wd[n],Gc=(n,t)=>{wd[n]=t};class zS{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=De("events"),this.client=De("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(Hr.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const o=$i(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||ci(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new ui(s,De("disableProviderPing")))}}class LS{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=De("events"),this.client=De("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(parseInt(t),r),this.chainId=parseInt(t),this.events.emit(Hr.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const s=r||ci(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new ui(s,De("disableProviderPing")))}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const o=parseInt($i(r));t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r,s;let o=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const c=parseInt(o,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:o}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class US{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=De("events"),this.client=De("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(Hr.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const o=$i(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||ci(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new ui(s,De("disableProviderPing")))}}class MS{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=De("events"),this.client=De("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(Hr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const o=$i(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||ci(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new ui(s,De("disableProviderPing")))}}class HS{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=De("events"),this.client=De("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(Hr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r),o=$i(r);t[o]=this.createHttpProvider(o,s)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new ui(s,De("disableProviderPing")))}}class kS{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=De("events"),this.client=De("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(Hr.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const o=$i(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||ci(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new ui(s,De("disableProviderPing")))}}class VS{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=De("events"),this.client=De("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(Hr.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const o=$i(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||ci(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new ui(s,De("disableProviderPing")))}}class KS{constructor(t){this.name="near",this.namespace=t.namespace,this.events=De("events"),this.client=De("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||ci(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(Hr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||ci(t,this.namespace);return typeof s>"u"?void 0:new hi(new ui(s,De("disableProviderPing")))}}var GS=Object.defineProperty,WS=Object.defineProperties,JS=Object.getOwnPropertyDescriptors,ep=Object.getOwnPropertySymbols,QS=Object.prototype.hasOwnProperty,YS=Object.prototype.propertyIsEnumerable,tp=(n,t,r)=>t in n?GS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,$o=(n,t)=>{for(var r in t||(t={}))QS.call(t,r)&&tp(n,r,t[r]);if(ep)for(var r of ep(t))YS.call(t,r)&&tp(n,r,t[r]);return n},Wc=(n,t)=>WS(n,JS(t));class Ou{constructor(t){this.events=new fu,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ho(ko({level:(t==null?void 0:t.logger)||Jf})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new Ou(t);return await r.initialize(),r}async request(t,r){const[s,o]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:$o({},t),chainId:`${s}:${o}`,topic:this.session.topic})}sendAsync(t,r,s){const o=new Date().getTime();this.request(t,s).then(c=>r(null,Ko(o,c))).catch(c=>r(c,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:ct("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(c=>{this.session=c,this.namespaces||(this.namespaces=jS(c.namespaces),this.persist("namespaces",this.namespaces))}).catch(c=>{if(c.message!==yd)throw c;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;const[s,o]=this.validateChain(t);this.getProvider(s).setDefaultChain(o,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(vn(r)){for(const s of r)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await yS.init({logger:this.providerOpts.logger||Jf,relayUrl:this.providerOpts.relayUrl||xS,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>es(r)))];Gc("client",this.client),Gc("events",this.events),Gc("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const s=DS(r,this.session),o=md(s),c=BS(this.namespaces,this.optionalNamespaces),h=Wc($o({},c[r]),{accounts:s,chains:o});switch(r){case"eip155":this.rpcProviders[r]=new LS({namespace:h});break;case"solana":this.rpcProviders[r]=new US({namespace:h});break;case"cosmos":this.rpcProviders[r]=new MS({namespace:h});break;case"polkadot":this.rpcProviders[r]=new zS({namespace:h});break;case"cip34":this.rpcProviders[r]=new HS({namespace:h});break;case"elrond":this.rpcProviders[r]=new kS({namespace:h});break;case"multiversx":this.rpcProviders[r]=new VS({namespace:h});break;case"near":this.rpcProviders[r]=new KS({namespace:h});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:s}=r;if(s.name==="accountsChanged"){const o=s.data;o&&vn(o)&&this.events.emit("accountsChanged",o.map(qS))}else if(s.name==="chainChanged"){const o=r.chainId,c=r.event.data,h=es(o),p=Kc(o)!==Kc(c)?`${h}:${Kc(c)}`:o;this.onChainChanged(p)}else this.events.emit(s.name,s.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var s;const{namespaces:o}=r,c=(s=this.client)==null?void 0:s.session.get(t);this.session=Wc($o({},c),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Wc($o({},ct("USER_DISCONNECTED")),{data:t.topic}))}),this.on(Hr.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:s,sessionProperties:o}=t;r&&Object.keys(r).length&&(this.namespaces=r),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=o,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(t){const[r,s]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,s];if(r&&!Object.keys(this.namespaces||{}).map(h=>es(h)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const o=es(Object.keys(this.namespaces)[0]),c=this.rpcProviders[o].getDefaultChain();return[o,c]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var s;if(!this.namespaces)return;const[o,c]=this.validateChain(t);r||this.getProvider(o).setDefaultChain(c),((s=this.namespaces[o])!=null?s:this.namespaces[`${o}:${c}`]).defaultChain=c,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",c)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${Qf}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${Qf}/${t}`)}}const ZS=Ou,XS="wc",eA="ethereum_provider",tA=`${XS}@2:${eA}:`,rA="https://rpc.walletconnect.com/v1/",hu=["eth_sendTransaction","personal_sign"],iA=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],lu=["chainChanged","accountsChanged"],nA=["chainChanged","accountsChanged","message","disconnect","connect"];var sA=Object.defineProperty,oA=Object.defineProperties,aA=Object.getOwnPropertyDescriptors,rp=Object.getOwnPropertySymbols,cA=Object.prototype.hasOwnProperty,uA=Object.prototype.propertyIsEnumerable,ip=(n,t,r)=>t in n?sA(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,rs=(n,t)=>{for(var r in t||(t={}))cA.call(t,r)&&ip(n,r,t[r]);if(rp)for(var r of rp(t))uA.call(t,r)&&ip(n,r,t[r]);return n},np=(n,t)=>oA(n,aA(t));function Lo(n){return Number(n[0].split(":")[1])}function Jc(n){return`0x${n.toString(16)}`}function hA(n){const{chains:t,optionalChains:r,methods:s,optionalMethods:o,events:c,optionalEvents:h,rpcMap:p}=n;if(!vn(t))throw new Error("Invalid chains");const f={chains:t,methods:s||hu,events:c||lu,rpcMap:rs({},t.length?{[Lo(t)]:p[Lo(t)]}:{})},y=c==null?void 0:c.filter(O=>!lu.includes(O)),v=s==null?void 0:s.filter(O=>!hu.includes(O));if(!r&&!h&&!o&&!(y!=null&&y.length)&&!(v!=null&&v.length))return{required:t.length?f:void 0};const b=(y==null?void 0:y.length)&&(v==null?void 0:v.length)||!r,S={chains:[...new Set(b?f.chains.concat(r||[]):r)],methods:[...new Set(f.methods.concat(o!=null&&o.length?o:iA))],events:[...new Set(f.events.concat(h!=null&&h.length?h:nA))],rpcMap:p};return{required:t.length?f:void 0,optional:r.length?S:void 0}}class Ru{constructor(){this.events=new zt.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=tA,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new Ru;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:s}=hA(this.rpc);try{const o=await new Promise(async(h,p)=>{var f;this.rpc.showQrModal&&((f=this.modal)==null||f.subscribeModal(y=>{!y.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),p(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(np(rs({namespaces:rs({},r&&{[this.namespace]:r})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(y=>{h(y)}).catch(y=>{p(new Error(y.message))})});if(!o)return;const c=q0(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:Jc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",Jc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",np(rs({},ct("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",Jc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,s,o]=t.split(":");return{chainId:`${r}:${s}`,address:o}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,s;const o=(r=t==null?void 0:t.chains)!=null?r:[],c=(s=t==null?void 0:t.optionalChains)!=null?s:[],h=o.concat(c);if(!h.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const p=o.length?(t==null?void 0:t.methods)||hu:[],f=o.length?(t==null?void 0:t.events)||lu:[],y=(t==null?void 0:t.optionalMethods)||[],v=(t==null?void 0:t.optionalEvents)||[],b=(t==null?void 0:t.rpcMap)||this.buildRpcMap(h,t.projectId),S=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(O=>this.formatChainId(O)),optionalChains:c.map(O=>this.formatChainId(O)),methods:p,events:f,optionalMethods:y,optionalEvents:v,rpcMap:b,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:S,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const s={};return t.forEach(o=>{s[o]=this.getRpcUrl(o,r)}),s}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?Lo(this.rpc.chains):Lo(this.rpc.optionalChains),this.signer=await ZS.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await Yw(()=>import("./index-e92e2a8f.js").then(o=>o.i),["assets/index-e92e2a8f.js","assets/web3-936f3753.js","assets/vendor-48cd178f.js","assets/index-21c6ac15.js","assets/ui-9609bd02.js","assets/router-eeeca5a6.js","assets/index-418a4095.css"]);r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(rs({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:s,rpcMap:o}=t;r&&vn(r)&&(this.rpc.chains=r.map(c=>this.formatChainId(c)),r.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)})),s&&vn(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(c=>this.formatChainId(c)),s.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)}))}getRpcUrl(t,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[t])||`${rA}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const jA=Ru;export{jA as EthereumProvider,nA as OPTIONAL_EVENTS,iA as OPTIONAL_METHODS,lu as REQUIRED_EVENTS,hu as REQUIRED_METHODS,Ru as default};
